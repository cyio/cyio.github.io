<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.37">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#0089a7"><meta name="referrer" content="no-referrer"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><title>Vue 3 æºç å­¦ä¹  | Oakerå°ç«™</title><meta name="description" content="Just playing around">
    <link rel="modulepreload" href="/assets/app.824beb48.js"><link rel="modulepreload" href="/assets/vue3-source-code.html.ffd6971e.js"><link rel="modulepreload" href="/assets/vue3-source-code.html.4d86649d.js">
    <link rel="stylesheet" href="/assets/style.1f6754f1.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Oakerå°ç«™</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="ä¸»é¡µ"><!--[--><!--]--> ä¸»é¡µ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/index.html" class="" aria-label="Blog"><!--[--><!--]--> Blog <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/concept.html" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></div><div class="navbar-item"><a href="/web/html.html" class="" aria-label="Web"><!--[--><!--]--> Web <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frameworks/vue.html" class="" aria-label="æ¡†æ¶"><!--[--><!--]--> æ¡†æ¶ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node/concept.html" class="" aria-label="Node"><!--[--><!--]--> Node <!--[--><!--]--></a></div><div class="navbar-item"><a href="/tools/markdown.html" class="" aria-label="å·¥å…·"><!--[--><!--]--> å·¥å…· <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/algorithms/index.html" class="" aria-label="ç®—æ³•"><!--[--><!--]--> ç®—æ³• <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/solutions/fib.html" class="" aria-label="é¢˜è§£"><!--[--><!--]--> é¢˜è§£ <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/cyio" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="ä¸»é¡µ"><!--[--><!--]--> ä¸»é¡µ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/blog/index.html" class="" aria-label="Blog"><!--[--><!--]--> Blog <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/concept.html" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></div><div class="navbar-item"><a href="/web/html.html" class="" aria-label="Web"><!--[--><!--]--> Web <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frameworks/vue.html" class="" aria-label="æ¡†æ¶"><!--[--><!--]--> æ¡†æ¶ <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node/concept.html" class="" aria-label="Node"><!--[--><!--]--> Node <!--[--><!--]--></a></div><div class="navbar-item"><a href="/tools/markdown.html" class="" aria-label="å·¥å…·"><!--[--><!--]--> å·¥å…· <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/algorithms/index.html" class="" aria-label="ç®—æ³•"><!--[--><!--]--> ç®—æ³• <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/solutions/fib.html" class="" aria-label="é¢˜è§£"><!--[--><!--]--> é¢˜è§£ <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/cyio" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">æ¡†æ¶ <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/frameworks/ajax-http-request-libray.html" class="sidebar-item" aria-label="ajax/http è¯·æ±‚åº“ã€å·¥å…·"><!--[--><!--]--> ajax/http è¯·æ±‚åº“ã€å·¥å…· <!--[--><!--]--></a><!----></li><li><a href="/frameworks/bootstrap.html" class="sidebar-item" aria-label="Bootstrap"><!--[--><!--]--> Bootstrap <!--[--><!--]--></a><!----></li><li><a href="/frameworks/cropperjs.html" class="sidebar-item" aria-label="cropperjs"><!--[--><!--]--> cropperjs <!--[--><!--]--></a><!----></li><li><a href="/frameworks/css-modules.html" class="sidebar-item" aria-label="css-modules.md"><!--[--><!--]--> css-modules.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/date-fns.html" class="sidebar-item" aria-label="date-fns"><!--[--><!--]--> date-fns <!--[--><!--]--></a><!----></li><li><a href="/frameworks/element-ui.html" class="sidebar-item" aria-label="element-ui"><!--[--><!--]--> element-ui <!--[--><!--]--></a><!----></li><li><a href="/frameworks/flutter.html" class="sidebar-item" aria-label="Flutter"><!--[--><!--]--> Flutter <!--[--><!--]--></a><!----></li><li><a href="/frameworks/mobx.html" class="sidebar-item" aria-label="Mobx"><!--[--><!--]--> Mobx <!--[--><!--]--></a><!----></li><li><a href="/frameworks/next.html" class="sidebar-item" aria-label="Next.js"><!--[--><!--]--> Next.js <!--[--><!--]--></a><!----></li><li><a href="/frameworks/pinia-store.html" class="sidebar-item" aria-label="pinia-store.md"><!--[--><!--]--> pinia-store.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/qwik.html" class="sidebar-item" aria-label="qwik.md"><!--[--><!--]--> qwik.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react-hooks.html" class="sidebar-item" aria-label="hooks"><!--[--><!--]--> hooks <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react-issues.html" class="sidebar-item" aria-label="react issues"><!--[--><!--]--> react issues <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react-native.html" class="sidebar-item" aria-label="React Native"><!--[--><!--]--> React Native <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react-router.html" class="sidebar-item" aria-label="react-router.md"><!--[--><!--]--> react-router.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react-source-code.html" class="sidebar-item" aria-label="React source code"><!--[--><!--]--> React source code <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react.html" class="sidebar-item" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a><!----></li><li><a href="/frameworks/redux.html" class="sidebar-item" aria-label="Redux"><!--[--><!--]--> Redux <!--[--><!--]--></a><!----></li><li><a href="/frameworks/remix.html" class="sidebar-item" aria-label="remix.md"><!--[--><!--]--> remix.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/solidjs.html" class="sidebar-item" aria-label="SolidJS"><!--[--><!--]--> SolidJS <!--[--><!--]--></a><!----></li><li><a href="/frameworks/svelte.html" class="sidebar-item" aria-label="Svelte"><!--[--><!--]--> Svelte <!--[--><!--]--></a><!----></li><li><a href="/frameworks/swiper.html" class="sidebar-item" aria-label="Swiper"><!--[--><!--]--> Swiper <!--[--><!--]--></a><!----></li><li><a href="/frameworks/tailwind.html" class="sidebar-item" aria-label="Tailwind CSS"><!--[--><!--]--> Tailwind CSS <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vite.html" class="sidebar-item" aria-label="vite"><!--[--><!--]--> vite <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue-components.html" class="sidebar-item" aria-label="vue-components"><!--[--><!--]--> vue-components <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue-router.html" class="sidebar-item" aria-label="vue-router"><!--[--><!--]--> vue-router <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue.html" class="sidebar-item" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue2-source-code.html" class="sidebar-item" aria-label="Vue æºç å­¦ä¹ "><!--[--><!--]--> Vue æºç å­¦ä¹  <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="Vue 3 æºç å­¦ä¹ "><!--[--><!--]--> Vue 3 æºç å­¦ä¹  <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/frameworks/vue3-source-code.html#è°ƒè¯•" class="router-link-active router-link-exact-active sidebar-item" aria-label="è°ƒè¯•"><!--[--><!--]--> è°ƒè¯• <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#ç›®å½•ç»“æ„" class="router-link-active router-link-exact-active sidebar-item" aria-label="ç›®å½•ç»“æ„"><!--[--><!--]--> ç›®å½•ç»“æ„ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#æ¨¡å—å…³ç³»" class="router-link-active router-link-exact-active sidebar-item" aria-label="æ¨¡å—å…³ç³»"><!--[--><!--]--> æ¨¡å—å…³ç³» <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#createapp" class="router-link-active router-link-exact-active sidebar-item" aria-label="createApp"><!--[--><!--]--> createApp <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#core-api-runtime" class="router-link-active router-link-exact-active sidebar-item" aria-label="core api - runtime"><!--[--><!--]--> core api - runtime <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#reactive" class="router-link-active router-link-exact-active sidebar-item" aria-label="reactive"><!--[--><!--]--> reactive <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#è®¨è®ºç‚¹" class="router-link-active router-link-exact-active sidebar-item" aria-label="è®¨è®ºç‚¹"><!--[--><!--]--> è®¨è®ºç‚¹ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#å‚è€ƒ" class="router-link-active router-link-exact-active sidebar-item" aria-label="å‚è€ƒ"><!--[--><!--]--> å‚è€ƒ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#shapeflag" class="router-link-active router-link-exact-active sidebar-item" aria-label="shapeFlag"><!--[--><!--]--> shapeFlag <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#h-render" class="router-link-active router-link-exact-active sidebar-item" aria-label="h &amp; render"><!--[--><!--]--> h &amp; render <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#è™šæ‹Ÿ-dom-ç¼–è¯‘æ—¶ä¼˜åŒ–" class="router-link-active router-link-exact-active sidebar-item" aria-label="è™šæ‹Ÿ DOM ç¼–è¯‘æ—¶ä¼˜åŒ–"><!--[--><!--]--> è™šæ‹Ÿ DOM ç¼–è¯‘æ—¶ä¼˜åŒ– <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#fragments" class="router-link-active router-link-exact-active sidebar-item" aria-label="Fragments"><!--[--><!--]--> Fragments <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#definecomponent" class="router-link-active router-link-exact-active sidebar-item" aria-label="defineComponent"><!--[--><!--]--> defineComponent <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/frameworks/vue3.html" class="sidebar-item" aria-label="Vue 3"><!--[--><!--]--> Vue 3 <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vuejs-issues.html" class="sidebar-item" aria-label="vue-issues"><!--[--><!--]--> vue-issues <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vuex.html" class="sidebar-item" aria-label="Vuex"><!--[--><!--]--> Vuex <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="vue-3-æºç å­¦ä¹ " tabindex="-1"><a class="header-anchor" href="#vue-3-æºç å­¦ä¹ " aria-hidden="true">#</a> Vue 3 æºç å­¦ä¹ </h1><nav class="table-of-contents"><ul><li><a aria-current="page" href="/frameworks/vue3-source-code.html#è°ƒè¯•" class="router-link-active router-link-exact-active">è°ƒè¯•</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#ç›®å½•ç»“æ„" class="router-link-active router-link-exact-active">ç›®å½•ç»“æ„</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#æ¨¡å—å…³ç³»" class="router-link-active router-link-exact-active">æ¨¡å—å…³ç³»</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#createapp" class="router-link-active router-link-exact-active">createApp</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#core-api-runtime" class="router-link-active router-link-exact-active">core api - runtime</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#reactive" class="router-link-active router-link-exact-active">reactive</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#è®¨è®ºç‚¹" class="router-link-active router-link-exact-active">è®¨è®ºç‚¹</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#å‚è€ƒ" class="router-link-active router-link-exact-active">å‚è€ƒ</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#shapeflag" class="router-link-active router-link-exact-active">shapeFlag</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#h-render" class="router-link-active router-link-exact-active">h &amp; render</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#è™šæ‹Ÿ-dom-ç¼–è¯‘æ—¶ä¼˜åŒ–" class="router-link-active router-link-exact-active">è™šæ‹Ÿ DOM ç¼–è¯‘æ—¶ä¼˜åŒ–</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#fragments" class="router-link-active router-link-exact-active">Fragments</a></li><li><a aria-current="page" href="/frameworks/vue3-source-code.html#definecomponent" class="router-link-active router-link-exact-active">defineComponent</a></li></ul></nav><p>åœ¨çº¿æºç  https://vscode.dev/github/vuejs/core</p><h2 id="è°ƒè¯•" tabindex="-1"><a class="header-anchor" href="#è°ƒè¯•" aria-hidden="true">#</a> è°ƒè¯•</h2><div class="language-text ext-text"><pre class="language-text"><code>git clone git@github.com:vuejs/core.git vue3-core
</code></pre></div><h2 id="ç›®å½•ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç›®å½•ç»“æ„" aria-hidden="true">#</a> ç›®å½•ç»“æ„</h2><p>packages</p><div class="language-text ext-text"><pre class="language-text"><code>.
â”œâ”€â”€ compiler-core // ç¼–è¯‘æ ¸å¿ƒï¼ŒæŠ½è±¡è¯­æ³•æ ‘å’Œæ¸²æŸ“æ¡¥æ¥å®ç°
â”œâ”€â”€ compiler-dom // Dom å®ç°
â”œâ”€â”€ compiler-sfc // SFC å•æ–‡ä»¶ç»„ä»¶(.vue)çš„å®ç°
â”œâ”€â”€ compiler-ssr
â”œâ”€â”€ global.d.ts
â”œâ”€â”€ reactivity // å“åº”å¼
â”œâ”€â”€ runtime-core
â”œâ”€â”€ runtime-dom
â”œâ”€â”€ runtime-test
â”œâ”€â”€ server-renderer // æœåŠ¡ç«¯æ¸²æŸ“å®ç°
â”œâ”€â”€ shared  // package ä¹‹é—´å…±äº«çš„å·¥å…·åº“
â”œâ”€â”€ size-check
â”œâ”€â”€ template-explorer
â””â”€â”€ vue // å…¥å£ï¼Ÿ
</code></pre></div><p>compilerã€runtime æ¦‚å¿µåŒºåˆ« compiler æºç åˆ°å¯æ‰§è¡Œä»£ç ï¼Œruntime ç¨‹åºè¿è¡Œæ—¶</p><h2 id="æ¨¡å—å…³ç³»" tabindex="-1"><a class="header-anchor" href="#æ¨¡å—å…³ç³»" aria-hidden="true">#</a> æ¨¡å—å…³ç³»</h2><div class="language-text ext-text"><pre class="language-text"><code>vue - packages/vue/src/index.ts
    @vue/compiler-dom
        @vue/compiler-core
    @vue/runtime-dom
        @vue/runtime-core
</code></pre></div><h2 id="createapp" tabindex="-1"><a class="header-anchor" href="#createapp" aria-hidden="true">#</a> createApp</h2><p>æ–¹æ³•å…³ç³»ï¼š</p><div class="language-text ext-text"><pre class="language-text"><code>createRenderer
 baseCreateRenderer
   createAppAPI
</code></pre></div><div class="language-text ext-text"><pre class="language-text"><code>// packages/runtime-core/src/renderer.ts
function baseCreateRenderer
  ...
  return {
    render,
    hydrate,
    createApp: createAppAPI(render, hydrate)
  }
</code></pre></div><p>createAppAPI</p><div class="language-text ext-text"><pre class="language-text"><code>app
  use(plugin: Plugin, ...options: any[]) {
  mixin(mixin: ComponentOptions) {
  component(name: string, component?: Component): any {
  directive(name: string, directive?: Directive) {

  mount(
  unmount() {
  provide(key, value) {
</code></pre></div><pre><code>propsCache: new WeakMap(),
</code></pre><h2 id="core-api-runtime" tabindex="-1"><a class="header-anchor" href="#core-api-runtime" aria-hidden="true">#</a> core api - runtime</h2><p><code>packages/runtime-core/src/index.ts</code>è´Ÿè´£å°†æœ€å¸¸ç”¨æ–¹æ³•ã€API å¯¼å‡º</p><p>defineComponent ç±»å‹ util</p><p>h - Hyperscript å‚æ•°åˆ¤æ–­ï¼Œå®é™…è°ƒç”¨ createVNode</p><p>v-if/v-for è§†ä¸º blockï¼Œå¯èƒ½åŠ¨æ€å˜æ›´</p><h2 id="reactive" tabindex="-1"><a class="header-anchor" href="#reactive" aria-hidden="true">#</a> reactive</h2><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c884b48e88a643e2b695b3587224b51d~tplv-k3u1fbpfcp-watermark.awebp" alt="reactive å·¥ä½œæµç¨‹"></p><p>æ–‡ä»¶ç»“æ„</p><div class="language-text ext-text"><pre class="language-text"><code>â””â”€â”€ src
    â”œâ”€â”€ baseHandlers.ts // åŸºæœ¬ç±»å‹çš„å¤„ç†å™¨
    â”œâ”€â”€ collectionHandlers.ts  // Set Map WeakSet WeckMapçš„å¤„ç†å™¨
    â”œâ”€â”€ computed.ts // è®¡ç®—å±æ€§ï¼ŒåŒVue2
    â”œâ”€â”€ deferredComputed.ts // è®¡ç®—å±æ€§
    â”œâ”€â”€ dep.ts // 
    â”œâ”€â”€ effect.ts // reactive æ ¸å¿ƒï¼Œå¤„ç†ä¾èµ–æ”¶é›†ï¼Œä¾èµ–æ›´æ–°
    â”œâ”€â”€ effectScope.ts // 
    â”œâ”€â”€ index.ts
    â”œâ”€â”€ operations.ts // å®šä¹‰ä¾èµ–æ”¶é›†ï¼Œä¾èµ–æ›´æ–°çš„ç±»å‹
    â”œâ”€â”€ reactive.ts // reactive å…¥å£ï¼Œå†…éƒ¨ä¸»è¦ä»¥ Proxy å®ç°
    â””â”€â”€ ref.ts // Proxy å¤„ç†ä¸äº†å€¼ç±»å‹çš„å“åº”ï¼ŒRef æ¥å¤„ç†
</code></pre></div><p>ref å®ç°</p><div class="language-text ext-text"><pre class="language-text"><code>ref( é»˜è®¤æ·±æ‹·è´
  createRef(
    RefImpl(
      toReactive å¯¹è±¡è°ƒç”¨ reactiveï¼Œéå¯¹è±¡ç›´æ¥è¿”å›
         sObject(value) ? reactive(value) : value
            createReactiveObject(mutableHandlers
                new Proxy
      get æ—¶ï¼Œè§¦å‘ä¾èµ–æ”¶é›†ã€è¿½è¸ª
        trackEffects
      set æ—¶ï¼Œè§¦å‘ä¾èµ–æ›´æ–°
        triggerEffects
</code></pre></div><blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼šå¦‚æœä¼ å…¥ ref çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°†è°ƒç”¨ reactive æ–¹æ³•è¿›è¡Œæ·±å±‚å“åº”è½¬æ¢ã€‚</p></blockquote><p>effect ä½œä¸º reactive çš„æ ¸å¿ƒï¼Œä¸»è¦è´Ÿè´£ç›‘å¬å“åº”å¼æ•°æ®çš„å˜åŒ–ï¼Œè§¦å‘ç›‘å¬å‡½æ•°çš„æ‰§è¡Œé€»è¾‘</p><blockquote><p>Vue æœ€ç‹¬ç‰¹çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œæ˜¯å…¶éä¾µå…¥æ€§çš„å“åº”æ€§ç³»ç»Ÿã€‚æ•°æ®æ¨¡å‹æ˜¯è¢«ä»£ç†çš„ JavaScript å¯¹è±¡ã€‚</p></blockquote><p>åŸå§‹ç±»å‹å“åº”å¼è§£å†³æ–¹æ¡ˆï¼Œè½¬æ¢æˆå¯¹è±¡ï¼Œå¢åŠ <code>.value</code>ï¼Œæ¨¡æ¿è®¿é—®æ—¶è‡ªåŠ¨è§£å¥—</p><p>targetMap è®°å½• target object/property å’Œ effect å…³ç³»ï¼ŒäºŒå±‚æ•°æ®ç»“æ„ï¼š</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>weakmap <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">targetObject</span><span class="token operator">:</span> map <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">targetProperty</span><span class="token operator">:</span> dep<span class="token operator">&lt;</span>effect array<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>effectStack <code>push -&gt; run -&gt; pop</code></p><p>activeEffect å½“å‰è¿è¡Œçš„ effect</p><p>è®°å½•ä¾èµ–å…³ç³»æ—¶ï¼ŒæŸ¥è¯¢ activeEffect</p><p>setupResult æ˜¯ setup return çš„å¯¹è±¡</p><h2 id="è®¨è®ºç‚¹" tabindex="-1"><a class="header-anchor" href="#è®¨è®ºç‚¹" aria-hidden="true">#</a> è®¨è®ºç‚¹</h2><p>æ•°æ®å’Œé€»è¾‘èšåˆ</p><p>ä»¥åŠŸèƒ½æˆ–è€…èŒè´£æ¥ç»„ç»‡æ–‡ä»¶</p><p>æ–°çš„ API ç†è®ºä¸Šä¼šé™ä½ä»£ç è´¨é‡çš„æœ€ä½é—¨æ§›</p><p>setup ä½œç”¨æ˜¯ä¸ºäº†åˆæˆç”Ÿæˆç‰©ï¼Œä¾›å¤–éƒ¨è®¿é—®</p><p><a href="https://stackoverflow.com/a/58500917" target="_blank" rel="noopener noreferrer">vue.js - When to use setup() hook of Vue Composition API - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒ" aria-hidden="true">#</a> å‚è€ƒ</h2><p><a href="https://v3.cn.vuejs.org/guide/reactivity.html#%25E4%25BB%2580%25E4%25B9%2588%25E6%2598%25AF%25E5%2593%258D%25E5%25BA%2594%25E6%2580%25A7" target="_blank" rel="noopener noreferrer">æ·±å…¥å“åº”æ€§åŸç† | Vue.js<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://segmentfault.com/a/1190000039691166" target="_blank" rel="noopener noreferrer">æ¨è 7 ä¸ª Vue2ã€Vue3 æºç è§£å¯†åˆ†æçš„é‡ç£…å¼€æºé¡¹ç›® ğŸ‘ - SegmentFault æ€å¦<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="shapeflag" tabindex="-1"><a class="header-anchor" href="#shapeflag" aria-hidden="true">#</a> shapeFlag</h2><h2 id="h-render" tabindex="-1"><a class="header-anchor" href="#h-render" aria-hidden="true">#</a> h &amp; render</h2><p>h å‡½æ•°ä½œç”¨ createVNode</p><div class="language-text ext-text"><pre class="language-text"><code>render(h(xx), container)
</code></pre></div><p><a href="https://zhuanlan.zhihu.com/p/526776679" target="_blank" rel="noopener noreferrer">vue3æœ‰äº†è§£è¿‡å—ï¼Ÿèƒ½è¯´è¯´è·Ÿvue2çš„åŒºåˆ«å—ï¼Ÿvue3å’Œvue2åŒºåˆ«è¯¦è§£ - çŸ¥ä¹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="è™šæ‹Ÿ-dom-ç¼–è¯‘æ—¶ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#è™šæ‹Ÿ-dom-ç¼–è¯‘æ—¶ä¼˜åŒ–" aria-hidden="true">#</a> è™šæ‹Ÿ DOM ç¼–è¯‘æ—¶ä¼˜åŒ–</h2><p>çº¯è¿è¡Œæ—¶ =&gt; ç¼–è¯‘æ—¶</p><ul><li>é™æ€æå‡</li><li>æ›´æ–°ç±»å‹æ ‡è®°</li><li>æ ‘ç»“æ„æ‰“å¹³</li></ul><p>https://cn.vuejs.org/guide/extras/rendering-mechanism.html#compiler-informed-virtual-dom</p><h2 id="fragments" tabindex="-1"><a class="header-anchor" href="#fragments" aria-hidden="true">#</a> Fragments</h2><p>ä¸å ä½ç½®ï¼Œåªæ¸²æŸ“ children</p><div class="language-text ext-text"><pre class="language-text"><code> &lt;fragment &gt;
   &lt;ChildA / &gt;
   &lt;ChildB / &gt;
   &lt;ChildC / &gt;
 &lt;/fragment&gt;
</code></pre></div><p><a href="https://blog.logrocket.com/fragments-in-vue-js/" target="_blank" rel="noopener noreferrer">Fragments in Vue.js - LogRocket Blog<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="definecomponent" tabindex="-1"><a class="header-anchor" href="#definecomponent" aria-hidden="true">#</a> defineComponent</h2><p>defineComponent æœ¬èº«çš„åŠŸèƒ½å¾ˆç®€å•ï¼Œä½†æ˜¯æœ€ä¸»è¦çš„åŠŸèƒ½æ˜¯ä¸ºäº† ts ä¸‹çš„ç±»å‹æ¨å¯¼ã€‚</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: gongyi01@baidu.com">gongyi01</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/frameworks/vue2-source-code.html" class="" aria-label="Vue æºç å­¦ä¹ "><!--[--><!--]--> Vue æºç å­¦ä¹  <!--[--><!--]--></a></span><span class="next"><a href="/frameworks/vue3.html" class="" aria-label="Vue 3"><!--[--><!--]--> Vue 3 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.824beb48.js" defer></script>
  </body>
</html>
