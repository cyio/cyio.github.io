<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.37">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#0089a7"><meta name="referrer" content="no-referrer"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><title>react issues | Oaker小站</title><meta name="description" content="Just playing around">
    <link rel="modulepreload" href="/assets/app.de32dec6.js"><link rel="modulepreload" href="/assets/react-issues.html.2c8a8c63.js"><link rel="modulepreload" href="/assets/react-issues.html.3e6dbdb0.js">
    <link rel="stylesheet" href="/assets/style.5af559d1.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Oaker小站</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/concept.html" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></div><div class="navbar-item"><a href="/web/html.html" class="" aria-label="Web"><!--[--><!--]--> Web <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frameworks/vue.html" class="" aria-label="框架"><!--[--><!--]--> 框架 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node/concept.html" class="" aria-label="Node"><!--[--><!--]--> Node <!--[--><!--]--></a></div><div class="navbar-item"><a href="/tools/markdown.html" class="" aria-label="工具"><!--[--><!--]--> 工具 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/algorithms/index.html" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/solutions/fib.html" class="" aria-label="题解"><!--[--><!--]--> 题解 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/cyio" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/concept.html" class="" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></div><div class="navbar-item"><a href="/web/html.html" class="" aria-label="Web"><!--[--><!--]--> Web <!--[--><!--]--></a></div><div class="navbar-item"><a href="/frameworks/vue.html" class="" aria-label="框架"><!--[--><!--]--> 框架 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/node/concept.html" class="" aria-label="Node"><!--[--><!--]--> Node <!--[--><!--]--></a></div><div class="navbar-item"><a href="/tools/markdown.html" class="" aria-label="工具"><!--[--><!--]--> 工具 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/algorithms/index.html" class="" aria-label="算法"><!--[--><!--]--> 算法 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/javascript/solutions/fib.html" class="" aria-label="题解"><!--[--><!--]--> 题解 <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/cyio" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">框架 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/frameworks/ajax-http-request-libray.html" class="sidebar-item" aria-label="ajax/http 请求库、工具"><!--[--><!--]--> ajax/http 请求库、工具 <!--[--><!--]--></a><!----></li><li><a href="/frameworks/bootstrap.html" class="sidebar-item" aria-label="Bootstrap"><!--[--><!--]--> Bootstrap <!--[--><!--]--></a><!----></li><li><a href="/frameworks/cropperjs.html" class="sidebar-item" aria-label="cropperjs"><!--[--><!--]--> cropperjs <!--[--><!--]--></a><!----></li><li><a href="/frameworks/css-modules.html" class="sidebar-item" aria-label="css-modules.md"><!--[--><!--]--> css-modules.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/date-fns.html" class="sidebar-item" aria-label="date-fns"><!--[--><!--]--> date-fns <!--[--><!--]--></a><!----></li><li><a href="/frameworks/element-ui.html" class="sidebar-item" aria-label="element-ui"><!--[--><!--]--> element-ui <!--[--><!--]--></a><!----></li><li><a href="/frameworks/flutter.html" class="sidebar-item" aria-label="Flutter"><!--[--><!--]--> Flutter <!--[--><!--]--></a><!----></li><li><a href="/frameworks/mobx.html" class="sidebar-item" aria-label="Mobx"><!--[--><!--]--> Mobx <!--[--><!--]--></a><!----></li><li><a href="/frameworks/next.html" class="sidebar-item" aria-label="Next.js"><!--[--><!--]--> Next.js <!--[--><!--]--></a><!----></li><li><a href="/frameworks/pinia-store.html" class="sidebar-item" aria-label="pinia-store.md"><!--[--><!--]--> pinia-store.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/qwik.html" class="sidebar-item" aria-label="qwik.md"><!--[--><!--]--> qwik.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react-hooks.html" class="sidebar-item" aria-label="hooks"><!--[--><!--]--> hooks <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="react issues"><!--[--><!--]--> react issues <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/frameworks/react-issues.html#页面结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="页面结构"><!--[--><!--]--> 页面结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#注意" class="router-link-active router-link-exact-active sidebar-item" aria-label="注意"><!--[--><!--]--> 注意 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#page-bare-template" class="router-link-active router-link-exact-active sidebar-item" aria-label="page bare template"><!--[--><!--]--> page bare template <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#typescript" class="router-link-active router-link-exact-active sidebar-item" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/frameworks/react-issues.html#json-快速生成-ts" class="router-link-active router-link-exact-active sidebar-item" aria-label="JSON 快速生成 TS"><!--[--><!--]--> JSON 快速生成 TS <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/frameworks/react-issues.html#影响效率因素" class="router-link-active router-link-exact-active sidebar-item" aria-label="影响效率因素"><!--[--><!--]--> 影响效率因素 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#新建页面" class="router-link-active router-link-exact-active sidebar-item" aria-label="新建页面"><!--[--><!--]--> 新建页面 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#表格实现" class="router-link-active router-link-exact-active sidebar-item" aria-label="表格实现"><!--[--><!--]--> 表格实现 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#路径-routes" class="router-link-active router-link-exact-active sidebar-item" aria-label="路径 routes"><!--[--><!--]--> 路径 routes <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#connect" class="router-link-active router-link-exact-active sidebar-item" aria-label="connect"><!--[--><!--]--> connect <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#解构对象内容" class="router-link-active router-link-exact-active sidebar-item" aria-label="解构对象内容"><!--[--><!--]--> 解构对象内容 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#checkbox-group" class="router-link-active router-link-exact-active sidebar-item" aria-label="checkbox.group"><!--[--><!--]--> checkbox.group <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#classnames" class="router-link-active router-link-exact-active sidebar-item" aria-label="classNames"><!--[--><!--]--> classNames <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-requesttype-默认是-json-可选-form" class="router-link-active router-link-exact-active sidebar-item" aria-label="umi requestType 默认是 json，可选 form"><!--[--><!--]--> umi requestType 默认是 json，可选 form <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#iconfont-cn-use-in-antd" class="router-link-active router-link-exact-active sidebar-item" aria-label="iconfont.cn use in antd"><!--[--><!--]--> iconfont.cn use in antd <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#hover-exclude" class="router-link-active router-link-exact-active sidebar-item" aria-label="hover exclude"><!--[--><!--]--> hover exclude <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#useeffect-反复执行" class="router-link-active router-link-exact-active sidebar-item" aria-label="useEffect 反复执行"><!--[--><!--]--> useEffect 反复执行 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#数据联动" class="router-link-active router-link-exact-active sidebar-item" aria-label="数据联动"><!--[--><!--]--> 数据联动 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-form-onfinished" class="router-link-active router-link-exact-active sidebar-item" aria-label="antd form onFinished"><!--[--><!--]--> antd form onFinished <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#hook-state-拆分合并原则" class="router-link-active router-link-exact-active sidebar-item" aria-label="hook state 拆分合并原则"><!--[--><!--]--> hook state 拆分合并原则 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#可以在函数内直接申明普通常量或普通函数吗" class="router-link-active router-link-exact-active sidebar-item" aria-label="可以在函数内直接申明普通常量或普通函数吗？"><!--[--><!--]--> 可以在函数内直接申明普通常量或普通函数吗？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#useeffect-不要用-async-use-usecallback-instead" class="router-link-active router-link-exact-active sidebar-item" aria-label="useEffect 不要用 async, use useCallback instead"><!--[--><!--]--> useEffect 不要用 async, use useCallback instead <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#list-virtualized" class="router-link-active router-link-exact-active sidebar-item" aria-label="list virtualized"><!--[--><!--]--> list virtualized <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#生命周期模拟-useeffect" class="router-link-active router-link-exact-active sidebar-item" aria-label="生命周期模拟 useEffect"><!--[--><!--]--> 生命周期模拟 useEffect <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#calc-px-计算" class="router-link-active router-link-exact-active sidebar-item" aria-label="calc px 计算"><!--[--><!--]--> calc px 计算 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#播放器能支持哪些文件类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="播放器能支持哪些文件类型"><!--[--><!--]--> 播放器能支持哪些文件类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#使用多个-usestate-或-usereducer" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用多个 useState 或 useReducer"><!--[--><!--]--> 使用多个 useState 或 useReducer <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#复杂-state-逻辑建议用-react-自带-usereducer" class="router-link-active router-link-exact-active sidebar-item" aria-label="复杂 state 逻辑建议用 React 自带 useReducer"><!--[--><!--]--> 复杂 state 逻辑建议用 React 自带 useReducer <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#自定义-hook" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义 hook"><!--[--><!--]--> 自定义 hook <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#rangepicker-没有样式" class="router-link-active router-link-exact-active sidebar-item" aria-label="RangePicker 没有样式"><!--[--><!--]--> RangePicker 没有样式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#dva-使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="dva 使用"><!--[--><!--]--> dva 使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-权限组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="antd 权限组件"><!--[--><!--]--> antd 权限组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#hook-dva-snip" class="router-link-active router-link-exact-active sidebar-item" aria-label="hook dva snip"><!--[--><!--]--> hook dva snip <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-ui" class="router-link-active router-link-exact-active sidebar-item" aria-label="umi ui"><!--[--><!--]--> umi ui <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#自定义左侧菜单-icon" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义左侧菜单 icon"><!--[--><!--]--> 自定义左侧菜单 icon <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#动态-menu" class="router-link-active router-link-exact-active sidebar-item" aria-label="动态 menu"><!--[--><!--]--> 动态 menu <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#参数路由" class="router-link-active router-link-exact-active sidebar-item" aria-label="参数路由"><!--[--><!--]--> 参数路由 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#layouts" class="router-link-active router-link-exact-active sidebar-item" aria-label="layouts"><!--[--><!--]--> layouts <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#视图无关的数据" class="router-link-active router-link-exact-active sidebar-item" aria-label="视图无关的数据"><!--[--><!--]--> 视图无关的数据 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#re-render" class="router-link-active router-link-exact-active sidebar-item" aria-label="re-render"><!--[--><!--]--> re-render <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#why-mapstate-mapdispatch" class="router-link-active router-link-exact-active sidebar-item" aria-label="why mapState mapDispatch"><!--[--><!--]--> why mapState mapDispatch <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#容器组件模式" class="router-link-active router-link-exact-active sidebar-item" aria-label="容器组件模式"><!--[--><!--]--> 容器组件模式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-简化数据流方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="umi 简化数据流方案"><!--[--><!--]--> umi 简化数据流方案 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#class-组件不能用-hooks" class="router-link-active router-link-exact-active sidebar-item" aria-label="class 组件不能用 hooks"><!--[--><!--]--> class 组件不能用 hooks <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#form-表单数据存储到上层组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="form 表单数据存储到上层组件"><!--[--><!--]--> form 表单数据存储到上层组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#warning-antd-upload-value-is-not-a-valid-prop-do-you-mean-filelist" class="router-link-active router-link-exact-active sidebar-item" aria-label="Warning: [antd: Upload] value is not a valid prop, do you mean fileList?"><!--[--><!--]--> Warning: [antd: Upload] value is not a valid prop, do you mean fileList? <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#unhandled-rejection-typeerror-object-is-not-a-function" class="router-link-active router-link-exact-active sidebar-item" aria-label="Unhandled Rejection (TypeError): Object(...) is not a function"><!--[--><!--]--> Unhandled Rejection (TypeError): Object(...) is not a function <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#使用-upload-组件上传图片提示-uncaught-error-must-set-key-for-rc-animate-children" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用 upload 组件上传图片提示：Uncaught Error: must set key for &lt;rc-animate&gt; children"><!--[--><!--]--> 使用 upload 组件上传图片提示：Uncaught Error: must set key for &lt;rc-animate&gt; children <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#error-too-many-re-renders-react-limits-the-number-of-renders-to-prevent-an-infinite-loop" class="router-link-active router-link-exact-active sidebar-item" aria-label="Error: Too many re-renders. React limits the number of renders to prevent an infinite loop."><!--[--><!--]--> Error: Too many re-renders. React limits the number of renders to prevent an infinite loop. <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#自定义表单控件" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义表单控件"><!--[--><!--]--> 自定义表单控件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#usemodel-是否会触发-redux-插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="useModel 是否会触发 redux 插件"><!--[--><!--]--> useModel 是否会触发 redux 插件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#给定深层数据-id-tree-结构定位" class="router-link-active router-link-exact-active sidebar-item" aria-label="给定深层数据 id，tree 结构定位"><!--[--><!--]--> 给定深层数据 id，tree 结构定位 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-官方-dragger-丢失文件" class="router-link-active router-link-exact-active sidebar-item" aria-label="antd 官方 dragger 丢失文件"><!--[--><!--]--> antd 官方 dragger 丢失文件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#useeffect-函数惰性-绑定函数记忆的可以是旧的依赖值" class="router-link-active router-link-exact-active sidebar-item" aria-label="useEffect 函数惰性，绑定函数记忆的可以是旧的依赖值"><!--[--><!--]--> useEffect 函数惰性，绑定函数记忆的可以是旧的依赖值 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#切换素材时-form-item-下发的-value-不更新-故改为手动传" class="router-link-active router-link-exact-active sidebar-item" aria-label="切换素材时，Form.item 下发的 value 不更新，故改为手动传"><!--[--><!--]--> 切换素材时，Form.item 下发的 value 不更新，故改为手动传 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#react-props-默认值使用非基础类型-引起不必要更新" class="router-link-active router-link-exact-active sidebar-item" aria-label="react props 默认值使用非基础类型 引起不必要更新"><!--[--><!--]--> react props 默认值使用非基础类型 引起不必要更新 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#failed-to-execute-clone-on-response-umi" class="router-link-active router-link-exact-active sidebar-item" aria-label="Failed to execute &#39;clone&#39; on &#39;Response&#39; umi"><!--[--><!--]--> Failed to execute &#39;clone&#39; on &#39;Response&#39; umi <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-layout" class="router-link-active router-link-exact-active sidebar-item" aria-label="antd layout"><!--[--><!--]--> antd layout <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#menu" class="router-link-active router-link-exact-active sidebar-item" aria-label="menu"><!--[--><!--]--> menu <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#usemodel-持久化-浅拷贝数据里如果有对象-对象经修改-会保持" class="router-link-active router-link-exact-active sidebar-item" aria-label="useModel 持久化，浅拷贝数据里如果有对象 对象经修改，会保持"><!--[--><!--]--> useModel 持久化，浅拷贝数据里如果有对象 对象经修改，会保持 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#异步权限" class="router-link-active router-link-exact-active sidebar-item" aria-label="异步权限"><!--[--><!--]--> 异步权限 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#关闭菜单国际化" class="router-link-active router-link-exact-active sidebar-item" aria-label="关闭菜单国际化"><!--[--><!--]--> 关闭菜单国际化 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#对象意外修改" class="router-link-active router-link-exact-active sidebar-item" aria-label="对象意外修改"><!--[--><!--]--> 对象意外修改 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#总结自己使用过的-hooks-数据流方式-掘金" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结自己使用过的 Hooks 数据流方式 - 掘金"><!--[--><!--]--> 总结自己使用过的 Hooks 数据流方式 - 掘金 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#css-module-局部作用域" class="router-link-active router-link-exact-active sidebar-item" aria-label="CSS module 局部作用域"><!--[--><!--]--> CSS module 局部作用域 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#权限控制" class="router-link-active router-link-exact-active sidebar-item" aria-label="权限控制"><!--[--><!--]--> 权限控制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#模块模式" class="router-link-active router-link-exact-active sidebar-item" aria-label="模块模式"><!--[--><!--]--> 模块模式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#记忆-memo" class="router-link-active router-link-exact-active sidebar-item" aria-label="记忆 memo"><!--[--><!--]--> 记忆 memo <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#file-type-不可靠" class="router-link-active router-link-exact-active sidebar-item" aria-label="file.type 不可靠"><!--[--><!--]--> file.type 不可靠 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#动态样式" class="router-link-active router-link-exact-active sidebar-item" aria-label="动态样式"><!--[--><!--]--> 动态样式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#undefined-未赋值-null-值为空" class="router-link-active router-link-exact-active sidebar-item" aria-label="undefined 未赋值 null 值为空"><!--[--><!--]--> undefined 未赋值 null 值为空 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#less-alpha" class="router-link-active router-link-exact-active sidebar-item" aria-label="less alpha"><!--[--><!--]--> less alpha <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-日期选择-预设日期" class="router-link-active router-link-exact-active sidebar-item" aria-label="antd 日期选择 预设日期"><!--[--><!--]--> antd 日期选择 预设日期 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#特殊选中需求" class="router-link-active router-link-exact-active sidebar-item" aria-label="特殊选中需求"><!--[--><!--]--> 特殊选中需求 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#使用-传递对象-修改时-注意提前-clone-不要影响原对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用 传递对象，修改时，注意提前 clone，不要影响原对象"><!--[--><!--]--> 使用 传递对象，修改时，注意提前 clone，不要影响原对象 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#审核自动切换" class="router-link-active router-link-exact-active sidebar-item" aria-label="审核自动切换"><!--[--><!--]--> 审核自动切换 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#css-hover-不适用内容有间距场景" class="router-link-active router-link-exact-active sidebar-item" aria-label="css hover 不适用内容有间距场景"><!--[--><!--]--> css hover 不适用内容有间距场景 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-日期组件返回的时间是当时时间" class="router-link-active router-link-exact-active sidebar-item" aria-label="antd 日期组件返回的时间是当时时间"><!--[--><!--]--> antd 日期组件返回的时间是当时时间 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#replace-designlayout-with-prolayout" class="router-link-active router-link-exact-active sidebar-item" aria-label="replace DesignLayout with ProLayout"><!--[--><!--]--> replace DesignLayout with ProLayout <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#权限处理" class="router-link-active router-link-exact-active sidebar-item" aria-label="权限处理"><!--[--><!--]--> 权限处理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#ts-demo" class="router-link-active router-link-exact-active sidebar-item" aria-label="ts demo"><!--[--><!--]--> ts demo <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#percent-事件频繁导致-多个组件过度-render" class="router-link-active router-link-exact-active sidebar-item" aria-label="percent 事件频繁导致 多个组件过度 render"><!--[--><!--]--> percent 事件频繁导致 多个组件过度 render <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#跨代数据共享" class="router-link-active router-link-exact-active sidebar-item" aria-label="跨代数据共享"><!--[--><!--]--> 跨代数据共享 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#我是如何无缝的扩展-antd-组件-知乎" class="router-link-active router-link-exact-active sidebar-item" aria-label="我是如何无缝的扩展 antd 组件 - 知乎"><!--[--><!--]--> 我是如何无缝的扩展 antd 组件 - 知乎 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#ant-design-repo" class="router-link-active router-link-exact-active sidebar-item" aria-label="ant design repo"><!--[--><!--]--> ant design repo <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#高阶组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="高阶组件"><!--[--><!--]--> 高阶组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-强烈风格-不适合较大定制" class="router-link-active router-link-exact-active sidebar-item" aria-label="Antd 强烈风格，不适合较大定制"><!--[--><!--]--> Antd 强烈风格，不适合较大定制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#线上-设计素材浏览有个-bug-切换二级菜单时-列表数据某些场景会互相影响" class="router-link-active router-link-exact-active sidebar-item" aria-label="线上 设计素材浏览有个 bug，切换二级菜单时，列表数据某些场景会互相影响"><!--[--><!--]--> 线上 设计素材浏览有个 bug，切换二级菜单时，列表数据某些场景会互相影响 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#图标替换" class="router-link-active router-link-exact-active sidebar-item" aria-label="图标替换"><!--[--><!--]--> 图标替换 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#require-文件不存在" class="router-link-active router-link-exact-active sidebar-item" aria-label="require 文件不存在"><!--[--><!--]--> require 文件不存在 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#react-如何点击页面空白处关闭弹窗" class="router-link-active router-link-exact-active sidebar-item" aria-label="React 如何点击页面空白处关闭弹窗"><!--[--><!--]--> React 如何点击页面空白处关闭弹窗 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-env-页面内不要解构-process-env" class="router-link-active router-link-exact-active sidebar-item" aria-label="umi env 页面内不要解构 p​rocess.env"><!--[--><!--]--> umi env 页面内不要解构 p​rocess.env <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#form-field-避免下标访问-不利于扩展" class="router-link-active router-link-exact-active sidebar-item" aria-label="form field 避免下标访问，不利于扩展"><!--[--><!--]--> form field 避免下标访问，不利于扩展 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#公共组件样式" class="router-link-active router-link-exact-active sidebar-item" aria-label="公共组件样式"><!--[--><!--]--> 公共组件样式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#husky" class="router-link-active router-link-exact-active sidebar-item" aria-label="husky"><!--[--><!--]--> husky <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-range-picker-blur-hide-如何实现" class="router-link-active router-link-exact-active sidebar-item" aria-label="antd range-picker blur hide 如何实现"><!--[--><!--]--> antd range-picker blur hide 如何实现 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#stylelint-异常输出" class="router-link-active router-link-exact-active sidebar-item" aria-label="stylelint 异常输出"><!--[--><!--]--> stylelint 异常输出 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-request-requesttype-生效条件" class="router-link-active router-link-exact-active sidebar-item" aria-label="umi-request requestType 生效条件"><!--[--><!--]--> umi-request requestType 生效条件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#createportal-左右切换时-生成多余-div" class="router-link-active router-link-exact-active sidebar-item" aria-label="createPortal，左右切换时，生成多余 div"><!--[--><!--]--> createPortal，左右切换时，生成多余 div <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#todo-material-lib" class="router-link-active router-link-exact-active sidebar-item" aria-label="todo material-lib"><!--[--><!--]--> todo material-lib <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#react-hooks-四-immutable-知乎" class="router-link-active router-link-exact-active sidebar-item" aria-label="React Hooks(四): immutable - 知乎"><!--[--><!--]--> React Hooks(四): immutable - 知乎 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#caches-操作要求-https" class="router-link-active router-link-exact-active sidebar-item" aria-label="caches 操作要求 https"><!--[--><!--]--> caches 操作要求 https <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#请求优化-token-是否存在或在有效期内" class="router-link-active router-link-exact-active sidebar-item" aria-label="请求优化，token 是否存在或在有效期内"><!--[--><!--]--> 请求优化，token 是否存在或在有效期内 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#static-proptypes" class="router-link-active router-link-exact-active sidebar-item" aria-label="static propTypes"><!--[--><!--]--> static propTypes <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#何时单独用-xhr" class="router-link-active router-link-exact-active sidebar-item" aria-label="何时单独用 xhr"><!--[--><!--]--> 何时单独用 xhr <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#immerjs-优于使用-lodash-创建拷贝" class="router-link-active router-link-exact-active sidebar-item" aria-label="ImmerJS 优于使用 lodash 创建拷贝"><!--[--><!--]--> ImmerJS 优于使用 lodash 创建拷贝 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#竞速-race" class="router-link-active router-link-exact-active sidebar-item" aria-label="竞速 race"><!--[--><!--]--> 竞速 race <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#upload-drag-扩大区域" class="router-link-active router-link-exact-active sidebar-item" aria-label="upload drag 扩大区域"><!--[--><!--]--> upload drag 扩大区域 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#定位代码最快方式" class="router-link-active router-link-exact-active sidebar-item" aria-label="定位代码最快方式"><!--[--><!--]--> 定位代码最快方式 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#开发阶段-eslint-影响初期效率" class="router-link-active router-link-exact-active sidebar-item" aria-label="开发阶段 eslint 影响初期效率"><!--[--><!--]--> 开发阶段 eslint 影响初期效率 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#临时禁用-lint" class="router-link-active router-link-exact-active sidebar-item" aria-label="临时禁用 lint"><!--[--><!--]--> 临时禁用 lint <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#空数组约定" class="router-link-active router-link-exact-active sidebar-item" aria-label="空数组约定"><!--[--><!--]--> 空数组约定 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#map-key" class="router-link-active router-link-exact-active sidebar-item" aria-label="map key"><!--[--><!--]--> map key <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#hmr-fast-refresh" class="router-link-active router-link-exact-active sidebar-item" aria-label="HMR =&gt; Fast Refresh"><!--[--><!--]--> HMR =&gt; Fast Refresh <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#dan-note" class="router-link-active router-link-exact-active sidebar-item" aria-label="dan note"><!--[--><!--]--> dan note <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#constructor-里发请求" class="router-link-active router-link-exact-active sidebar-item" aria-label="constructor 里发请求？"><!--[--><!--]--> constructor 里发请求？ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#自定义-tag" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义 Tag"><!--[--><!--]--> 自定义 Tag <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#jsx-map-join-reduce" class="router-link-active router-link-exact-active sidebar-item" aria-label="jsx map join =&gt; reduce"><!--[--><!--]--> jsx map join =&gt; reduce <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#pages-重复渲染-尤其-audio-有动画明显" class="router-link-active router-link-exact-active sidebar-item" aria-label="pages 重复渲染，尤其 audio 有动画明显"><!--[--><!--]--> pages 重复渲染，尤其 audio 有动画明显 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#effect-相关函数处理" class="router-link-active router-link-exact-active sidebar-item" aria-label="effect 相关函数处理："><!--[--><!--]--> effect 相关函数处理： <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#modal-router" class="router-link-active router-link-exact-active sidebar-item" aria-label="modal router"><!--[--><!--]--> modal router <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#鼠标进入触发-lottie" class="router-link-active router-link-exact-active sidebar-item" aria-label="鼠标进入触发 lottie"><!--[--><!--]--> 鼠标进入触发 lottie <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-table" class="router-link-active router-link-exact-active sidebar-item" aria-label="antd table"><!--[--><!--]--> antd table <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#state-派生自-prop-组件内又修改-state" class="router-link-active router-link-exact-active sidebar-item" aria-label="state 派生自 prop，组件内又修改 state"><!--[--><!--]--> state 派生自 prop，组件内又修改 state <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#第二层弹窗问题" class="router-link-active router-link-exact-active sidebar-item" aria-label="第二层弹窗问题"><!--[--><!--]--> 第二层弹窗问题 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#redux-dev-tool-crash" class="router-link-active router-link-exact-active sidebar-item" aria-label="redux dev tool crash"><!--[--><!--]--> redux dev tool crash <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#无效组件" class="router-link-active router-link-exact-active sidebar-item" aria-label="无效组件"><!--[--><!--]--> 无效组件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#点击文本复制" class="router-link-active router-link-exact-active sidebar-item" aria-label="点击文本复制"><!--[--><!--]--> 点击文本复制 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#半受控-props-变化-需要更新部分-state" class="router-link-active router-link-exact-active sidebar-item" aria-label="半受控，props 变化，需要更新部分 state"><!--[--><!--]--> 半受控，props 变化，需要更新部分 state <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#缓存计算" class="router-link-active router-link-exact-active sidebar-item" aria-label="缓存计算"><!--[--><!--]--> 缓存计算 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#ripple-btn" class="router-link-active router-link-exact-active sidebar-item" aria-label="ripple btn"><!--[--><!--]--> ripple btn <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#跨组件引用可变对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="跨组件引用可变对象"><!--[--><!--]--> 跨组件引用可变对象 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#webpack-cpu占用高" class="router-link-active router-link-exact-active sidebar-item" aria-label="webpack CPU占用高"><!--[--><!--]--> webpack CPU占用高 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#表格踩坑-最佳实践" class="router-link-active router-link-exact-active sidebar-item" aria-label="表格踩坑，最佳实践"><!--[--><!--]--> 表格踩坑，最佳实践 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/frameworks/react-issues.html#url-hash-变化-如何更新页面" class="router-link-active router-link-exact-active sidebar-item" aria-label="URL hash 变化，如何更新页面"><!--[--><!--]--> URL hash 变化，如何更新页面 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/frameworks/react-native.html" class="sidebar-item" aria-label="React Native"><!--[--><!--]--> React Native <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react-router.html" class="sidebar-item" aria-label="react-router.md"><!--[--><!--]--> react-router.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react-source-code.html" class="sidebar-item" aria-label="React source code"><!--[--><!--]--> React source code <!--[--><!--]--></a><!----></li><li><a href="/frameworks/react.html" class="sidebar-item" aria-label="React"><!--[--><!--]--> React <!--[--><!--]--></a><!----></li><li><a href="/frameworks/redux.html" class="sidebar-item" aria-label="Redux"><!--[--><!--]--> Redux <!--[--><!--]--></a><!----></li><li><a href="/frameworks/remix.html" class="sidebar-item" aria-label="remix.md"><!--[--><!--]--> remix.md <!--[--><!--]--></a><!----></li><li><a href="/frameworks/solidjs.html" class="sidebar-item" aria-label="SolidJS"><!--[--><!--]--> SolidJS <!--[--><!--]--></a><!----></li><li><a href="/frameworks/svelte.html" class="sidebar-item" aria-label="Svelte"><!--[--><!--]--> Svelte <!--[--><!--]--></a><!----></li><li><a href="/frameworks/swiper.html" class="sidebar-item" aria-label="Swiper"><!--[--><!--]--> Swiper <!--[--><!--]--></a><!----></li><li><a href="/frameworks/tailwind.html" class="sidebar-item" aria-label="Tailwind CSS"><!--[--><!--]--> Tailwind CSS <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vite.html" class="sidebar-item" aria-label="vite"><!--[--><!--]--> vite <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue-components.html" class="sidebar-item" aria-label="vue-components"><!--[--><!--]--> vue-components <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue-router.html" class="sidebar-item" aria-label="vue-router"><!--[--><!--]--> vue-router <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue.html" class="sidebar-item" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue2-source-code.html" class="sidebar-item" aria-label="Vue 源码学习"><!--[--><!--]--> Vue 源码学习 <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue3-source-code.html" class="sidebar-item" aria-label="Vue 3 源码学习"><!--[--><!--]--> Vue 3 源码学习 <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vue3.html" class="sidebar-item" aria-label="Vue 3"><!--[--><!--]--> Vue 3 <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vuejs-issues.html" class="sidebar-item" aria-label="vue-issues"><!--[--><!--]--> vue-issues <!--[--><!--]--></a><!----></li><li><a href="/frameworks/vuex.html" class="sidebar-item" aria-label="Vuex"><!--[--><!--]--> Vuex <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="react-issues" tabindex="-1"><a class="header-anchor" href="#react-issues" aria-hidden="true">#</a> react issues</h1><nav class="table-of-contents"><ul><li><a aria-current="page" href="/frameworks/react-issues.html#页面结构" class="router-link-active router-link-exact-active">页面结构</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#注意" class="router-link-active router-link-exact-active">注意</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#page-bare-template" class="router-link-active router-link-exact-active">page bare template</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#typescript" class="router-link-active router-link-exact-active">TypeScript</a><ul><li><a aria-current="page" href="/frameworks/react-issues.html#json-快速生成-ts" class="router-link-active router-link-exact-active">JSON 快速生成 TS</a></li></ul></li><li><a aria-current="page" href="/frameworks/react-issues.html#影响效率因素" class="router-link-active router-link-exact-active">影响效率因素</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#新建页面" class="router-link-active router-link-exact-active">新建页面</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#表格实现" class="router-link-active router-link-exact-active">表格实现</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#路径-routes" class="router-link-active router-link-exact-active">路径 routes</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#connect" class="router-link-active router-link-exact-active">connect</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#解构对象内容" class="router-link-active router-link-exact-active">解构对象内容</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#checkbox-group" class="router-link-active router-link-exact-active">checkbox.group</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#classnames" class="router-link-active router-link-exact-active">classNames</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-requesttype-默认是-json-可选-form" class="router-link-active router-link-exact-active">umi requestType 默认是 json，可选 form</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#iconfont-cn-use-in-antd" class="router-link-active router-link-exact-active">iconfont.cn use in antd</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#hover-exclude" class="router-link-active router-link-exact-active">hover exclude</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#useeffect-反复执行" class="router-link-active router-link-exact-active">useEffect 反复执行</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#数据联动" class="router-link-active router-link-exact-active">数据联动</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-form-onfinished" class="router-link-active router-link-exact-active">antd form onFinished</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#hook-state-拆分合并原则" class="router-link-active router-link-exact-active">hook state 拆分合并原则</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#可以在函数内直接申明普通常量或普通函数吗" class="router-link-active router-link-exact-active">可以在函数内直接申明普通常量或普通函数吗？</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#useeffect-不要用-async-use-usecallback-instead" class="router-link-active router-link-exact-active">useEffect 不要用 async, use useCallback instead</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#list-virtualized" class="router-link-active router-link-exact-active">list virtualized</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#生命周期模拟-useeffect" class="router-link-active router-link-exact-active">生命周期模拟 useEffect</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#calc-px-计算" class="router-link-active router-link-exact-active">calc px 计算</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#播放器能支持哪些文件类型" class="router-link-active router-link-exact-active">播放器能支持哪些文件类型</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#使用多个-usestate-或-usereducer" class="router-link-active router-link-exact-active">使用多个 useState 或 useReducer</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#复杂-state-逻辑建议用-react-自带-usereducer" class="router-link-active router-link-exact-active">复杂 state 逻辑建议用 React 自带 useReducer</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#自定义-hook" class="router-link-active router-link-exact-active">自定义 hook</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#rangepicker-没有样式" class="router-link-active router-link-exact-active">RangePicker 没有样式</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#dva-使用" class="router-link-active router-link-exact-active">dva 使用</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-权限组件" class="router-link-active router-link-exact-active">antd 权限组件</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#hook-dva-snip" class="router-link-active router-link-exact-active">hook dva snip</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-ui" class="router-link-active router-link-exact-active">umi ui</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#自定义左侧菜单-icon" class="router-link-active router-link-exact-active">自定义左侧菜单 icon</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#动态-menu" class="router-link-active router-link-exact-active">动态 menu</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#参数路由" class="router-link-active router-link-exact-active">参数路由</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#layouts" class="router-link-active router-link-exact-active">layouts</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#视图无关的数据" class="router-link-active router-link-exact-active">视图无关的数据</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#re-render" class="router-link-active router-link-exact-active">re-render</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#why-mapstate-mapdispatch" class="router-link-active router-link-exact-active">why mapState mapDispatch</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#容器组件模式" class="router-link-active router-link-exact-active">容器组件模式</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-简化数据流方案" class="router-link-active router-link-exact-active">umi 简化数据流方案</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#class-组件不能用-hooks" class="router-link-active router-link-exact-active">class 组件不能用 hooks</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#form-表单数据存储到上层组件" class="router-link-active router-link-exact-active">form 表单数据存储到上层组件</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#warning-antd-upload-value-is-not-a-valid-prop-do-you-mean-filelist" class="router-link-active router-link-exact-active">Warning: [antd: Upload] value is not a valid prop, do you mean fileList?</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#unhandled-rejection-typeerror-object-is-not-a-function" class="router-link-active router-link-exact-active">Unhandled Rejection (TypeError): Object(...) is not a function</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#使用-upload-组件上传图片提示-uncaught-error-must-set-key-for-rc-animate-children" class="router-link-active router-link-exact-active">使用 upload 组件上传图片提示：Uncaught Error: must set key for &lt;rc-animate&gt; children</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#error-too-many-re-renders-react-limits-the-number-of-renders-to-prevent-an-infinite-loop" class="router-link-active router-link-exact-active">Error: Too many re-renders. React limits the number of renders to prevent an infinite loop.</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#自定义表单控件" class="router-link-active router-link-exact-active">自定义表单控件</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#usemodel-是否会触发-redux-插件" class="router-link-active router-link-exact-active">useModel 是否会触发 redux 插件</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#给定深层数据-id-tree-结构定位" class="router-link-active router-link-exact-active">给定深层数据 id，tree 结构定位</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-官方-dragger-丢失文件" class="router-link-active router-link-exact-active">antd 官方 dragger 丢失文件</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#useeffect-函数惰性-绑定函数记忆的可以是旧的依赖值" class="router-link-active router-link-exact-active">useEffect 函数惰性，绑定函数记忆的可以是旧的依赖值</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#切换素材时-form-item-下发的-value-不更新-故改为手动传" class="router-link-active router-link-exact-active">切换素材时，Form.item 下发的 value 不更新，故改为手动传</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#react-props-默认值使用非基础类型-引起不必要更新" class="router-link-active router-link-exact-active">react props 默认值使用非基础类型 引起不必要更新</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#failed-to-execute-clone-on-response-umi" class="router-link-active router-link-exact-active">Failed to execute &#39;clone&#39; on &#39;Response&#39; umi</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-layout" class="router-link-active router-link-exact-active">antd layout</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#menu" class="router-link-active router-link-exact-active">menu</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#usemodel-持久化-浅拷贝数据里如果有对象-对象经修改-会保持" class="router-link-active router-link-exact-active">useModel 持久化，浅拷贝数据里如果有对象 对象经修改，会保持</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#异步权限" class="router-link-active router-link-exact-active">异步权限</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#关闭菜单国际化" class="router-link-active router-link-exact-active">关闭菜单国际化</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#对象意外修改" class="router-link-active router-link-exact-active">对象意外修改</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#总结自己使用过的-hooks-数据流方式-掘金" class="router-link-active router-link-exact-active">总结自己使用过的 Hooks 数据流方式 - 掘金</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#css-module-局部作用域" class="router-link-active router-link-exact-active">CSS module 局部作用域</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#权限控制" class="router-link-active router-link-exact-active">权限控制</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#模块模式" class="router-link-active router-link-exact-active">模块模式</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#记忆-memo" class="router-link-active router-link-exact-active">记忆 memo</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#file-type-不可靠" class="router-link-active router-link-exact-active">file.type 不可靠</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#动态样式" class="router-link-active router-link-exact-active">动态样式</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#undefined-未赋值-null-值为空" class="router-link-active router-link-exact-active">undefined 未赋值 null 值为空</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#less-alpha" class="router-link-active router-link-exact-active">less alpha</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-日期选择-预设日期" class="router-link-active router-link-exact-active">antd 日期选择 预设日期</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#特殊选中需求" class="router-link-active router-link-exact-active">特殊选中需求</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#使用-传递对象-修改时-注意提前-clone-不要影响原对象" class="router-link-active router-link-exact-active">使用 传递对象，修改时，注意提前 clone，不要影响原对象</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#审核自动切换" class="router-link-active router-link-exact-active">审核自动切换</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#css-hover-不适用内容有间距场景" class="router-link-active router-link-exact-active">css hover 不适用内容有间距场景</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-日期组件返回的时间是当时时间" class="router-link-active router-link-exact-active">antd 日期组件返回的时间是当时时间</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#replace-designlayout-with-prolayout" class="router-link-active router-link-exact-active">replace DesignLayout with ProLayout</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#权限处理" class="router-link-active router-link-exact-active">权限处理</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#ts-demo" class="router-link-active router-link-exact-active">ts demo</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#percent-事件频繁导致-多个组件过度-render" class="router-link-active router-link-exact-active">percent 事件频繁导致 多个组件过度 render</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#跨代数据共享" class="router-link-active router-link-exact-active">跨代数据共享</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#我是如何无缝的扩展-antd-组件-知乎" class="router-link-active router-link-exact-active">我是如何无缝的扩展 antd 组件 - 知乎</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#ant-design-repo" class="router-link-active router-link-exact-active">ant design repo</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#高阶组件" class="router-link-active router-link-exact-active">高阶组件</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-强烈风格-不适合较大定制" class="router-link-active router-link-exact-active">Antd 强烈风格，不适合较大定制</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#线上-设计素材浏览有个-bug-切换二级菜单时-列表数据某些场景会互相影响" class="router-link-active router-link-exact-active">线上 设计素材浏览有个 bug，切换二级菜单时，列表数据某些场景会互相影响</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#图标替换" class="router-link-active router-link-exact-active">图标替换</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#require-文件不存在" class="router-link-active router-link-exact-active">require 文件不存在</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#react-如何点击页面空白处关闭弹窗" class="router-link-active router-link-exact-active">React 如何点击页面空白处关闭弹窗</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-env-页面内不要解构-process-env" class="router-link-active router-link-exact-active">umi env 页面内不要解构 p<wbr>rocess.env</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#form-field-避免下标访问-不利于扩展" class="router-link-active router-link-exact-active">form field 避免下标访问，不利于扩展</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#公共组件样式" class="router-link-active router-link-exact-active">公共组件样式</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#husky" class="router-link-active router-link-exact-active">husky</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-range-picker-blur-hide-如何实现" class="router-link-active router-link-exact-active">antd range-picker blur hide 如何实现</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#stylelint-异常输出" class="router-link-active router-link-exact-active">stylelint 异常输出</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#umi-request-requesttype-生效条件" class="router-link-active router-link-exact-active">umi-request requestType 生效条件</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#createportal-左右切换时-生成多余-div" class="router-link-active router-link-exact-active">createPortal，左右切换时，生成多余 div</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#todo-material-lib" class="router-link-active router-link-exact-active">todo material-lib</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#react-hooks-四-immutable-知乎" class="router-link-active router-link-exact-active">React Hooks(四): immutable - 知乎</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#caches-操作要求-https" class="router-link-active router-link-exact-active">caches 操作要求 https</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#请求优化-token-是否存在或在有效期内" class="router-link-active router-link-exact-active">请求优化，token 是否存在或在有效期内</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#static-proptypes" class="router-link-active router-link-exact-active">static propTypes</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#何时单独用-xhr" class="router-link-active router-link-exact-active">何时单独用 xhr</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#immerjs-优于使用-lodash-创建拷贝" class="router-link-active router-link-exact-active">ImmerJS 优于使用 lodash 创建拷贝</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#竞速-race" class="router-link-active router-link-exact-active">竞速 race</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#upload-drag-扩大区域" class="router-link-active router-link-exact-active">upload drag 扩大区域</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#定位代码最快方式" class="router-link-active router-link-exact-active">定位代码最快方式</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#开发阶段-eslint-影响初期效率" class="router-link-active router-link-exact-active">开发阶段 eslint 影响初期效率</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#临时禁用-lint" class="router-link-active router-link-exact-active">临时禁用 lint</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#空数组约定" class="router-link-active router-link-exact-active">空数组约定</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#map-key" class="router-link-active router-link-exact-active">map key</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#hmr-fast-refresh" class="router-link-active router-link-exact-active">HMR =&gt; Fast Refresh</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#dan-note" class="router-link-active router-link-exact-active">dan note</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#constructor-里发请求" class="router-link-active router-link-exact-active">constructor 里发请求？</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#自定义-tag" class="router-link-active router-link-exact-active">自定义 Tag</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#jsx-map-join-reduce" class="router-link-active router-link-exact-active">jsx map join =&gt; reduce</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#pages-重复渲染-尤其-audio-有动画明显" class="router-link-active router-link-exact-active">pages 重复渲染，尤其 audio 有动画明显</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#effect-相关函数处理" class="router-link-active router-link-exact-active">effect 相关函数处理：</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#modal-router" class="router-link-active router-link-exact-active">modal router</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#鼠标进入触发-lottie" class="router-link-active router-link-exact-active">鼠标进入触发 lottie</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#antd-table" class="router-link-active router-link-exact-active">antd table</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#state-派生自-prop-组件内又修改-state" class="router-link-active router-link-exact-active">state 派生自 prop，组件内又修改 state</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#第二层弹窗问题" class="router-link-active router-link-exact-active">第二层弹窗问题</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#redux-dev-tool-crash" class="router-link-active router-link-exact-active">redux dev tool crash</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#无效组件" class="router-link-active router-link-exact-active">无效组件</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#点击文本复制" class="router-link-active router-link-exact-active">点击文本复制</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#半受控-props-变化-需要更新部分-state" class="router-link-active router-link-exact-active">半受控，props 变化，需要更新部分 state</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#缓存计算" class="router-link-active router-link-exact-active">缓存计算</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#ripple-btn" class="router-link-active router-link-exact-active">ripple btn</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#跨组件引用可变对象" class="router-link-active router-link-exact-active">跨组件引用可变对象</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#webpack-cpu占用高" class="router-link-active router-link-exact-active">webpack CPU占用高</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#表格踩坑-最佳实践" class="router-link-active router-link-exact-active">表格踩坑，最佳实践</a></li><li><a aria-current="page" href="/frameworks/react-issues.html#url-hash-变化-如何更新页面" class="router-link-active router-link-exact-active">URL hash 变化，如何更新页面</a></li></ul></nav><h2 id="页面结构" tabindex="-1"><a class="header-anchor" href="#页面结构" aria-hidden="true">#</a> 页面结构</h2><div class="language-text ext-text"><pre class="language-text"><code>page =&gt; connect

components

dva model
</code></pre></div><h2 id="注意" tabindex="-1"><a class="header-anchor" href="#注意" aria-hidden="true">#</a> 注意</h2><ul><li><p>不能缺少文件，文件不能为空</p><p>样式占位</p><div class="language-css ext-css"><pre class="language-css"><code><span class="token selector">.xx</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> initial<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li><li><p>modal 可以用别的页面复制一个</p></li><li><p>routes -&gt; config -&gt; index</p></li></ul><h2 id="page-bare-template" tabindex="-1"><a class="header-anchor" href="#page-bare-template" aria-hidden="true">#</a> page bare template</h2><ol><li>export function</li></ol><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token comment">// import &#39;./index.less&#39;;</span>
<span class="token comment">// import styles from &#39;./index.less&#39;;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Comp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>detail hello<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Comp
</code></pre></div><ol start="2"><li>export component</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token comment">// import styles from &#39;./index.less&#39;;</span>
<span class="token keyword">const</span> propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  <span class="token literal-property property">text</span><span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string
<span class="token punctuation">}</span>
<span class="token keyword">const</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&#39;Hello World&#39;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Comp</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">hello</span><span class="token operator">:</span> <span class="token string">&#39;world&#39;</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> hello <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token punctuation">{</span>hello<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Comp<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> propTypes
Comp<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> defaultProps
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li><p>提示：</p><div class="language-text ext-text"><pre class="language-text"><code>Each record in table should have a unique `key` prop,or set `rowKey` to an unique primary key. #7623
</code></pre></div><p>mock 数据，id 重了</p></li><li><p>全局安装 <code>yarn global add typescript</code></p></li></ul><h2 id="typescript" tabindex="-1"><a class="header-anchor" href="#typescript" aria-hidden="true">#</a> TypeScript</h2><p>校验：</p><ul><li><p>antd 引入应该在 interface 之前</p></li><li><p>命名不要重名</p><p>组件 -&gt; model(数据) -&gt; interface(TS)</p><p>dva model 小写</p><p>interface 单独命名，辅助性的，重要性低</p><p>组件名只定义一次，没啥问题</p><p>批量重命名踩坑，替换时正则需要使用大小写敏感</p></li><li><p>event 定义</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token function">onUpdatingServerName</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">event</span><span class="token operator">:</span> React<span class="token punctuation">.</span>ChangeEvent<span class="token operator">&lt;</span>HTMLInputElement<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>newserverName <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/44321326/property-value-does-not-exist-on-type-eventtarget-in-typescript/44321394" target="_blank" rel="noopener noreferrer">javascript - Property &#39;value&#39; does not exist on type EventTarget in TypeScript - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><h3 id="json-快速生成-ts" tabindex="-1"><a class="header-anchor" href="#json-快速生成-ts" aria-hidden="true">#</a> JSON 快速生成 TS</h3><ol><li>vscode 新建文件</li><li>复制有效的 JSON，需要带上括号</li><li>执行<code>Paste JSON as TYPE</code></li></ol><ul><li><p>any 慎用，那什么时候用呢？a. 用户输入 b. 不知道数组内数据类型</p></li><li><p>拆分粒度</p></li><li><p>render 不能用 async，不能 setState</p></li><li><p>?</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  curPaymentMethod <span class="token operator">===</span> <span class="token string">&#39;1&#39;</span> <span class="token operator">?</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>AliPayModal
      visible<span class="token operator">=</span><span class="token punctuation">{</span>modalVisible<span class="token punctuation">}</span>
      onCancel<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>closeModal<span class="token punctuation">}</span>
      onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onPayDone<span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>WechatPayModal
      visible<span class="token operator">=</span><span class="token punctuation">{</span>modalVisible<span class="token punctuation">}</span>
      onCancel<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>closeModal<span class="token punctuation">}</span>
      onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onPayDone<span class="token punctuation">}</span>
      qrCodeStr<span class="token operator">=</span><span class="token string">&quot;hahajl&quot;</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Uncaught Invariant Violation: Objects are not valid as a React child (found: [object Promise]). If you meant to render a collection of children, use an array instead. in WechatPayModal (created by Pay)</p></blockquote></li><li><p>路由 components 与子 routes 互 chi？</p></li><li><p>func comp 在父层处理 async，请求后或 dismount</p></li><li><p>antd ts 在 node_modules 中找</p></li><li><p>只检验 stashed</p></li><li><p>ts 函数要写明返回</p></li></ul><h2 id="影响效率因素" tabindex="-1"><a class="header-anchor" href="#影响效率因素" aria-hidden="true">#</a> 影响效率因素</h2><ul><li>熟练手写 ts，类型补全或自定义 snip</li><li>dom 闭合补全 &gt; emmet 可以用</li><li>timeout ts number window.setTimeout</li><li>obj / array 如果有内容，内容也要 ts 定义</li><li>serve:no-mock</li></ul><h2 id="新建页面" tabindex="-1"><a class="header-anchor" href="#新建页面" aria-hidden="true">#</a> 新建页面</h2><ol><li><p>验证路由配置是否正确，最小步骤</p><ol><li>add route</li><li>add pages index.js，不要创建其它文件，会报错</li></ol></li><li><p>新建 service，确认需要使用的全部接口，有多少接口写多少 model</p></li><li><p>新建 model，写这个时与 service side by side，入参需要看下 showDoc</p></li></ol><h2 id="表格实现" tabindex="-1"><a class="header-anchor" href="#表格实现" aria-hidden="true">#</a> 表格实现</h2><div class="language-text ext-text"><pre class="language-text"><code>~/Projects/work/AiJianZiPlatform/src/routes/Useradmin/BSchool/b-school.js

Card(title=&quot;filter node&quot;) // col - formItem - select
  StandardTable
</code></pre></div><ol start="2"><li>SearchList</li></ol><div class="language-text ext-text"><pre class="language-text"><code>~/Projects/work/ajz-admin-agency/src/pages/student-manage/student-account/index.tsx
</code></pre></div><ol start="3"><li>自己拼装 searchList 上面不能加东西 course-limit</li></ol><h2 id="路径-routes" tabindex="-1"><a class="header-anchor" href="#路径-routes" aria-hidden="true">#</a> 路径 routes</h2><ol><li>下级必须是上级子路径</li></ol><ul><li><p>提交操作，总是要考虑防止过快多次点击</p></li><li><p><a href="https://stackoverflow.com/questions/55265604/uncaught-invariant-violation-too-many-re-renders-react-limits-the-number-of-re" target="_blank" rel="noopener noreferrer">javascript - Uncaught Invariant Violation: Too many re-renders. React limits the number of renders to prevent an infinite loop - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> setState 被直接调用了</p></li><li><p>classNames 样式类合并</p></li><li><p>TS 不处理提交会影响别人，一定要处理、熟悉，提高效率</p></li><li><p>原型、设计，找别人确认，有疑问要早问，后续改成本高</p></li><li><p>我们把这个版本的 identity 函数叫做泛型，因为它可以适用于多个类型。 不同于使用 any，它不会丢失信息，像第一个例子那像保持准确性，传入数值类型并返回数值类型。</p></li></ul><h2 id="connect" tabindex="-1"><a class="header-anchor" href="#connect" aria-hidden="true">#</a> connect</h2><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">state</span><span class="token operator">:</span> ConnectState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> classes<span class="token punctuation">,</span> loading <span class="token punctuation">}</span> <span class="token operator">=</span> state
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    classes<span class="token punctuation">,</span>
    <span class="token literal-property property">loading</span><span class="token operator">:</span> loading<span class="token punctuation">.</span>effects<span class="token punctuation">[</span>queryBaseStatApi<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">saveLoading</span><span class="token operator">:</span> loading<span class="token punctuation">.</span>effects<span class="token punctuation">[</span>createClassApi<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>Page<span class="token punctuation">)</span>
</code></pre></div><p>React.FC 新类型，可以处理 state</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... props interface</span>
<span class="token punctuation">}</span>

<span class="token comment">// NEW syntax for typing function components</span>
<span class="token keyword">const</span> <span class="token literal-property property">MyNewComponent</span><span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token constant">FC</span><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token keyword">const</span> <span class="token literal-property property">FunctionComponent</span><span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token function-variable function">FC</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// The useState hook</span>
<span class="token punctuation">}</span>
</code></pre></div><p>hooks 返回 return undefined or a function</p><p><a href="https://levelup.gitconnected.com/usetypescript-a-complete-guide-to-react-hooks-and-typescript-db1858d1fb9c" target="_blank" rel="noopener noreferrer">useTypescript — A Complete Guide to React Hooks and TypeScript<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>max-length 会阻止输入，进而不触发验证提示</p><p>searchList ts 定义来自，tableColumns dataIndex</p><p>ts 参数用尖括号</p><p>ts 单独文件定义，跳转很方便</p><p>反击自动化</p><p>加验证头，能解决插件下载吗？ <a href="https://github.com/videojs/http-streaming/issues/357#issuecomment-374889346" target="_blank" rel="noopener noreferrer">Prevent downloading encrypted content with Firefox video download helper extension · Issue #357 · videojs/http-streaming<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="解构对象内容" tabindex="-1"><a class="header-anchor" href="#解构对象内容" aria-hidden="true">#</a> 解构对象内容</h2><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> body <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request <span class="token keyword">as</span> <span class="token punctuation">{</span> <span class="token literal-property property">body</span><span class="token operator">:</span> CreateOperation <span class="token punctuation">}</span>
</code></pre></div><h2 id="checkbox-group" tabindex="-1"><a class="header-anchor" href="#checkbox-group" aria-hidden="true">#</a> checkbox.group</h2><p>比较特殊，需要在 group 级控制子内容 checked 属性</p><p>defaultValue 设置后就不再变，列表条目切换会相互影响</p><p><s>value 设置后，点击状态不变，需要 onChange 把变化向上传递，再传回响应变化</s></p><h2 id="classnames" tabindex="-1"><a class="header-anchor" href="#classnames" aria-hidden="true">#</a> classNames</h2><p>这里 styles.disabled 是动态类名，要用数组下标方式包起来。字符串不需要</p><p><code>&lt;a className={classNames({ [styles.disabled]: !haveRoles })}</code></p><h2 id="umi-requesttype-默认是-json-可选-form" tabindex="-1"><a class="header-anchor" href="#umi-requesttype-默认是-json-可选-form" aria-hidden="true">#</a> umi requestType 默认是 json，可选 form</h2><h2 id="iconfont-cn-use-in-antd" tabindex="-1"><a class="header-anchor" href="#iconfont-cn-use-in-antd" aria-hidden="true">#</a> iconfont.cn use in antd</h2><p>createFromIconfontCN</p><h2 id="hover-exclude" tabindex="-1"><a class="header-anchor" href="#hover-exclude" aria-hidden="true">#</a> hover exclude</h2><p>Pointer events to the rescue!</p><p><a href="https://techstacker.com/css-remove-hover-pointer-events-none/" target="_blank" rel="noopener noreferrer">How to ignore Hover/Mouseover events on specific element in CSS with the pointer-events property – Techstacker<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="useeffect-反复执行" tabindex="-1"><a class="header-anchor" href="#useeffect-反复执行" aria-hidden="true">#</a> useEffect 反复执行</h2><p>trick 第二参数不变，只执行一次</p><p>配合第二参数、返回函数，相当于三个生命周期【挂载、更新、销毁】</p><h2 id="数据联动" tabindex="-1"><a class="header-anchor" href="#数据联动" aria-hidden="true">#</a> 数据联动</h2><ul><li>输入关键字 提交</li><li>标签选择 选中 提交 <ul><li>选中 不支持 反选</li><li>仅素材类型 限单选</li></ul></li><li>筛选 过滤回显 数据包含类型关系 <ul><li>顺序要求</li><li>删除、如何修改对应值</li></ul></li></ul><p>同级组件需要伟递事件，只能依靠 model 了？</p><p>searchParams</p><p>Function components cannot be given refs</p><h2 id="antd-form-onfinished" tabindex="-1"><a class="header-anchor" href="#antd-form-onfinished" aria-hidden="true">#</a> antd form onFinished</h2><p>通过时提交</p><h2 id="hook-state-拆分合并原则" tabindex="-1"><a class="header-anchor" href="#hook-state-拆分合并原则" aria-hidden="true">#</a> hook state 拆分合并原则</h2><ol><li>将完全不相关的 state 拆分为多组 state。比如 size 和 position。</li><li>如果某些 state 是相互关联的，或者需要一起发生改变，就可以把它们合并为一组 state。比如 left 和 top。</li></ol><p>依赖数组依赖的值最好不要超过 3 个，否则会导致代码会难以维护。 如果发现依赖数组依赖的值过多，我们应该采取一些方法来减少它。 去掉不必要的依赖。 将 Hook 拆分为更小的单元，每个 Hook 依赖于各自的依赖数组。 通过合并相关的 state，将多个依赖值聚合为一个。 通过 setState 回调函数获取最新的 state，以减少外部依赖。 通过 ref 来读取可变变量的值，不过需要注意控制修改它的途径。</p><p><a href="https://zhuanlan.zhihu.com/p/85969406" target="_blank" rel="noopener noreferrer">React Hooks 你真的用对了吗？ - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="可以在函数内直接申明普通常量或普通函数吗" tabindex="-1"><a class="header-anchor" href="#可以在函数内直接申明普通常量或普通函数吗" aria-hidden="true">#</a> 可以在函数内直接申明普通常量或普通函数吗？</h2><p>可以但不建议，Function Component 每次渲染都会重新执行，常量推荐放到函数外层避免性能问题，函数推荐使用 useCallback 申明。</p><p>简单的组件间通信使用透传 Props 变量的方式，而频繁组件间通信使用 React.useContext</p><p><a href="https://zhuanlan.zhihu.com/p/81752821" target="_blank" rel="noopener noreferrer">精读《React Hooks 最佳实践》 - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://zhuanlan.zhihu.com/p/94949118" target="_blank" rel="noopener noreferrer">《蚂蚁前端研发最佳实践》文字稿 - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>hook class 转换，多个 render 函数，里面是 return</p><p>getDerivedStateFromProps 介于 contructor 和 render 之间，响应 props 变化，返回 state</p><h2 id="useeffect-不要用-async-use-usecallback-instead" tabindex="-1"><a class="header-anchor" href="#useeffect-不要用-async-use-usecallback-instead" aria-hidden="true">#</a> useEffect 不要用 async, use useCallback instead</h2><p><a href="https://stackoverflow.com/questions/53332321/react-hook-warnings-for-async-function-in-useeffect-useeffect-function-must-ret" target="_blank" rel="noopener noreferrer">javascript - React Hook Warnings for async function in useEffect: useEffect function must return a cleanup function or nothing - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>useEffect 应该什么都不返回，而 async 隐式返回 promise</p><h2 id="list-virtualized" tabindex="-1"><a class="header-anchor" href="#list-virtualized" aria-hidden="true">#</a> list virtualized</h2><p>为大数据列表，性能优化，非必须</p><h2 id="生命周期模拟-useeffect" tabindex="-1"><a class="header-anchor" href="#生命周期模拟-useeffect" aria-hidden="true">#</a> 生命周期模拟 useEffect</h2><p>因为生命周期处理的都是副作用，在 hook 里就是用 useEffect</p><p>可以写多个 useEffect，给 effect fn 命名以区分职责</p><p>useEffect 每次渲染（DOM 更新）完执行 effect fn</p><blockquote><p>【合并】不用再去考虑“挂载”还是“更新”。React 保证了每次运行 effect 的同时，DOM 都已经更新完毕</p></blockquote><pre><code>生命周期对应 useEffect 用法：
</code></pre><ul><li>componentDidMount []</li><li>componentDidUpdate [states.count | props.count] 仅变化时调用，减少不必要执行</li><li>componentWillUnmount return function cleanup</li></ul><p>getDerivedStateFromProps 渲染中赋值，如果需要对比差异，可以增加缓存值</p><p>shouldComponentUpdate React.memo</p><p>什么是副作用，数据获取，browser api</p><p>render （提升成）函数本身，函数组件就是一个 render 函数</p><p><a href="https://juejin.im/post/5d3db4da518825016f644561" target="_blank" rel="noopener noreferrer">Hooks 与 React 生命周期的关系 - 掘金<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>hook 在最顶层调用，如果需要有条件执行，在 hook 内部判断</p><h2 id="calc-px-计算" tabindex="-1"><a class="header-anchor" href="#calc-px-计算" aria-hidden="true">#</a> calc px 计算</h2><p><a href="https://stackoverflow.com/questions/42548630/css3-calc-minus-vh-with-pixel/42556033" target="_blank" rel="noopener noreferrer">css - Css3 calc minus vh with pixel - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="播放器能支持哪些文件类型" tabindex="-1"><a class="header-anchor" href="#播放器能支持哪些文件类型" aria-hidden="true">#</a> 播放器能支持哪些文件类型</h2><p>第三方播放器取决于浏览器支持</p><p><a href="https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Containers" target="_blank" rel="noopener noreferrer">Media container formats (file types) - Web media technologies | MDN<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="使用多个-usestate-或-usereducer" tabindex="-1"><a class="header-anchor" href="#使用多个-usestate-或-usereducer" aria-hidden="true">#</a> 使用多个 useState 或 useReducer</h2><p>Should I use multiple useState or useReducer?</p><p>For independent things (isHovering and textInput), multiple useState. 独立状态，使用多个 useState</p><p>For things that change together (isFetching and fetchedItems), or if their next state depends on previous (todos), I prefer useReducer. 状态一起改变，或状态前后依赖，更倾向用 useReducer</p><h2 id="复杂-state-逻辑建议用-react-自带-usereducer" tabindex="-1"><a class="header-anchor" href="#复杂-state-逻辑建议用-react-自带-usereducer" aria-hidden="true">#</a> 复杂 state 逻辑建议用 React 自带 useReducer</h2><p>如果从组件状态上升到应用状态，用 Redux redux 不仅是状态管理，是一种架构 出了 bug，好定位</p><blockquote><p>我新开发的应用几乎都用到了 Redux，以前做选择是很简单的：几乎所有项目都用 Redux 就行了！ 当你向 Redux 状态添加内容时，加进来的是一个抽象层以及随之而来的复杂度。 换句话说，你大可放心使用 Redux，但是每次用到它时应该有合适的理由。</p></blockquote><p>使用理由：</p><ul><li>使用网络之类的 I/O 或设备 API。</li><li>保存或加载状态。</li><li>与非子组件共享其状态。 （如素材库的查找参数，多个组件更新，可以做为一个抽象层，不要跟别的逻辑混在一起）</li><li>需要与应用程序的其他部分共享业务逻辑或数据处理过程。</li></ul><p><a href="https://medium.com/javascript-scene/do-react-hooks-replace-redux-210bab340672" target="_blank" rel="noopener noreferrer">Do React Hooks Replace Redux? - JavaScript Scene - Medium<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="自定义-hook" tabindex="-1"><a class="header-anchor" href="#自定义-hook" aria-hidden="true">#</a> 自定义 hook</h2><ul><li>逻辑抽象</li><li>复用 <a href="https://juejin.im/post/5df8b978e51d45584006e1f5" target="_blank" rel="noopener noreferrer">基用 React Hooks + Antd 快速实现一个列表页 - 掘金<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="rangepicker-没有样式" tabindex="-1"><a class="header-anchor" href="#rangepicker-没有样式" aria-hidden="true">#</a> RangePicker 没有样式</h2><p>重启服务后正常</p><h2 id="dva-使用" tabindex="-1"><a class="header-anchor" href="#dva-使用" aria-hidden="true">#</a> dva 使用</h2><h2 id="antd-权限组件" tabindex="-1"><a class="header-anchor" href="#antd-权限组件" aria-hidden="true">#</a> antd 权限组件</h2><ul><li>layout 级的 authority 不起作用？</li><li>可以嵌套 layout，SecurityLayout &gt; BasicLayout &gt; page</li></ul><h2 id="hook-dva-snip" tabindex="-1"><a class="header-anchor" href="#hook-dva-snip" aria-hidden="true">#</a> hook dva snip</h2><h2 id="umi-ui" tabindex="-1"><a class="header-anchor" href="#umi-ui" aria-hidden="true">#</a> umi ui</h2><p>可视化配置工具，用处不大 查看模板可访问 <a href="https://preview.pro.ant.design/dashboard/analysis" target="_blank" rel="noopener noreferrer"><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 关闭参考<code>start:no-ui</code>命令</p><h2 id="自定义左侧菜单-icon" tabindex="-1"><a class="header-anchor" href="#自定义左侧菜单-icon" aria-hidden="true">#</a> 自定义左侧菜单 icon</h2><ol><li>defaultSettings iconfontUrl</li><li>修改 router config</li></ol><p><a href="https://prolayout.ant.design/" target="_blank" rel="noopener noreferrer">配置 api 介绍<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="动态-menu" tabindex="-1"><a class="header-anchor" href="#动态-menu" aria-hidden="true">#</a> 动态 menu</h2><p>setMenuData</p><h2 id="参数路由" tabindex="-1"><a class="header-anchor" href="#参数路由" aria-hidden="true">#</a> 参数路由</h2><h2 id="layouts" tabindex="-1"><a class="header-anchor" href="#layouts" aria-hidden="true">#</a> layouts</h2><p>UserLayout 就是上方有个 logo、下方留空，如给登录使用</p><h2 id="视图无关的数据" tabindex="-1"><a class="header-anchor" href="#视图无关的数据" aria-hidden="true">#</a> 视图无关的数据</h2><p>定义在 RFC 外面</p><h2 id="re-render" tabindex="-1"><a class="header-anchor" href="#re-render" aria-hidden="true">#</a> re-render</h2><p>每次 re-render，<strong>异步函数</strong>会创建新实例，原始版本不再指向正确的实例</p><p>使用 useCallback，并提供依赖值</p><h2 id="why-mapstate-mapdispatch" tabindex="-1"><a class="header-anchor" href="#why-mapstate-mapdispatch" aria-hidden="true">#</a> why mapState mapDispatch</h2><p>任何能在组件外以 redux action 方式生存的异步业务逻辑，考虑到使操作不受组件生命周期影响，仅定义为容器的 mapDispatchToProps 并传递给组件，这样意味着你的组件可免除异步逻辑、而变得相当简单，业务逻辑不再与视图紧耦合</p><p>展示组件唯一依赖来源 prop，不关心数据怎么来、不关心什么是 dispatch <a href="https://stackoverflow.com/questions/39419237/what-is-mapdispatchtoprops" target="_blank" rel="noopener noreferrer">reactjs - What is mapDispatchToProps? - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="容器组件模式" tabindex="-1"><a class="header-anchor" href="#容器组件模式" aria-hidden="true">#</a> 容器组件模式</h2><p>容器处理数据获取，然后渲染相应的子组件，就是这样</p><p>相应组件意味着同名，如 <code>StockWidgetContainer =&gt; StockWidget</code></p><p>数据获取和渲染职责分离、渲染组件可复用，渲染组件依靠 PropTypes 显式失败</p><p><a href="https://medium.com/@learnreact/container-components-c0e67432e005#.1a9j3w1jl" target="_blank" rel="noopener noreferrer">Container Components - Learn React with chantastic - Medium<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="umi-简化数据流方案" tabindex="-1"><a class="header-anchor" href="#umi-简化数据流方案" aria-hidden="true">#</a> umi 简化数据流方案</h2><p><a href="https://umijs.org/zh-CN/plugins/plugin-model" target="_blank" rel="noopener noreferrer">@umijs/plugin-model<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text"><pre class="language-text"><code>页面 pattern model/\*_/_ 或 \*.model.ts
pages/user/counter.model.js
pages/user/models/counter.js
useModel(&#39;user.counter&#39;)
</code></pre></div><p>namespace 小写命名，跟其它类型变量区分</p><p>有哪些 namespace 可用，编辑器会提示</p><p>发现还是全局请求了，意思是只支持全局，支持不同的放置位置</p><p>或者可以把方法导出去，只在需要的页面调用</p><p>https://github.com/umijs/umi/issues/5195#issuecomment-672527326 <a href="https://github.com/ant-design/ant-design-pro/issues/6605" target="_blank" rel="noopener noreferrer">Ant Design Pro V5 已经支持预览 · Issue #6605 · ant-design/ant-design-pro<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><p>对于轻量级的数据流我们都推荐这种方案。</p></blockquote><p><a href="https://zhuanlan.zhihu.com/p/103150605" target="_blank" rel="noopener noreferrer">Umi Hooks - 助力拥抱 React Hooks - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://juejin.im/post/5ee081e551882543221d8b42" target="_blank" rel="noopener noreferrer">Umi Hooks 实用代码片段整理 - 掘金<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text"><pre class="language-text"><code>import {useMouse, useWindowSize, useScroll} from &#39;react-use&#39;
</code></pre></div><h2 id="class-组件不能用-hooks" tabindex="-1"><a class="header-anchor" href="#class-组件不能用-hooks" aria-hidden="true">#</a> class 组件不能用 hooks</h2><blockquote><p>你可以用 hoc 包一层 数据逻辑极端复杂时，用 class</p></blockquote><p>React hooks 我也在项目中使用了一段时间，确实有它的优势的地方但是好像也没你文章里说的这么好，它确实是将逻辑复用变得更简单纯粹，但是我平时业务开发的时候，复用的不只是逻辑，ui 也需要复用。所以平时封装的时候，封装你文中这种和业务结合交大的自定义 hook 会比较少，大多数时候还是会封装那种 ui 和状态并存的常规组件，当然为了兼容差异化 ui 需求，会通过 render props 配合默认 render，或者使用内部 Context 实现的 Compound component，来将组件拆离成合理的 ui 粒度，同时保留内部逻辑，通过这两种方式来满足你文中提到的差异化 ui 的需求。使用自定义 hook，感觉还是那种工具类型的更合适些</p><h2 id="form-表单数据存储到上层组件" tabindex="-1"><a class="header-anchor" href="#form-表单数据存储到上层组件" aria-hidden="true">#</a> form 表单数据存储到上层组件</h2><p>fields</p><h2 id="warning-antd-upload-value-is-not-a-valid-prop-do-you-mean-filelist" tabindex="-1"><a class="header-anchor" href="#warning-antd-upload-value-is-not-a-valid-prop-do-you-mean-filelist" aria-hidden="true">#</a> Warning: [antd: Upload] <code>value</code> is not a valid prop, do you mean <code>fileList</code>?</h2><p>上传是比较特殊组件，放在 form 里，要特殊设置</p><p>需要同时使用?</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>valuePropName <span class="token operator">=</span> <span class="token string">&#39;fileList&#39;</span> <span class="token comment">// 指明特殊组件类型</span>
getValueFromEvent <span class="token operator">=</span> <span class="token punctuation">{</span> normFile <span class="token punctuation">}</span>
</code></pre></div><h2 id="unhandled-rejection-typeerror-object-is-not-a-function" tabindex="-1"><a class="header-anchor" href="#unhandled-rejection-typeerror-object-is-not-a-function" aria-hidden="true">#</a> Unhandled Rejection (TypeError): Object(...) is not a function</h2><p>function 没有导出</p><h2 id="使用-upload-组件上传图片提示-uncaught-error-must-set-key-for-rc-animate-children" tabindex="-1"><a class="header-anchor" href="#使用-upload-组件上传图片提示-uncaught-error-must-set-key-for-rc-animate-children" aria-hidden="true">#</a> 使用 upload 组件上传图片提示：Uncaught Error: must set key for &lt;rc-animate&gt; children</h2><p>没有设置 uid</p><h2 id="error-too-many-re-renders-react-limits-the-number-of-renders-to-prevent-an-infinite-loop" tabindex="-1"><a class="header-anchor" href="#error-too-many-re-renders-react-limits-the-number-of-renders-to-prevent-an-infinite-loop" aria-hidden="true">#</a> Error: Too many re-renders. React limits the number of renders to prevent an infinite loop.</h2><p><code>onClick={setSideIndex(index)}</code></p><h2 id="自定义表单控件" tabindex="-1"><a class="header-anchor" href="#自定义表单控件" aria-hidden="true">#</a> 自定义表单控件</h2><p>完全受控</p><div class="language-jsx ext-jsx"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Dragger</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span>uploadProps<span class="token punctuation">}</span></span> <span class="token attr-name">fileList</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onChange<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ant-upload-text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">拖入或点击添加工程文件</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Dragger</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="usemodel-是否会触发-redux-插件" tabindex="-1"><a class="header-anchor" href="#usemodel-是否会触发-redux-插件" aria-hidden="true">#</a> useModel 是否会触发 redux 插件</h2><h2 id="给定深层数据-id-tree-结构定位" tabindex="-1"><a class="header-anchor" href="#给定深层数据-id-tree-结构定位" aria-hidden="true">#</a> 给定深层数据 id，tree 结构定位</h2><p>转换 tree 为 dict，并添加 parentId 和 index</p><h2 id="antd-官方-dragger-丢失文件" tabindex="-1"><a class="header-anchor" href="#antd-官方-dragger-丢失文件" aria-hidden="true">#</a> antd 官方 dragger 丢失文件</h2><h2 id="useeffect-函数惰性-绑定函数记忆的可以是旧的依赖值" tabindex="-1"><a class="header-anchor" href="#useeffect-函数惰性-绑定函数记忆的可以是旧的依赖值" aria-hidden="true">#</a> useEffect 函数惰性，绑定函数记忆的可以是旧的依赖值</h2><ul><li>如果<code>useEffect</code>第一个函数参数直接或者间接用上某个变量，就请把这个变量放在<code>useEffect</code>的第二个参数里</li><li>使用<code>useEffect</code>，不要调用函数层次太多，代码应该一眼看清楚哪些函数会被<code>useEffect</code>调用。</li><li>只要是访问了<code>state</code>的函数，都应该用<code>useCallback</code>来保证 state 变化时生成一个新函数</li></ul><blockquote><p>明确或潜在依赖 state 的函数，都需要指明依赖，以便在 re-render 时重新生成正确依赖的函数</p></blockquote><h2 id="切换素材时-form-item-下发的-value-不更新-故改为手动传" tabindex="-1"><a class="header-anchor" href="#切换素材时-form-item-下发的-value-不更新-故改为手动传" aria-hidden="true">#</a> 切换素材时，Form.item 下发的 value 不更新，故改为手动传</h2><h2 id="react-props-默认值使用非基础类型-引起不必要更新" tabindex="-1"><a class="header-anchor" href="#react-props-默认值使用非基础类型-引起不必要更新" aria-hidden="true">#</a> react props 默认值使用非基础类型 引起不必要更新</h2><p>因此使用 ES 默认值时，如果是非基础属性，建议放一个常量在外面：</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token constant">EMPTY_ITEMS</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> items <span class="token operator">=</span> <span class="token constant">EMPTY_ITEMS</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Bar dataSource<span class="token operator">=</span><span class="token punctuation">{</span>items<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>https://www.zhihu.com/question/403260687/answer/1306841252</p><p><a href="https://gist.github.com/otakustay/9b59153da2e124f0637732fef5c71c6a" target="_blank" rel="noopener noreferrer">React hook to control table selection<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://zhuanlan.zhihu.com/p/55546844" target="_blank" rel="noopener noreferrer">React 模式（中文版） - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="failed-to-execute-clone-on-response-umi" tabindex="-1"><a class="header-anchor" href="#failed-to-execute-clone-on-response-umi" aria-hidden="true">#</a> Failed to execute &#39;clone&#39; on &#39;Response&#39; umi</h2><p>要读取 resonse 里内容， clone 一份再处理</p><h2 id="antd-layout" tabindex="-1"><a class="header-anchor" href="#antd-layout" aria-hidden="true">#</a> antd layout</h2><div class="language-text ext-text"><pre class="language-text"><code>layouts/SecurityLayout  是否登录
  component: &#39;../layouts/BasicLayout&#39;, 权限
  authority: [&#39;admin&#39;, &#39;user&#39;],
</code></pre></div><h2 id="menu" tabindex="-1"><a class="header-anchor" href="#menu" aria-hidden="true">#</a> menu</h2><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> menuList <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/design/personal&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;个人中心&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;personal&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token operator">&lt;</span>IconFont type<span class="token operator">=</span><span class="token string">&quot;icon-mine&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/design/audit&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;审核中心&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">&#39;audit&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token operator">&lt;</span>IconFont type<span class="token operator">=</span><span class="token string">&quot;icon-mine&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> <span class="token function-variable function">RenderMenuItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> path<span class="token punctuation">,</span> key<span class="token punctuation">,</span> icon <span class="token punctuation">}</span> <span class="token operator">=</span> data
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Menu<span class="token punctuation">.</span>Item key<span class="token operator">=</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span> icon<span class="token operator">=</span><span class="token punctuation">{</span>icon<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Menu<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token punctuation">{</span>
  menuList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>RenderMenuItem data<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="usemodel-持久化-浅拷贝数据里如果有对象-对象经修改-会保持" tabindex="-1"><a class="header-anchor" href="#usemodel-持久化-浅拷贝数据里如果有对象-对象经修改-会保持" aria-hidden="true">#</a> useModel 持久化，浅拷贝数据里如果有对象 对象经修改，会保持</h2><p>解决，深拷贝后，再修改</p><h2 id="异步权限" tabindex="-1"><a class="header-anchor" href="#异步权限" aria-hidden="true">#</a> 异步权限</h2><ol><li>request loading</li><li>setAuthority 更新 localStorage</li><li>reloadAuthority</li></ol><h2 id="关闭菜单国际化" tabindex="-1"><a class="header-anchor" href="#关闭菜单国际化" aria-hidden="true">#</a> 关闭菜单国际化</h2><p>defaultSettings</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>  <span class="token literal-property property">menu</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">locale</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="对象意外修改" tabindex="-1"><a class="header-anchor" href="#对象意外修改" aria-hidden="true">#</a> 对象意外修改</h2><p>pageNum 与需要响应更新列表数据的值分离</p><h2 id="总结自己使用过的-hooks-数据流方式-掘金" tabindex="-1"><a class="header-anchor" href="#总结自己使用过的-hooks-数据流方式-掘金" aria-hidden="true">#</a> <a href="https://juejin.im/post/5e9148f76fb9a03c8966daf8" target="_blank" rel="noopener noreferrer">总结自己使用过的 Hooks 数据流方式 - 掘金<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h2><p><a href="https://github.com/jamiebuilds/unstated-next" target="_blank" rel="noopener noreferrer">jamiebuilds/unstated-next: 200 bytes to never think about React state management libraries ever again<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="css-module-局部作用域" tabindex="-1"><a class="header-anchor" href="#css-module-局部作用域" aria-hidden="true">#</a> CSS module 局部作用域</h2><p>局部样式与覆盖 global</p><p>书写上与一般 CSS 无异</p><p>导入使用时有差异</p><p>global 即是用来声明传统的 class，方便混用。首先少写全局样式，其次使用时应该包裹起来</p><div class="language-less ext-less"><pre class="language-less"><code><span class="token selector">.override-ant-btn</span> <span class="token punctuation">{</span>
  <span class="token selector">:global(.ant-btn)</span> <span class="token punctuation">{</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://antd-course.ulivz.com/customized_styles.html#%25E5%25AE%259A%25E4%25B9%2589%25E6%25A0%25B7%25E5%25BC%258F" target="_blank" rel="noopener noreferrer">自定义样式 | Ant Design 实战教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="权限控制" tabindex="-1"><a class="header-anchor" href="#权限控制" aria-hidden="true">#</a> 权限控制</h2><p>对于权限控制，首先需要明白一点：“权限的真正控制都必须是在服务端负责的”。</p><h2 id="模块模式" tabindex="-1"><a class="header-anchor" href="#模块模式" aria-hidden="true">#</a> 模块模式</h2><p>定义工具函数时，可以把需要的私有变量包起来，不污染 utils 等文件</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token comment">// 除了 double 外界无法访问 a</span>
<span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">realFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> a
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="记忆-memo" tabindex="-1"><a class="header-anchor" href="#记忆-memo" aria-hidden="true">#</a> 记忆 memo</h2><ul><li>用数组或对象，将历史计算结果存储</li><li>实现方式，闭包。模式提炼</li></ul><h2 id="file-type-不可靠" tabindex="-1"><a class="header-anchor" href="#file-type-不可靠" aria-hidden="true">#</a> file.type 不可靠</h2><p>有的文件类型，如 psd、rar，<code>file.type</code>值是<code>&quot;&quot;</code> 直接拿<code>file.name</code>扩展名判断比较好</p><h2 id="动态样式" tabindex="-1"><a class="header-anchor" href="#动态样式" aria-hidden="true">#</a> 动态样式</h2><p>如<code>width</code>数值，用<code>style=</code>就可以</p><p><a href="https://github.com/ant-design/ant-design/issues/1418" target="_blank" rel="noopener noreferrer">RangePicker『此刻』建议配置成可选时间范围。 · Issue #1418 · ant-design/ant-design<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://www.cnblogs.com/liuyanxia/p/9099947.html" target="_blank" rel="noopener noreferrer">解决——CSS :before、:after ，当 content 使用中文时有时候会出现乱码 - SophiaLiu - 博客园<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="undefined-未赋值-null-值为空" tabindex="-1"><a class="header-anchor" href="#undefined-未赋值-null-值为空" aria-hidden="true">#</a> undefined 未赋值 null 值为空</h2><p><a href="https://github.com/ant-design/ant-design/issues/2367" target="_blank" rel="noopener noreferrer">Select 控件为什么会把 null 当做有 value 而不显示 placeholder ，必须要为 undefined 才可以？ · Issue #2367 · ant-design/ant-design<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="less-alpha" tabindex="-1"><a class="header-anchor" href="#less-alpha" aria-hidden="true">#</a> less alpha</h2><p>fade</p><h2 id="antd-日期选择-预设日期" tabindex="-1"><a class="header-anchor" href="#antd-日期选择-预设日期" aria-hidden="true">#</a> antd 日期选择 预设日期</h2><p><a href="https://bz0iy.csb.app/" target="_blank" rel="noopener noreferrer">Sandbox - CodeSandbox<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><ul><li>footer 反转</li><li>不需要标题栏、关闭<div class="language-text ext-text"><pre class="language-text"><code>ant-picker-panel-container
display: flex;
flex-direction: column-reverse;
</code></pre></div></li></ul><h2 id="特殊选中需求" tabindex="-1"><a class="header-anchor" href="#特殊选中需求" aria-hidden="true">#</a> 特殊选中需求</h2><div class="language-text ext-text"><pre class="language-text"><code>    .ant-menu-item:not(.ant-menu-item-selected) {
      a[href^=&#39;/design/audit&#39;] .anticon {
        color: #00BE7B;
      }
    }
</code></pre></div><h2 id="使用-传递对象-修改时-注意提前-clone-不要影响原对象" tabindex="-1"><a class="header-anchor" href="#使用-传递对象-修改时-注意提前-clone-不要影响原对象" aria-hidden="true">#</a> 使用 传递对象，修改时，注意提前 clone，不要影响原对象</h2><p>留意外部传入的 object，然后<code>.</code>语法访问，意外修改了引用</p><p>lodash cloneDeep</p><h2 id="审核自动切换" tabindex="-1"><a class="header-anchor" href="#审核自动切换" aria-hidden="true">#</a> 审核自动切换</h2><ul><li>移除项</li><li>不要后台拉取数据，会扰乱 index，使用 filter</li><li>filter 不会改变顺序</li><li>使用 filter，切换下一项，不需要移动 index，如果当前 index 无值，即到尾部</li></ul><h2 id="css-hover-不适用内容有间距场景" tabindex="-1"><a class="header-anchor" href="#css-hover-不适用内容有间距场景" aria-hidden="true">#</a> css hover 不适用内容有间距场景</h2><h2 id="antd-日期组件返回的时间是当时时间" tabindex="-1"><a class="header-anchor" href="#antd-日期组件返回的时间是当时时间" aria-hidden="true">#</a> antd 日期组件返回的时间是当时时间</h2><p>实际需求，应该是 start 0.00 end 23.59</p><h2 id="replace-designlayout-with-prolayout" tabindex="-1"><a class="header-anchor" href="#replace-designlayout-with-prolayout" aria-hidden="true">#</a> replace DesignLayout with ProLayout</h2><p>1ffb95756ab39c9538affd24c09d7cfe278127a3</p><h2 id="权限处理" tabindex="-1"><a class="header-anchor" href="#权限处理" aria-hidden="true">#</a> 权限处理</h2><div class="language-text ext-text"><pre class="language-text"><code>setUser(data)
Storage.setItem(&#39;user&#39;, data);
reloadAuthorized()
</code></pre></div><h2 id="ts-demo" tabindex="-1"><a class="header-anchor" href="#ts-demo" aria-hidden="true">#</a> ts demo</h2><div class="language-javascript ext-js"><pre class="language-javascript"><code>type SuperUlMode <span class="token operator">=</span> <span class="token string">&#39;horizontal&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;vertial&#39;</span><span class="token punctuation">;</span>
type SelctCallBackParams <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">index</span><span class="token operator">:</span> number <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> string <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
type <span class="token function-variable function">SelectCallBack</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>index<span class="token punctuation">,</span> name<span class="token punctuation">}</span><span class="token operator">:</span> SelctCallBackParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">SuperUlProps</span> <span class="token punctuation">{</span>
  defaultIndex<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">,</span>
  mode<span class="token operator">?</span><span class="token operator">:</span> SuperUlMode<span class="token punctuation">,</span>
  style<span class="token operator">?</span><span class="token operator">:</span> React<span class="token punctuation">.</span>CSSProperties<span class="token punctuation">,</span>
  onSelect<span class="token operator">?</span><span class="token operator">:</span> SelectCallBack
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">ISuperUlContext</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">index</span><span class="token operator">:</span> number<span class="token punctuation">,</span>
  onSelect<span class="token operator">?</span><span class="token operator">:</span> SelectCallBack<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>node_modules/antd/es/</p><h2 id="percent-事件频繁导致-多个组件过度-render" tabindex="-1"><a class="header-anchor" href="#percent-事件频繁导致-多个组件过度-render" aria-hidden="true">#</a> percent 事件频繁导致 多个组件过度 render</h2><p>分析： percent 事件 3-7 次/s emit 给父组件 fileList，变化导致所有依赖 fileList 的组件 render。但外部并不关心这个事件</p><p>解决： 内部维护一份 fileList，仅非 percent 事件时，向外 emit 变化</p><h2 id="跨代数据共享" tabindex="-1"><a class="header-anchor" href="#跨代数据共享" aria-hidden="true">#</a> 跨代数据共享</h2><ul><li>依赖反转、组件合成</li><li>动态数据传递，要格外注意显式声明依赖</li></ul><h2 id="我是如何无缝的扩展-antd-组件-知乎" tabindex="-1"><a class="header-anchor" href="#我是如何无缝的扩展-antd-组件-知乎" aria-hidden="true">#</a> <a href="https://zhuanlan.zhihu.com/p/111850451" target="_blank" rel="noopener noreferrer">我是如何无缝的扩展 antd 组件 - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h2><ul><li>扩展组件、但保持旧的引用</li><li>编辑器能识别吗</li></ul><h2 id="ant-design-repo" tabindex="-1"><a class="header-anchor" href="#ant-design-repo" aria-hidden="true">#</a> ant design repo</h2><p>install use node 8 start use node 14</p><h2 id="高阶组件" tabindex="-1"><a class="header-anchor" href="#高阶组件" aria-hidden="true">#</a> 高阶组件</h2><p><a href="https://gist.github.com/sebmarkbage/ef0bf1f338a7182b6775" target="_blank" rel="noopener noreferrer">Higher-order Components<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://medium.com/@dan_abramov/mixins-are-dead-long-live-higher-order-components-94a0d2f9e750#.eeu8q01s1" target="_blank" rel="noopener noreferrer">Mixins Are Dead. Long Live Composition | by Dan Abramov | Medium<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><p>A higher-order component is just a function that takes an existing component and returns another component that wraps it.</p></blockquote><h2 id="antd-强烈风格-不适合较大定制" tabindex="-1"><a class="header-anchor" href="#antd-强烈风格-不适合较大定制" aria-hidden="true">#</a> Antd 强烈风格，不适合较大定制</h2><p>推荐主色定制 <a href="https://github.com/ant-design/ant-design/issues/1241" target="_blank" rel="noopener noreferrer">有关主题设计的建议 · Issue #1241 · ant-design/ant-design<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 样式覆盖、非常麻烦</p><p>最常用的通用变量</p><p>读 <a href="https://ant.design/docs/react/faq-cn" target="_blank" rel="noopener noreferrer">FAQ - Ant Design<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="线上-设计素材浏览有个-bug-切换二级菜单时-列表数据某些场景会互相影响" tabindex="-1"><a class="header-anchor" href="#线上-设计素材浏览有个-bug-切换二级菜单时-列表数据某些场景会互相影响" aria-hidden="true">#</a> 线上 设计素材浏览有个 bug，切换二级菜单时，列表数据某些场景会互相影响</h2><p>bug 原因，</p><ol><li>URL 参数变化，组件仅 update，需要重置 state</li><li>菜单切换，会触发 infiniteLoading，超出最大页数判断有问题</li></ol><h2 id="图标替换" tabindex="-1"><a class="header-anchor" href="#图标替换" aria-hidden="true">#</a> 图标替换</h2><ol><li>需要 JS 操作</li><li>fork 图标库，单独维护 以 anticon-down 为例，搜索 down，替换 svg，build</li></ol><p>生成文件 node_modules/@ant-design/icons-svg/lib/asn/DownOutlined.js</p><p>ant-design-icons/packages/icons-svg/docs/ContributionGuide.zh-CN.md</p><h2 id="require-文件不存在" tabindex="-1"><a class="header-anchor" href="#require-文件不存在" aria-hidden="true">#</a> require 文件不存在</h2><p><a href="https://stackoverflow.com/questions/55213560/javascript-check-if-file-exists-if-not-then" target="_blank" rel="noopener noreferrer">reactjs - JavaScript Check if File exists, if not then - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ─</p><p>使用 import，报错 Unhandled Rejection (Error): Cannot find module &#39;./sketch.svg&#39; webpack:/src/assets/project lazy ^./.*.svg$ namespace object:45</p><h2 id="react-如何点击页面空白处关闭弹窗" tabindex="-1"><a class="header-anchor" href="#react-如何点击页面空白处关闭弹窗" aria-hidden="true">#</a> React 如何点击页面空白处关闭弹窗</h2><ol><li>给 body 绑定事件 关闭</li><li>给弹窗等元素绑定点击事件 <code>onClick={e =&gt; e.stopPropagation()}</code></li></ol><h2 id="umi-env-页面内不要解构-process-env" tabindex="-1"><a class="header-anchor" href="#umi-env-页面内不要解构-process-env" aria-hidden="true">#</a> umi env 页面内不要解构 p<wbr>rocess.env</h2><div class="language-text ext-text"><pre class="language-text"><code>const { NODE_ENV, SERVER_ENV } = p<wbr>rocess.env;

console.error(p<wbr>rocess.env.SERVER_ENV, SERVER_ENV) // test undefined
</code></pre></div><p>node config/config.ts 可以完整读取 p<wbr>rocess.env，而 global.tsx 明显是页面层面，读到的是 define 植入，不是真实的 object，不一定能解构出来。所以最好不要用解构语法。</p><h2 id="form-field-避免下标访问-不利于扩展" tabindex="-1"><a class="header-anchor" href="#form-field-避免下标访问-不利于扩展" aria-hidden="true">#</a> form field 避免下标访问，不利于扩展</h2><p>可以用 find name 方式</p><h2 id="公共组件样式" tabindex="-1"><a class="header-anchor" href="#公共组件样式" aria-hidden="true">#</a> 公共组件样式</h2><p>避免传值写死，不利于响应式</p><h2 id="husky" tabindex="-1"><a class="header-anchor" href="#husky" aria-hidden="true">#</a> husky</h2><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">npm</span> i -D husky lint-staged prettier
npx mrm lint-staged
</code></pre></div><p>antd 项目已默认配置</p><h2 id="antd-range-picker-blur-hide-如何实现" tabindex="-1"><a class="header-anchor" href="#antd-range-picker-blur-hide-如何实现" aria-hidden="true">#</a> antd range-picker blur hide 如何实现</h2><p>基于已有组件定制，可以单独使用</p><p>失焦如何同时支持 input 和 div</p><p>time-picker date-picker <a href="https://www.npmjs.com/package/rc-picker" target="_blank" rel="noopener noreferrer">rc-picker - npm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> rc-picker/src/RangePicker.tsx triggerInnerOpen rc-trigger/src/index.tsx class -hidden {trigger} onBlur input {portal} onMouseLeave div 必 delay onMouseEnter 先清除定时器</p><h2 id="stylelint-异常输出" tabindex="-1"><a class="header-anchor" href="#stylelint-异常输出" aria-hidden="true">#</a> stylelint 异常输出</h2><div class="language-text ext-text"><pre class="language-text"><code>单独运行 npm run stylelint 提示未安装
检查 node_modules/.bin 确实没装
可能是 eslint 全局安装，带来的问题？避免全局安装，因为不同项目依赖可能不一样，再加上 ts 等规则依赖，会很麻烦
npm install --no-save stylelint

npx stylelint --help
</code></pre></div><h2 id="umi-request-requesttype-生效条件" tabindex="-1"><a class="header-anchor" href="#umi-request-requesttype-生效条件" aria-hidden="true">#</a> umi-request requestType 生效条件</h2><p>&#39;requestType&#39; when the type of data is object or array.</p><h2 id="createportal-左右切换时-生成多余-div" tabindex="-1"><a class="header-anchor" href="#createportal-左右切换时-生成多余-div" aria-hidden="true">#</a> createPortal，左右切换时，生成多余 div</h2><p>避免创建新的 div？不行</p><p>只能是创建时，先把旧的删掉</p><h2 id="todo-material-lib" tabindex="-1"><a class="header-anchor" href="#todo-material-lib" aria-hidden="true">#</a> todo material-lib</h2><div class="language-text ext-text"><pre class="language-text"><code>.ant-menu-item:active, .ant-menu-submenu-title:active {
    /* background: aliceblue; */
}
</code></pre></div><h2 id="react-hooks-四-immutable-知乎" tabindex="-1"><a class="header-anchor" href="#react-hooks-四-immutable-知乎" aria-hidden="true">#</a> <a href="https://zhuanlan.zhihu.com/p/163590288" target="_blank" rel="noopener noreferrer">React Hooks(四): immutable - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></h2><p>更新有两个阶段：1. render: compute diff 2. commit diff to real dom</p><p>存在问题的是 1，执行计算开销 <a href="https://codesandbox.io/s/child-overload-render-p5p6t" target="_blank" rel="noopener noreferrer">child overload render - CodeSandbox<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>期望：</p><ul><li>值变化，引用变化</li><li>值不变，引用不变</li></ul><p>问题：</p><ul><li>机制：父组件重渲染会递归重渲染所有子组件，即使子组件依赖的 props 没有变化</li><li>性能：存在可避免的重渲染，有的子组件渲染开销很大</li><li>行为：无用的副作用重执行，无限循环</li><li>需要重请求保持数据最新场景，而重渲染开销大，返回数据每次创建新对象</li><li>parse 会创建新对象</li><li>对子组件来说，依赖的父组件应避免意外变化</li><li>引用相等，值发生了变化，UI 不更新</li><li>深拷贝问题，包含对象值不变，引用变了，</li></ul><p>结论：</p><ol><li><p>React.memo 包裹组件， 适用 prop 仅原始类型，复杂类型，可以指定比较函数，只适用函数组件</p><p><a href="https://dmitripavlutin.com/use-react-memo-wisely/" target="_blank" rel="noopener noreferrer">Use React.memo() wisely<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p>使用 immer</p><p><a href="https://zhuanlan.zhihu.com/p/34691516" target="_blank" rel="noopener noreferrer">精读《Immer.js》源码 - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p>record 和 tuple，JS 引入不可变数据结构 未来</p></li><li><p>useRef 适用于父组件内要定义包含常量的对象</p></li><li><p>避免在 render 中创建对象，或者使用 useMemo 只能是无副作用的高计算开销操作，指定依赖项，仅依赖更新时重新计算</p></li><li><p>hook state 要求不可变，深层嵌套如果配合 ES6，spread hell</p></li></ol><p>根源：对象的值比较和引用比较的不一致性 值比较计算开销大</p><p>很全的文章，不仅是介绍 record tuples <a href="https://dev.to/sebastienlorber/records-tuples-for-react-way-more-than-immutability-2iic" target="_blank" rel="noopener noreferrer">Records &amp; Tuples for React, way more than immutability<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>官方性能优化指南：</p><ul><li><p>把存在依赖项的函数，移到 useEffect 内</p></li><li><p>不需要考虑函数重复创建的开销，除非是确定开销比较大的函数</p></li><li><p>setState 传入函数更新 state，如果返回值不变，render 会跳过更新 搜<code>setRows</code></p><p><a href="https://codepen.io/cyio/pen/WNwpGJW?editors=1010" target="_blank" rel="noopener noreferrer">useState: lazy initial state<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><p><a href="https://reactjs.org/docs/hooks-faq.html#how-can-i-measure-a-dom-node" target="_blank" rel="noopener noreferrer">Hooks FAQ – React<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="caches-操作要求-https" tabindex="-1"><a class="header-anchor" href="#caches-操作要求-https" aria-hidden="true">#</a> caches 操作要求 https</h2><p>if (window.caches &amp;&amp; window.caches.keys) {</p><p>SecurityError: Failed to execute &#39;keys&#39; on &#39;CacheStorage&#39;: Only secure origins are allowed (see: https://goo.gl/Y0ZkNV).</p><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage" target="_blank" rel="noopener noreferrer">CacheStorage - Web APIs | MDN<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>安全源定义 <a href="https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features" target="_blank" rel="noopener noreferrer">Prefer Secure Origins For Powerful New Features - The Chromium Projects<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="请求优化-token-是否存在或在有效期内" tabindex="-1"><a class="header-anchor" href="#请求优化-token-是否存在或在有效期内" aria-hidden="true">#</a> 请求优化，token 是否存在或在有效期内</h2><p><a href="https://www.cnblogs.com/qkstart/p/11856168.html" target="_blank" rel="noopener noreferrer">React-umi-request 动态刷新 Token 功能实现及 node.js 代码逻辑 - qkstart - 博客园<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="static-proptypes" tabindex="-1"><a class="header-anchor" href="#static-proptypes" aria-hidden="true">#</a> static propTypes</h2><p>适用没有 typescript 时，老代码用得多 <a href="https://stackoverflow.com/questions/40514574/react-why-static-proptypes" target="_blank" rel="noopener noreferrer">reactjs - react: why static propTypes - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="何时单独用-xhr" tabindex="-1"><a class="header-anchor" href="#何时单独用-xhr" aria-hidden="true">#</a> 何时单独用 xhr</h2><p>跨域？不带 cookie？</p><h2 id="immerjs-优于使用-lodash-创建拷贝" tabindex="-1"><a class="header-anchor" href="#immerjs-优于使用-lodash-创建拷贝" aria-hidden="true">#</a> ImmerJS 优于使用 lodash 创建拷贝</h2><ul><li>无需遍历，借用 proxy，仅针对变化的对象属性进行深拷贝 <a href="https://dev.to/sebastienlorber/insight-3-use-immerjs-over-lodash-set-immutablejs-or-plain-js-36bl" target="_blank" rel="noopener noreferrer">Insight #3 - Use ImmerJS over lodash/set, ImmutableJS or plain JS - DEV<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://redux-toolkit.js.org/introduction/quick-start" target="_blank" rel="noopener noreferrer">官方类似 dva 解决方案 Quick Start | Redux Toolkit<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="竞速-race" tabindex="-1"><a class="header-anchor" href="#竞速-race" aria-hidden="true">#</a> 竞速 race</h2><ol><li>useRef 判断</li><li>取消请求</li><li>saga takeLatest</li><li>建议硬编码增加请求延时，更容易复现和发现问题 <a href="https://dev.to/sebastienlorber/handling-api-request-race-conditions-in-react-4j5b" target="_blank" rel="noopener noreferrer">Handling API request race conditions in React - DEV<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://github.com/slorber/react-async-hook" target="_blank" rel="noopener noreferrer">slorber/react-async-hook: React hook to handle any async operation in React components<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ol><p>makeCancelable 为 promise 添加伪取消功能 <a href="https://reactjs.org/blog/2015/12/16/ismounted-antipattern.html" target="_blank" rel="noopener noreferrer">isMounted is an Antipattern – React Blog<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="upload-drag-扩大区域" tabindex="-1"><a class="header-anchor" href="#upload-drag-扩大区域" aria-hidden="true">#</a> upload drag 扩大区域</h2><ul><li><code>:focue outline</code>浏览器原生样式，列表界面点击时出现 focus 样式并不合适</li><li>非文件也能 drag <a href="https://medium.com/@ralzohairi/how-to-drag-drop-html-elements-and-files-using-javascript-d31d15279369" target="_blank" rel="noopener noreferrer">How to Drag &amp; Drop HTML Elements and Files using Javascript | by Reema | Medium<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://codepen.io/tech_query/pen/MqGgap?editors=1000" target="_blank" rel="noopener noreferrer">DataTransfer test<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="定位代码最快方式" tabindex="-1"><a class="header-anchor" href="#定位代码最快方式" aria-hidden="true">#</a> 定位代码最快方式</h2><ol><li>react dev tools 组件名称</li><li>css 类</li></ol><p>数据流，从上到下传递，嵌套可能很深，找数据定义从上往下找</p><h2 id="开发阶段-eslint-影响初期效率" tabindex="-1"><a class="header-anchor" href="#开发阶段-eslint-影响初期效率" aria-hidden="true">#</a> 开发阶段 eslint 影响初期效率</h2><ul><li>开发新功能初期，可能有很多临时代码</li><li>可以对新文件，添加 eslint 忽略标记。后期再放开</li></ul><h2 id="临时禁用-lint" tabindex="-1"><a class="header-anchor" href="#临时禁用-lint" aria-hidden="true">#</a> 临时禁用 lint</h2><div class="language-text ext-text"><pre class="language-text"><code>// @ts-nocheck
/* eslint-disable */
</code></pre></div><h2 id="空数组约定" tabindex="-1"><a class="header-anchor" href="#空数组约定" aria-hidden="true">#</a> 空数组约定</h2><p>2.【强制】前后端数据列表相关的接口返回，如果为空，则返回空数组[]或空集合{}。说明：此条约定有利于数据层面上的协作更加高效，减少前端很多琐碎的 null 判断。</p><p>alibaba Java开发手册（嵩山版）.pdf</p><h2 id="map-key" tabindex="-1"><a class="header-anchor" href="#map-key" aria-hidden="true">#</a> map key</h2><p>要求：稳定，列表内惟一</p><p>稳定是说一个页面操作内，保持稳定</p><p>不指定 key 时，默认使用 index，index 存在不稳定</p><p>内容 hash 不行，不惟一</p><p>所以，只要提前生成一个惟一值就行。可以基于一个常量，累加生成 <code>key={genUniqKey()}</code></p><h2 id="hmr-fast-refresh" tabindex="-1"><a class="header-anchor" href="#hmr-fast-refresh" aria-hidden="true">#</a> HMR =&gt; Fast Refresh</h2><p><a href="https://medium.com/javascript-in-plain-english/what-is-react-fast-refresh-f3d1e8401333" target="_blank" rel="noopener noreferrer">What is React Fast Refresh?. This library is going to change your… | by Mallik Cheripally | JavaScript In Plain English | Medium<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>存在问题：</p><ul><li>有时变更后，刷新很慢</li><li>出现错误后，需要手动刷新</li></ul><h2 id="dan-note" tabindex="-1"><a class="header-anchor" href="#dan-note" aria-hidden="true">#</a> dan note</h2><p>react 中 props state 是不可变的（至少强烈建议如此）</p><p>避免闭包的原因是很难思考一个值可以随着时间被改变</p><p>Function components capture the rendered values.</p><p>函数组件保持了触发请求时的 prop。可变 this 模拟 ref.current 而 class 会由于在请求中，重渲染，this 变化，读取最新的 prop。React 会改变 this</p><p>In all cases I’ve seen so far, the “stale closures” problems happen due to a mistaken assumption that “functions don’t change” or that “props are always the same”. This is not the case, as I hope this post has helped to clarify.</p><p>实际是因为闭包？ <a href="https://overreacted.io/how-are-function-components-different-from-classes/" target="_blank" rel="noopener noreferrer">How Are Function Components Different from Classes? — Overreacted<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>Dan 介绍 hooks 提案，演示 class 与 hook 对比 context custom hook <a href="https://www.youtube.com/watch?v=dpw9EHDh2bM" target="_blank" rel="noopener noreferrer">React Today and Tomorrow and 90% Cleaner React With Hooks - YouTube<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="constructor-里发请求" tabindex="-1"><a class="header-anchor" href="#constructor-里发请求" aria-hidden="true">#</a> constructor 里发请求？</h2><ol><li>应该设置初始 state，给用户替代状态，如 loading</li><li>constructor 不能 async</li><li>componentWillMount 废弃，开发者可能漏掉设置初始 state，以为 render 会等待，实际请求中会执行一次</li><li>最佳实践，componentDidMount + isLoading，设置 isLoading 为 true 时，实际组件不会渲染</li></ol><p><a href="https://daveceddia.com/where-fetch-data-componentwillmount-vs-componentdidmount/" target="_blank" rel="noopener noreferrer">Where to Fetch Data: componentWillMount vs componentDidMount<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://stackoverflow.com/questions/55182526/fetching-data-in-constructor" target="_blank" rel="noopener noreferrer">javascript - Fetching data in constructor - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://zh-hans.reactjs.org/docs/faq-ajax.html" target="_blank" rel="noopener noreferrer">AJAX and APIs – React<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="自定义-tag" tabindex="-1"><a class="header-anchor" href="#自定义-tag" aria-hidden="true">#</a> 自定义 Tag</h2><p>字符模板 + 大写 + keyof</p><p><a href="https://stackoverflow.com/questions/33471880/dynamic-tag-name-in-jsx-and-react" target="_blank" rel="noopener noreferrer">reactjs - Dynamic tag name in jsx and React - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="jsx-map-join-reduce" tabindex="-1"><a class="header-anchor" href="#jsx-map-join-reduce" aria-hidden="true">#</a> jsx map join =&gt; reduce</h2><p><a href="https://stackoverflow.com/questions/34034038/how-to-render-react-components-by-using-map-and-join" target="_blank" rel="noopener noreferrer">reactjs - how to render react components by using map and join - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="pages-重复渲染-尤其-audio-有动画明显" tabindex="-1"><a class="header-anchor" href="#pages-重复渲染-尤其-audio-有动画明显" aria-hidden="true">#</a> pages 重复渲染，尤其 audio 有动画明显</h2><p>14 MediaPiece.tsx:7 mediapiece render</p><p>areEqual 从第二次渲染开始，意味着不能有卸载，父级哪层导致了卸载，拆出去的代码是否需要包括 map，需要，因为要检查数据入口，自上而下，分层控制</p><p>如果整个列表都卸载了，key 无意义</p><p>一层 map，使用 memo，仅修改项会 re-render</p><div class="language-text ext-text"><pre class="language-text"><code>key={genUniqKey()}
</code></pre></div><p>两层 map key item 写混，误以为 uniq key 生成有问题</p><p>lodash uniqueId 生成位数个位数时，容易冲突</p><p>检测父组件是否发生了卸载，也可以在 react dev tools 选中组件，如果组件卸载，选中会往父级跳</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;child unmounted&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>组件定义嵌套时，memo 失效？</p><p><a href="https://codesandbox.io/s/reactmemo-oi15s?file=/src/App.js" target="_blank" rel="noopener noreferrer">React.memo - CodeSandbox<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>总结：</p><ul><li>state 更新，组件并不会卸载，除非删除？</li><li>memo 不能写到组件内 React Top-Level API，这个 level 实指 top level scope，官方文档译的顶层、不好理解</li><li>memo 包裹的组件如果使用了 children props，会不 work</li><li>key 里不要直接写函数，否则界面更新会执行</li></ul><p>React 函数组件优化只做了两点：</p><ol><li>state 浅比较，相等则不重渲染。所以不比较 prop？</li><li>DOM 树只重渲染变化部分</li></ol><h2 id="effect-相关函数处理" tabindex="-1"><a class="header-anchor" href="#effect-相关函数处理" aria-hidden="true">#</a> effect 相关函数处理：</h2><p>是否要把函数放入 effect 依赖数组，尽量避免</p><ol><li>提升到组件外面</li><li>移到 effect 内</li><li>useCallback</li></ol><p><a href="https://overreacted.io/a-complete-guide-to-useeffect/" target="_blank" rel="noopener noreferrer">A Complete Guide to useEffect — Overreacted<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://zhuanlan.zhihu.com/p/93824106" target="_blank" rel="noopener noreferrer">深入浅出 useSWR 原理 - 知乎<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="modal-router" tabindex="-1"><a class="header-anchor" href="#modal-router" aria-hidden="true">#</a> modal router</h2><p>在 modal withRouter 不行， 传不到子组件</p><h2 id="鼠标进入触发-lottie" tabindex="-1"><a class="header-anchor" href="#鼠标进入触发-lottie" aria-hidden="true">#</a> 鼠标进入触发 lottie</h2><p>mouseHover 没有</p><p>mouseOver 不行</p><p>mouseEnter / mouseLeave</p><p>解决误触，debounse 不行，延迟但还是会执行，throttle 也不行，因为 enter 触发并不频繁</p><p>通用解决方案：为调用增加延时，当误触发生时取消延时，hover 够久时正常调用</p><p>子组件 render 问题，有外在表现组件容易显现出来，如动画、发请求，否则就要打 log 才能看出来</p><p>el 绑定，用自定义 id 即可。不需要实时 Dom，因此没必要用 ref</p><p>翻页集中 setState，否则可能多次渲染，原因是先设置了 index，然后又设置 data</p><h2 id="antd-table" tabindex="-1"><a class="header-anchor" href="#antd-table" aria-hidden="true">#</a> antd table</h2><ul><li>data 不需要 concat, 无限加载才需要</li><li>弹窗表格优化<div class="language-css ext-css"><pre class="language-css"><code>// 小屏
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-height</span><span class="token punctuation">:</span> 800px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.ant-modal</span> <span class="token punctuation">{</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token comment">// 固定高度内滚动</span>
scroll<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">y</span><span class="token operator">:</span> clientHeight <span class="token operator">-</span> <span class="token number">450</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div></li></ul><h2 id="state-派生自-prop-组件内又修改-state" tabindex="-1"><a class="header-anchor" href="#state-派生自-prop-组件内又修改-state" aria-hidden="true">#</a> state 派生自 prop，组件内又修改 state</h2><p>数据变更源成了两个，增加了数据意外变化定位难度</p><p>是否能通过通知父组件更新数据</p><h2 id="第二层弹窗问题" tabindex="-1"><a class="header-anchor" href="#第二层弹窗问题" aria-hidden="true">#</a> 第二层弹窗问题</h2><p>用了 absolute，需要计算容器高度</p><p>将一层内容 hide，并改将二层内容用 transfrom 移动到目标位置</p><h2 id="redux-dev-tool-crash" tabindex="-1"><a class="header-anchor" href="#redux-dev-tool-crash" aria-hidden="true">#</a> redux dev tool crash</h2><p><a href="https://github.com/reduxjs/redux-devtools/issues/643#issuecomment-697398278" target="_blank" rel="noopener noreferrer">&quot;redux-devtools-extension&quot; gets laggy and eventually crashes when I try to open it. · Issue #643 · reduxjs/redux-devtools<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="无效组件" tabindex="-1"><a class="header-anchor" href="#无效组件" aria-hidden="true">#</a> 无效组件</h2><p>不能是 object，有的没有 props.children</p><p>暂时用 组件 map</p><p>可以打印出来，检查是否正确</p><blockquote><p>Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object. #13445 元素类型，有两种，内置组件 string，合成组件 class/function</p></blockquote><p>组件不能是 el，需要是函数</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">const</span> CompanyIconInHeader <span class="token operator">=</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>y<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>

<span class="token comment">// wrong use</span>
<span class="token punctuation">;</span><span class="token operator">&lt;</span>CompanyIconInHeader <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">// right</span>
<span class="token keyword">const</span> <span class="token function-variable function">CompanyIconInHeader</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>y<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
</code></pre></div><h2 id="点击文本复制" tabindex="-1"><a class="header-anchor" href="#点击文本复制" aria-hidden="true">#</a> 点击文本复制</h2><p>react wrapper 引入问题</p><p>browser api 兼容性，需要请求权限</p><div class="language-text ext-text"><pre class="language-text"><code>import copy from &#39;copy-to-clipboard&#39;;
</code></pre></div><h2 id="半受控-props-变化-需要更新部分-state" tabindex="-1"><a class="header-anchor" href="#半受控-props-变化-需要更新部分-state" aria-hidden="true">#</a> 半受控，props 变化，需要更新部分 state</h2><p>硬重置（不推荐、但可救急）</p><div class="language-text ext-text"><pre class="language-text"><code>componentDidUpdate
  this.setState({ ..._.cloneDeep(defaultStates) }, () =&gt; {
</code></pre></div><p>v15 componentWillReceiveProps or componentDidUpdate + setState v16 getDerivedStateFromProps</p><p>反模式：受控与非受控混合</p><p>官方建议：</p><ol><li>完全受控，数据提升</li><li>完全不受控，用 key 控制更新</li></ol><h2 id="缓存计算" tabindex="-1"><a class="header-anchor" href="#缓存计算" aria-hidden="true">#</a> 缓存计算</h2><p>类 Vue computed，场景高开销计算，入参作为依赖，缓存最后一次计算值</p><p>memoize-one <a href="https://juejin.cn/post/6844903894061940750" target="_blank" rel="noopener noreferrer">memoize-one 在 React 中的应用<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>拓展：斐波那契数列</p><h2 id="ripple-btn" tabindex="-1"><a class="header-anchor" href="#ripple-btn" aria-hidden="true">#</a> ripple btn</h2><div class="language-text ext-text"><pre class="language-text"><code>demo a&gt;text
antd button&gt;span text
</code></pre></div><p>多个 span 标签，导致事件 target 会变，当 target 为 span 时，计算坐标有误</p><p>span antd 有设置 absolute</p><h2 id="跨组件引用可变对象" tabindex="-1"><a class="header-anchor" href="#跨组件引用可变对象" aria-hidden="true">#</a> 跨组件引用可变对象</h2><ul><li>多个修改源</li><li>深层数据变了，引用没变</li></ul><h2 id="webpack-cpu占用高" tabindex="-1"><a class="header-anchor" href="#webpack-cpu占用高" aria-hidden="true">#</a> webpack CPU占用高</h2><p>在 MacOS Catalina 中，Vue 项目在运行 node run dev 时，webpack server 会调用 fsevents 模块进行监控文件变化。如果没有这个模块，就会一直遍历所有的文件。</p><p>https://www.jianshu.com/p/f7769e01aa9c</p><h2 id="表格踩坑-最佳实践" tabindex="-1"><a class="header-anchor" href="#表格踩坑-最佳实践" aria-hidden="true">#</a> 表格踩坑，最佳实践</h2><p>查询参数和分页，应该用一个 state，合并更新 query</p><p>这么写，会有冲突，比如筛选重置同时回第一页</p><div class="language-javascript ext-js"><pre class="language-javascript"><code>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">fetchList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>curQuery<span class="token punctuation">,</span> pagination<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="url-hash-变化-如何更新页面" tabindex="-1"><a class="header-anchor" href="#url-hash-变化-如何更新页面" aria-hidden="true">#</a> URL hash 变化，如何更新页面</h2><p><a href="https://stackoverflow.com/questions/48139281/react-doesnt-reload-component-data-on-route-param-change-or-query-change" target="_blank" rel="noopener noreferrer">javascript - React doesn&#39;t reload component data on route param change or query change - Stack Overflow<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: gongyi01@baidu.com">gongyi01</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/frameworks/react-hooks.html" class="" aria-label="hooks"><!--[--><!--]--> hooks <!--[--><!--]--></a></span><span class="next"><a href="/frameworks/react-native.html" class="" aria-label="React Native"><!--[--><!--]--> React Native <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.de32dec6.js" defer></script>
  </body>
</html>
