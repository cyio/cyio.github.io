<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>react issues | Oaker小站</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
    <meta name="description" content="Just playing around">
    <meta name="theme-color" content="#0089a7">
    
    <link rel="preload" href="/assets/css/0.styles.1731dfdc.css" as="style"><link rel="preload" href="/assets/js/app.882ec4c8.js" as="script"><link rel="preload" href="/assets/js/2.06ded020.js" as="script"><link rel="preload" href="/assets/js/35.912d3cb8.js" as="script"><link rel="preload" href="/assets/js/4.8f3f44ca.js" as="script"><link rel="prefetch" href="/assets/js/10.27787c74.js"><link rel="prefetch" href="/assets/js/100.8a47af86.js"><link rel="prefetch" href="/assets/js/101.4681da11.js"><link rel="prefetch" href="/assets/js/102.ac77c076.js"><link rel="prefetch" href="/assets/js/103.f0a0b283.js"><link rel="prefetch" href="/assets/js/104.5d83daea.js"><link rel="prefetch" href="/assets/js/105.cbf5f1dd.js"><link rel="prefetch" href="/assets/js/106.a184039c.js"><link rel="prefetch" href="/assets/js/107.98e8203c.js"><link rel="prefetch" href="/assets/js/108.77c149e8.js"><link rel="prefetch" href="/assets/js/109.00073f1b.js"><link rel="prefetch" href="/assets/js/11.c8c5a832.js"><link rel="prefetch" href="/assets/js/110.d7ea04de.js"><link rel="prefetch" href="/assets/js/111.0d0fe945.js"><link rel="prefetch" href="/assets/js/112.623fa533.js"><link rel="prefetch" href="/assets/js/113.ed40ee4a.js"><link rel="prefetch" href="/assets/js/114.07e62dcb.js"><link rel="prefetch" href="/assets/js/115.f10ffcdb.js"><link rel="prefetch" href="/assets/js/116.4b7cefbf.js"><link rel="prefetch" href="/assets/js/117.c0a77168.js"><link rel="prefetch" href="/assets/js/118.32e6e4b1.js"><link rel="prefetch" href="/assets/js/119.48a51bbf.js"><link rel="prefetch" href="/assets/js/12.998e06bb.js"><link rel="prefetch" href="/assets/js/120.a9389ac7.js"><link rel="prefetch" href="/assets/js/121.baf15fe7.js"><link rel="prefetch" href="/assets/js/122.88ba01bb.js"><link rel="prefetch" href="/assets/js/123.b00c6e20.js"><link rel="prefetch" href="/assets/js/124.79caed37.js"><link rel="prefetch" href="/assets/js/125.dbd0c9b1.js"><link rel="prefetch" href="/assets/js/126.fdbc39af.js"><link rel="prefetch" href="/assets/js/127.947fb5cb.js"><link rel="prefetch" href="/assets/js/128.81bc4e65.js"><link rel="prefetch" href="/assets/js/129.67a2c399.js"><link rel="prefetch" href="/assets/js/13.6344f7c9.js"><link rel="prefetch" href="/assets/js/130.00859d03.js"><link rel="prefetch" href="/assets/js/131.729b9c51.js"><link rel="prefetch" href="/assets/js/132.1e23aa67.js"><link rel="prefetch" href="/assets/js/133.3acaf9e8.js"><link rel="prefetch" href="/assets/js/134.753aaef3.js"><link rel="prefetch" href="/assets/js/135.9cf0bdae.js"><link rel="prefetch" href="/assets/js/136.681928e8.js"><link rel="prefetch" href="/assets/js/137.957b3a94.js"><link rel="prefetch" href="/assets/js/138.62d56091.js"><link rel="prefetch" href="/assets/js/139.e4d1e1fa.js"><link rel="prefetch" href="/assets/js/14.da5d840d.js"><link rel="prefetch" href="/assets/js/140.f3f36cd7.js"><link rel="prefetch" href="/assets/js/141.c61a2165.js"><link rel="prefetch" href="/assets/js/142.0ee3ebd3.js"><link rel="prefetch" href="/assets/js/143.e1616dc1.js"><link rel="prefetch" href="/assets/js/144.7dfda19b.js"><link rel="prefetch" href="/assets/js/145.78271f36.js"><link rel="prefetch" href="/assets/js/146.7d8dd0dd.js"><link rel="prefetch" href="/assets/js/147.dfb7ab49.js"><link rel="prefetch" href="/assets/js/148.ca690413.js"><link rel="prefetch" href="/assets/js/149.d151da84.js"><link rel="prefetch" href="/assets/js/15.d200d07e.js"><link rel="prefetch" href="/assets/js/150.ca3f62c0.js"><link rel="prefetch" href="/assets/js/151.f13f9c7a.js"><link rel="prefetch" href="/assets/js/152.30799f6e.js"><link rel="prefetch" href="/assets/js/153.4e181cae.js"><link rel="prefetch" href="/assets/js/154.0978ea3d.js"><link rel="prefetch" href="/assets/js/155.65a04b92.js"><link rel="prefetch" href="/assets/js/156.be5a9967.js"><link rel="prefetch" href="/assets/js/157.3f636a59.js"><link rel="prefetch" href="/assets/js/158.835bbc61.js"><link rel="prefetch" href="/assets/js/159.6c51e191.js"><link rel="prefetch" href="/assets/js/16.b4b5e687.js"><link rel="prefetch" href="/assets/js/160.33027a1c.js"><link rel="prefetch" href="/assets/js/161.0494a05d.js"><link rel="prefetch" href="/assets/js/162.4ca1dd36.js"><link rel="prefetch" href="/assets/js/163.683c8517.js"><link rel="prefetch" href="/assets/js/164.8edc9cb3.js"><link rel="prefetch" href="/assets/js/165.f7415e8b.js"><link rel="prefetch" href="/assets/js/166.eeb6980a.js"><link rel="prefetch" href="/assets/js/167.67142f1c.js"><link rel="prefetch" href="/assets/js/168.56c69fe2.js"><link rel="prefetch" href="/assets/js/169.fcaef685.js"><link rel="prefetch" href="/assets/js/17.8be2291a.js"><link rel="prefetch" href="/assets/js/170.d09b4207.js"><link rel="prefetch" href="/assets/js/171.5576883c.js"><link rel="prefetch" href="/assets/js/172.aba8c98a.js"><link rel="prefetch" href="/assets/js/173.e8557437.js"><link rel="prefetch" href="/assets/js/174.96683de0.js"><link rel="prefetch" href="/assets/js/175.8f27a051.js"><link rel="prefetch" href="/assets/js/176.92282510.js"><link rel="prefetch" href="/assets/js/177.8c0b552f.js"><link rel="prefetch" href="/assets/js/178.681407de.js"><link rel="prefetch" href="/assets/js/179.8b7489bd.js"><link rel="prefetch" href="/assets/js/18.e7e58ae5.js"><link rel="prefetch" href="/assets/js/180.f25132a6.js"><link rel="prefetch" href="/assets/js/181.a830504c.js"><link rel="prefetch" href="/assets/js/182.27e31fea.js"><link rel="prefetch" href="/assets/js/183.1acaddec.js"><link rel="prefetch" href="/assets/js/184.2c746fa2.js"><link rel="prefetch" href="/assets/js/185.fbb843fe.js"><link rel="prefetch" href="/assets/js/186.df5594a2.js"><link rel="prefetch" href="/assets/js/187.46f5aed9.js"><link rel="prefetch" href="/assets/js/188.07213ee8.js"><link rel="prefetch" href="/assets/js/189.f56791f7.js"><link rel="prefetch" href="/assets/js/19.afc3285e.js"><link rel="prefetch" href="/assets/js/190.a290ce1c.js"><link rel="prefetch" href="/assets/js/191.c026414b.js"><link rel="prefetch" href="/assets/js/192.19323f31.js"><link rel="prefetch" href="/assets/js/193.7a86940d.js"><link rel="prefetch" href="/assets/js/194.d536a6a8.js"><link rel="prefetch" href="/assets/js/195.ef58aa65.js"><link rel="prefetch" href="/assets/js/196.c3468170.js"><link rel="prefetch" href="/assets/js/197.a633ca79.js"><link rel="prefetch" href="/assets/js/198.d8b53280.js"><link rel="prefetch" href="/assets/js/199.da29888f.js"><link rel="prefetch" href="/assets/js/20.bb369b55.js"><link rel="prefetch" href="/assets/js/200.1326ae27.js"><link rel="prefetch" href="/assets/js/201.43deaa73.js"><link rel="prefetch" href="/assets/js/202.ff12b952.js"><link rel="prefetch" href="/assets/js/203.e0569f48.js"><link rel="prefetch" href="/assets/js/204.b35a291b.js"><link rel="prefetch" href="/assets/js/205.3fd6a0d0.js"><link rel="prefetch" href="/assets/js/206.53ee9b24.js"><link rel="prefetch" href="/assets/js/207.1d138d51.js"><link rel="prefetch" href="/assets/js/208.3aeaf9bc.js"><link rel="prefetch" href="/assets/js/209.9149ccfd.js"><link rel="prefetch" href="/assets/js/21.c44697d8.js"><link rel="prefetch" href="/assets/js/210.ca45b403.js"><link rel="prefetch" href="/assets/js/211.3f781901.js"><link rel="prefetch" href="/assets/js/212.429901c1.js"><link rel="prefetch" href="/assets/js/213.0d53daf2.js"><link rel="prefetch" href="/assets/js/214.a3620849.js"><link rel="prefetch" href="/assets/js/215.d76d25cd.js"><link rel="prefetch" href="/assets/js/216.c26cf1b4.js"><link rel="prefetch" href="/assets/js/217.33d4a716.js"><link rel="prefetch" href="/assets/js/218.6496a6d3.js"><link rel="prefetch" href="/assets/js/219.1ff8e674.js"><link rel="prefetch" href="/assets/js/22.84f39a47.js"><link rel="prefetch" href="/assets/js/220.c522f28d.js"><link rel="prefetch" href="/assets/js/221.054aa195.js"><link rel="prefetch" href="/assets/js/222.d587cc78.js"><link rel="prefetch" href="/assets/js/223.b36af2b4.js"><link rel="prefetch" href="/assets/js/224.e9c98dd5.js"><link rel="prefetch" href="/assets/js/225.1faba09f.js"><link rel="prefetch" href="/assets/js/226.ab6eb935.js"><link rel="prefetch" href="/assets/js/227.0a51ebd1.js"><link rel="prefetch" href="/assets/js/228.e4b1353c.js"><link rel="prefetch" href="/assets/js/229.76398cd1.js"><link rel="prefetch" href="/assets/js/23.658a64ed.js"><link rel="prefetch" href="/assets/js/230.b4671600.js"><link rel="prefetch" href="/assets/js/231.4e7e51a6.js"><link rel="prefetch" href="/assets/js/232.f4ecc44f.js"><link rel="prefetch" href="/assets/js/233.c5f995d5.js"><link rel="prefetch" href="/assets/js/234.6dff30cf.js"><link rel="prefetch" href="/assets/js/235.178e5403.js"><link rel="prefetch" href="/assets/js/236.8b15bd98.js"><link rel="prefetch" href="/assets/js/237.e45896c2.js"><link rel="prefetch" href="/assets/js/238.a81c4dcb.js"><link rel="prefetch" href="/assets/js/239.8a53d817.js"><link rel="prefetch" href="/assets/js/24.46b7825a.js"><link rel="prefetch" href="/assets/js/240.6644e3a1.js"><link rel="prefetch" href="/assets/js/241.909d3c79.js"><link rel="prefetch" href="/assets/js/242.f4145859.js"><link rel="prefetch" href="/assets/js/243.fe838c8f.js"><link rel="prefetch" href="/assets/js/244.f361c93f.js"><link rel="prefetch" href="/assets/js/245.f69e217f.js"><link rel="prefetch" href="/assets/js/246.7da638c3.js"><link rel="prefetch" href="/assets/js/247.d58b7961.js"><link rel="prefetch" href="/assets/js/248.80dcff86.js"><link rel="prefetch" href="/assets/js/249.7584c244.js"><link rel="prefetch" href="/assets/js/25.4e0440c0.js"><link rel="prefetch" href="/assets/js/250.1ff330aa.js"><link rel="prefetch" href="/assets/js/251.af1ba65b.js"><link rel="prefetch" href="/assets/js/252.fbd26ad3.js"><link rel="prefetch" href="/assets/js/253.e4cbedc2.js"><link rel="prefetch" href="/assets/js/254.50043071.js"><link rel="prefetch" href="/assets/js/255.fb35d273.js"><link rel="prefetch" href="/assets/js/256.0e3b44c0.js"><link rel="prefetch" href="/assets/js/257.1733004a.js"><link rel="prefetch" href="/assets/js/258.76783d52.js"><link rel="prefetch" href="/assets/js/259.060491a2.js"><link rel="prefetch" href="/assets/js/26.2618398c.js"><link rel="prefetch" href="/assets/js/260.748e16a9.js"><link rel="prefetch" href="/assets/js/261.e764f69b.js"><link rel="prefetch" href="/assets/js/262.56adbdec.js"><link rel="prefetch" href="/assets/js/263.b92dea8a.js"><link rel="prefetch" href="/assets/js/264.664f9728.js"><link rel="prefetch" href="/assets/js/265.e86ca79f.js"><link rel="prefetch" href="/assets/js/266.ae8bdf1a.js"><link rel="prefetch" href="/assets/js/267.fdf3079e.js"><link rel="prefetch" href="/assets/js/268.9ad5a8b7.js"><link rel="prefetch" href="/assets/js/269.a1085f31.js"><link rel="prefetch" href="/assets/js/27.9cc3894d.js"><link rel="prefetch" href="/assets/js/270.680ecf5f.js"><link rel="prefetch" href="/assets/js/271.0871698c.js"><link rel="prefetch" href="/assets/js/272.fb2c0155.js"><link rel="prefetch" href="/assets/js/273.fbd868dd.js"><link rel="prefetch" href="/assets/js/274.d6469995.js"><link rel="prefetch" href="/assets/js/275.4ef7bc08.js"><link rel="prefetch" href="/assets/js/276.9ee3e762.js"><link rel="prefetch" href="/assets/js/277.78bdb632.js"><link rel="prefetch" href="/assets/js/278.5aad5cdc.js"><link rel="prefetch" href="/assets/js/279.b19703a5.js"><link rel="prefetch" href="/assets/js/28.90f4973e.js"><link rel="prefetch" href="/assets/js/280.5cabb2b4.js"><link rel="prefetch" href="/assets/js/281.9b0dd165.js"><link rel="prefetch" href="/assets/js/282.cc657547.js"><link rel="prefetch" href="/assets/js/283.7aaa0e1a.js"><link rel="prefetch" href="/assets/js/284.3ab57b30.js"><link rel="prefetch" href="/assets/js/285.0128cce0.js"><link rel="prefetch" href="/assets/js/286.a79658da.js"><link rel="prefetch" href="/assets/js/287.3f855ec9.js"><link rel="prefetch" href="/assets/js/288.7cf32083.js"><link rel="prefetch" href="/assets/js/289.9b213420.js"><link rel="prefetch" href="/assets/js/29.bc2d5c22.js"><link rel="prefetch" href="/assets/js/290.2bf5a0e1.js"><link rel="prefetch" href="/assets/js/291.0493afbc.js"><link rel="prefetch" href="/assets/js/292.6f23b704.js"><link rel="prefetch" href="/assets/js/293.fc7c7d88.js"><link rel="prefetch" href="/assets/js/294.3dd82919.js"><link rel="prefetch" href="/assets/js/295.3d602671.js"><link rel="prefetch" href="/assets/js/296.23a3f903.js"><link rel="prefetch" href="/assets/js/297.83c6985e.js"><link rel="prefetch" href="/assets/js/298.f60ea767.js"><link rel="prefetch" href="/assets/js/299.cf6e9f1a.js"><link rel="prefetch" href="/assets/js/3.838ce51e.js"><link rel="prefetch" href="/assets/js/30.1c9d726d.js"><link rel="prefetch" href="/assets/js/300.9231363e.js"><link rel="prefetch" href="/assets/js/301.6fd3a216.js"><link rel="prefetch" href="/assets/js/302.e67c5c00.js"><link rel="prefetch" href="/assets/js/303.31b9241a.js"><link rel="prefetch" href="/assets/js/304.78008ece.js"><link rel="prefetch" href="/assets/js/305.3d09f20e.js"><link rel="prefetch" href="/assets/js/306.4ef6d303.js"><link rel="prefetch" href="/assets/js/307.258f0eb7.js"><link rel="prefetch" href="/assets/js/308.096fbd3f.js"><link rel="prefetch" href="/assets/js/309.ba5d67d1.js"><link rel="prefetch" href="/assets/js/31.68a9fef2.js"><link rel="prefetch" href="/assets/js/310.7ec2d6f1.js"><link rel="prefetch" href="/assets/js/311.44cf988a.js"><link rel="prefetch" href="/assets/js/312.2ec581a5.js"><link rel="prefetch" href="/assets/js/313.06a8d4d7.js"><link rel="prefetch" href="/assets/js/314.f32bc8ff.js"><link rel="prefetch" href="/assets/js/315.f6cf42ee.js"><link rel="prefetch" href="/assets/js/316.f3010cf3.js"><link rel="prefetch" href="/assets/js/317.be6a50b7.js"><link rel="prefetch" href="/assets/js/318.b05f7100.js"><link rel="prefetch" href="/assets/js/319.406244dd.js"><link rel="prefetch" href="/assets/js/32.342e047c.js"><link rel="prefetch" href="/assets/js/320.1c9b88c7.js"><link rel="prefetch" href="/assets/js/321.da1ee801.js"><link rel="prefetch" href="/assets/js/322.41732864.js"><link rel="prefetch" href="/assets/js/323.6858ae4b.js"><link rel="prefetch" href="/assets/js/324.9bfdeb52.js"><link rel="prefetch" href="/assets/js/325.afab2567.js"><link rel="prefetch" href="/assets/js/326.1fd9c89b.js"><link rel="prefetch" href="/assets/js/327.b78ccbcf.js"><link rel="prefetch" href="/assets/js/328.4b47994c.js"><link rel="prefetch" href="/assets/js/329.90c47493.js"><link rel="prefetch" href="/assets/js/33.87d95964.js"><link rel="prefetch" href="/assets/js/330.2e9cf594.js"><link rel="prefetch" href="/assets/js/331.e83b125e.js"><link rel="prefetch" href="/assets/js/332.f5186780.js"><link rel="prefetch" href="/assets/js/333.b2482d49.js"><link rel="prefetch" href="/assets/js/334.10cd3258.js"><link rel="prefetch" href="/assets/js/335.495fce25.js"><link rel="prefetch" href="/assets/js/336.90efb212.js"><link rel="prefetch" href="/assets/js/337.06b1d57a.js"><link rel="prefetch" href="/assets/js/338.28f6436f.js"><link rel="prefetch" href="/assets/js/339.fdc78a01.js"><link rel="prefetch" href="/assets/js/34.6e4a9b29.js"><link rel="prefetch" href="/assets/js/340.710443c6.js"><link rel="prefetch" href="/assets/js/341.6cacfa8a.js"><link rel="prefetch" href="/assets/js/342.593f027a.js"><link rel="prefetch" href="/assets/js/343.6fe0f407.js"><link rel="prefetch" href="/assets/js/344.733d8a0d.js"><link rel="prefetch" href="/assets/js/345.7e6c0b90.js"><link rel="prefetch" href="/assets/js/346.495ba4f5.js"><link rel="prefetch" href="/assets/js/347.29076385.js"><link rel="prefetch" href="/assets/js/348.c735aa00.js"><link rel="prefetch" href="/assets/js/349.91a17ea1.js"><link rel="prefetch" href="/assets/js/350.ce149269.js"><link rel="prefetch" href="/assets/js/351.fd0854fa.js"><link rel="prefetch" href="/assets/js/352.2f0a38ae.js"><link rel="prefetch" href="/assets/js/353.63e2239c.js"><link rel="prefetch" href="/assets/js/354.5c86e511.js"><link rel="prefetch" href="/assets/js/355.d907a15e.js"><link rel="prefetch" href="/assets/js/356.15fb5d33.js"><link rel="prefetch" href="/assets/js/357.bf0a3247.js"><link rel="prefetch" href="/assets/js/358.e3acb67f.js"><link rel="prefetch" href="/assets/js/359.21e4a594.js"><link rel="prefetch" href="/assets/js/36.2b9acf66.js"><link rel="prefetch" href="/assets/js/360.b16a1a5f.js"><link rel="prefetch" href="/assets/js/361.af52c2b3.js"><link rel="prefetch" href="/assets/js/362.5a73f760.js"><link rel="prefetch" href="/assets/js/363.018498d1.js"><link rel="prefetch" href="/assets/js/364.605777e9.js"><link rel="prefetch" href="/assets/js/365.1c2ebeb9.js"><link rel="prefetch" href="/assets/js/366.5ec31afc.js"><link rel="prefetch" href="/assets/js/367.5da50e98.js"><link rel="prefetch" href="/assets/js/368.7c2b4b8e.js"><link rel="prefetch" href="/assets/js/37.9acb4313.js"><link rel="prefetch" href="/assets/js/38.c83f5b7c.js"><link rel="prefetch" href="/assets/js/39.ecce18b9.js"><link rel="prefetch" href="/assets/js/40.622e5cd6.js"><link rel="prefetch" href="/assets/js/41.becae5b6.js"><link rel="prefetch" href="/assets/js/42.ed8b74c5.js"><link rel="prefetch" href="/assets/js/43.45f0122c.js"><link rel="prefetch" href="/assets/js/44.d345baa3.js"><link rel="prefetch" href="/assets/js/45.0ed7e12b.js"><link rel="prefetch" href="/assets/js/46.b19ffb2a.js"><link rel="prefetch" href="/assets/js/47.db0bbf25.js"><link rel="prefetch" href="/assets/js/48.586f8607.js"><link rel="prefetch" href="/assets/js/49.b06c2bad.js"><link rel="prefetch" href="/assets/js/5.8ceb5d72.js"><link rel="prefetch" href="/assets/js/50.8f427c40.js"><link rel="prefetch" href="/assets/js/51.e9785688.js"><link rel="prefetch" href="/assets/js/52.cc5d82e0.js"><link rel="prefetch" href="/assets/js/53.888afa7e.js"><link rel="prefetch" href="/assets/js/54.e063e7b2.js"><link rel="prefetch" href="/assets/js/55.14189faf.js"><link rel="prefetch" href="/assets/js/56.bcec766f.js"><link rel="prefetch" href="/assets/js/57.5ed28b8f.js"><link rel="prefetch" href="/assets/js/58.d56b4cf2.js"><link rel="prefetch" href="/assets/js/59.21b81a09.js"><link rel="prefetch" href="/assets/js/6.aa91e071.js"><link rel="prefetch" href="/assets/js/60.c5840694.js"><link rel="prefetch" href="/assets/js/61.5934d575.js"><link rel="prefetch" href="/assets/js/62.b1326c46.js"><link rel="prefetch" href="/assets/js/63.6ae49ca0.js"><link rel="prefetch" href="/assets/js/64.6fb113f4.js"><link rel="prefetch" href="/assets/js/65.522bd36f.js"><link rel="prefetch" href="/assets/js/66.c874c253.js"><link rel="prefetch" href="/assets/js/67.0f5a16af.js"><link rel="prefetch" href="/assets/js/68.8f5c9053.js"><link rel="prefetch" href="/assets/js/69.845fb837.js"><link rel="prefetch" href="/assets/js/7.bb9dbdfe.js"><link rel="prefetch" href="/assets/js/70.63eb11ce.js"><link rel="prefetch" href="/assets/js/71.bbb0da5f.js"><link rel="prefetch" href="/assets/js/72.1dac051c.js"><link rel="prefetch" href="/assets/js/73.9692d04a.js"><link rel="prefetch" href="/assets/js/74.3f756a7e.js"><link rel="prefetch" href="/assets/js/75.01fb6d07.js"><link rel="prefetch" href="/assets/js/76.67cafada.js"><link rel="prefetch" href="/assets/js/77.a8fad9e7.js"><link rel="prefetch" href="/assets/js/78.f96d9f76.js"><link rel="prefetch" href="/assets/js/79.10250b3a.js"><link rel="prefetch" href="/assets/js/8.d5bbd7c3.js"><link rel="prefetch" href="/assets/js/80.c366bd76.js"><link rel="prefetch" href="/assets/js/81.ee3738d6.js"><link rel="prefetch" href="/assets/js/82.aa7e8493.js"><link rel="prefetch" href="/assets/js/83.d2e17ca0.js"><link rel="prefetch" href="/assets/js/84.50237b19.js"><link rel="prefetch" href="/assets/js/85.46813862.js"><link rel="prefetch" href="/assets/js/86.022b5663.js"><link rel="prefetch" href="/assets/js/87.43e60437.js"><link rel="prefetch" href="/assets/js/88.230b6234.js"><link rel="prefetch" href="/assets/js/89.36683d7e.js"><link rel="prefetch" href="/assets/js/9.224fc60e.js"><link rel="prefetch" href="/assets/js/90.36e78cdf.js"><link rel="prefetch" href="/assets/js/91.cf9ba514.js"><link rel="prefetch" href="/assets/js/92.e4f478ed.js"><link rel="prefetch" href="/assets/js/93.8927ca98.js"><link rel="prefetch" href="/assets/js/94.66102b27.js"><link rel="prefetch" href="/assets/js/95.8d3526c6.js"><link rel="prefetch" href="/assets/js/96.f584195c.js"><link rel="prefetch" href="/assets/js/97.6bad8979.js"><link rel="prefetch" href="/assets/js/98.da5fa702.js"><link rel="prefetch" href="/assets/js/99.ef8a92c3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1731dfdc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Oaker小站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/javascript/concept.html" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/web/html.html" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/frameworks/vue.html" class="nav-link">
  框架
</a></div><div class="nav-item"><a href="/node/concept.html" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/tools/markdown.html" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="https://github.com/cyio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="/javascript/concept.html" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/web/html.html" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/frameworks/vue.html" class="nav-link">
  框架
</a></div><div class="nav-item"><a href="/node/concept.html" class="nav-link">
  Node
</a></div><div class="nav-item"><a href="/tools/markdown.html" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="https://github.com/cyio" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>frameworks</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frameworks/ajax-http-request-libray.html" class="sidebar-link">ajax/http 请求库、工具</a></li><li><a href="/frameworks/bootstrap.html" class="sidebar-link">Bootstrap</a></li><li><a href="/frameworks/cropperjs.html" class="sidebar-link">cropperjs</a></li><li><a href="/frameworks/date-fns.html" class="sidebar-link">date-fns</a></li><li><a href="/frameworks/element-ui.html" class="sidebar-link">element-ui</a></li><li><a href="/frameworks/mobx.html" class="sidebar-link">Mobx</a></li><li><a href="/frameworks/next.html" class="sidebar-link">Next</a></li><li><a href="/frameworks/react-issues.html" aria-current="page" class="active sidebar-link">react issues</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#页面结构" class="sidebar-link">页面结构</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#注意" class="sidebar-link">注意</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#page-bare-template" class="sidebar-link">page bare template</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#typescript" class="sidebar-link">TypeScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#json-快速生成-ts" class="sidebar-link">JSON 快速生成 TS</a></li></ul></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#影响效率因素" class="sidebar-link">影响效率因素</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#新建页面" class="sidebar-link">新建页面</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#表格实现" class="sidebar-link">表格实现</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#路径-routes" class="sidebar-link">路径 routes</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#connect" class="sidebar-link">connect</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#解构对象内容" class="sidebar-link">解构对象内容</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#checkbox-group" class="sidebar-link">checkbox.group</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#classnames" class="sidebar-link">classNames</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#umi-requesttype-默认是-json-可选-form" class="sidebar-link">umi requestType 默认是 json，可选 form</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#iconfont-cn-use-in-antd" class="sidebar-link">iconfont.cn use in antd</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#hover-exclude" class="sidebar-link">hover exclude</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#useeffect-反复执行" class="sidebar-link">useEffect 反复执行</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#数据联动" class="sidebar-link">数据联动</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-form-onfinished" class="sidebar-link">antd form onFinished</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#hook-state-拆分合并原则" class="sidebar-link">hook state 拆分合并原则</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#可以在函数内直接申明普通常量或普通函数吗" class="sidebar-link">可以在函数内直接申明普通常量或普通函数吗？</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#useeffect-不要用-async-use-usecallback-instead" class="sidebar-link">useEffect 不要用 async, use useCallback instead</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#list-virtualized" class="sidebar-link">list virtualized</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#生命周期模拟-useeffect" class="sidebar-link">生命周期模拟 useEffect</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#calc-px-计算" class="sidebar-link">calc px 计算</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#播放器能支持哪些文件类型" class="sidebar-link">播放器能支持哪些文件类型</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#使用多个-usestate-或-usereducer" class="sidebar-link">使用多个 useState 或 useReducer</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#复杂-state-逻辑建议用-react-自带-usereducer" class="sidebar-link">复杂 state 逻辑建议用 React 自带 useReducer</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#自定义-hook" class="sidebar-link">自定义 hook</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#rangepicker-没有样式" class="sidebar-link">RangePicker 没有样式</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#dva-使用" class="sidebar-link">dva 使用</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-权限组件" class="sidebar-link">antd 权限组件</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#hook-dva-snip" class="sidebar-link">hook dva snip</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#umi-ui" class="sidebar-link">umi ui</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#自定义左侧菜单-icon" class="sidebar-link">自定义左侧菜单 icon</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#动态-menu" class="sidebar-link">动态 menu</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#参数路由" class="sidebar-link">参数路由</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#layouts" class="sidebar-link">layouts</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#视图无关的数据" class="sidebar-link">视图无关的数据</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#re-render" class="sidebar-link">re-render</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#why-mapstate-mapdispatch" class="sidebar-link">why mapState mapDispatch</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#容器组件模式" class="sidebar-link">容器组件模式</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#umi-简化数据流方案" class="sidebar-link">umi 简化数据流方案</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#class-组件不能用-hooks" class="sidebar-link">class 组件不能用 hooks</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#form-表单数据存储到上层组件" class="sidebar-link">form 表单数据存储到上层组件</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#warning-antd-upload-value-is-not-a-valid-prop-do-you-mean-filelist" class="sidebar-link">Warning: [antd: Upload] value is not a valid prop, do you mean fileList?</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#unhandled-rejection-typeerror-object-is-not-a-function" class="sidebar-link">Unhandled Rejection (TypeError): Object(...) is not a function</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#使用-upload-组件上传图片提示-uncaught-error-must-set-key-for-children" class="sidebar-link">使用 upload 组件上传图片提示：Uncaught Error: must set key for  children</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#error-too-many-re-renders-react-limits-the-number-of-renders-to-prevent-an-infinite-loop" class="sidebar-link">Error: Too many re-renders. React limits the number of renders to prevent an infinite loop.</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#自定义表单控件" class="sidebar-link">自定义表单控件</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#usemodel-是否会触发-redux-插件" class="sidebar-link">useModel 是否会触发 redux 插件</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#给定深层数据-id-tree-结构定位" class="sidebar-link">给定深层数据 id，tree 结构定位</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-官方-dragger-丢失文件" class="sidebar-link">antd 官方 dragger 丢失文件</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#useeffect-函数惰性-绑定函数记忆的可以是旧的依赖值" class="sidebar-link">useEffect 函数惰性，绑定函数记忆的可以是旧的依赖值</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#切换素材时-form-item-下发的-value-不更新-故改为手动传" class="sidebar-link">切换素材时，Form.item 下发的 value 不更新，故改为手动传</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#react-props-默认值使用非基础类型-引起不必要更新" class="sidebar-link">react props 默认值使用非基础类型 引起不必要更新</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#failed-to-execute-clone-on-response-umi" class="sidebar-link">Failed to execute 'clone' on 'Response' umi</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-layout" class="sidebar-link">antd layout</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#menu" class="sidebar-link">menu</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#usemodel-持久化-浅拷贝数据里如果有对象-对象经修改-会保持" class="sidebar-link">useModel 持久化，浅拷贝数据里如果有对象 对象经修改，会保持</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#异步权限" class="sidebar-link">异步权限</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#关闭菜单国际化" class="sidebar-link">关闭菜单国际化</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#对象意外修改" class="sidebar-link">对象意外修改</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#总结自己使用过的-hooks-数据流方式-掘金" class="sidebar-link">总结自己使用过的 Hooks 数据流方式 - 掘金</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#css-module-局部作用域" class="sidebar-link">CSS module 局部作用域</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#权限控制" class="sidebar-link">权限控制</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#模块模式" class="sidebar-link">模块模式</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#记忆-memo" class="sidebar-link">记忆 memo</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#file-type-不可靠" class="sidebar-link">file.type 不可靠</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#动态样式" class="sidebar-link">动态样式</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#undefined-未赋值-null-值为空" class="sidebar-link">undefined 未赋值 null 值为空</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#less-alpha" class="sidebar-link">less alpha</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-日期选择-预设日期" class="sidebar-link">antd 日期选择 预设日期</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#特殊选中需求" class="sidebar-link">特殊选中需求</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#使用-传递对象-修改时-注意提前-clone-不要影响原对象" class="sidebar-link">使用 传递对象，修改时，注意提前 clone，不要影响原对象</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#审核自动切换" class="sidebar-link">审核自动切换</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#css-hover-不适用内容有间距场景" class="sidebar-link">css hover 不适用内容有间距场景</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-日期组件返回的时间是当时时间" class="sidebar-link">antd 日期组件返回的时间是当时时间</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#replace-designlayout-with-prolayout" class="sidebar-link">replace DesignLayout with ProLayout</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#权限处理" class="sidebar-link">权限处理</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#ts-demo" class="sidebar-link">ts demo</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#percent-事件频繁导致-多个组件过度-render" class="sidebar-link">percent 事件频繁导致 多个组件过度 render</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#跨代数据共享" class="sidebar-link">跨代数据共享</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#我是如何无缝的扩展-antd-组件-知乎" class="sidebar-link">我是如何无缝的扩展 antd 组件 - 知乎</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#ant-design-repo" class="sidebar-link">ant design repo</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#高阶组件" class="sidebar-link">高阶组件</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-强烈风格-不适合较大定制" class="sidebar-link">Antd 强烈风格，不适合较大定制</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#线上-设计素材浏览有个-bug-切换二级菜单时-列表数据某些场景会互相影响" class="sidebar-link">线上 设计素材浏览有个 bug，切换二级菜单时，列表数据某些场景会互相影响</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#图标替换" class="sidebar-link">图标替换</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#require-文件不存在" class="sidebar-link">require 文件不存在</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#react-如何点击页面空白处关闭弹窗" class="sidebar-link">React 如何点击页面空白处关闭弹窗</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#umi-env-页面内不要解构-process-env" class="sidebar-link">umi env 页面内不要解构 process.env</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#form-field-避免下标访问-不利于扩展" class="sidebar-link">form field 避免下标访问，不利于扩展</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#公共组件样式" class="sidebar-link">公共组件样式</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#husky" class="sidebar-link">husky</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-range-picker-blur-hide-如何实现" class="sidebar-link">antd range-picker blur hide 如何实现</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#stylelint-异常输出" class="sidebar-link">stylelint 异常输出</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#umi-request-requesttype-生效条件" class="sidebar-link">umi-request requestType 生效条件</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#createportal-左右切换时-生成多余-div" class="sidebar-link">createPortal，左右切换时，生成多余 div</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#todo-material-lib" class="sidebar-link">todo material-lib</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#react-hooks-四-immutable-知乎" class="sidebar-link">React Hooks(四): immutable - 知乎</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#caches-操作要求-https" class="sidebar-link">caches 操作要求 https</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#请求优化-token-是否存在或在有效期内" class="sidebar-link">请求优化，token 是否存在或在有效期内</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#static-proptypes" class="sidebar-link">static propTypes</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#何时单独用-xhr" class="sidebar-link">何时单独用 xhr</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#immerjs-优于使用-lodash-创建拷贝" class="sidebar-link">ImmerJS 优于使用 lodash 创建拷贝</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#竞速-race" class="sidebar-link">竞速 race</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#upload-drag-扩大区域" class="sidebar-link">upload drag 扩大区域</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#定位代码最快方式" class="sidebar-link">定位代码最快方式</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#开发阶段-eslint-影响初期效率" class="sidebar-link">开发阶段 eslint 影响初期效率</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#临时禁用-lint" class="sidebar-link">临时禁用 lint</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#空数组约定" class="sidebar-link">空数组约定</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#map-key" class="sidebar-link">map key</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#hmr-fast-refresh" class="sidebar-link">HMR =&gt; Fast Refresh</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#dan-note" class="sidebar-link">dan note</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#constructor-里发请求" class="sidebar-link">constructor 里发请求？</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#自定义-tag" class="sidebar-link">自定义 Tag</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#jsx-map-join-reduce" class="sidebar-link">jsx map join =&gt; reduce</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#pages-重复渲染-尤其-audio-有动画明显" class="sidebar-link">pages 重复渲染，尤其 audio 有动画明显</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#effect-相关函数处理" class="sidebar-link">effect 相关函数处理：</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#modal-router" class="sidebar-link">modal router</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#鼠标进入触发-lottie" class="sidebar-link">鼠标进入触发 lottie</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#antd-table" class="sidebar-link">antd table</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#state-派生自-prop-组件内又修改-state" class="sidebar-link">state 派生自 prop，组件内又修改 state</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#第二层弹窗问题" class="sidebar-link">第二层弹窗问题</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#redux-dev-tool-crash" class="sidebar-link">redux dev tool crash</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#无效组件" class="sidebar-link">无效组件</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#点击文本复制" class="sidebar-link">点击文本复制</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#半受控-props-变化-需要更新部分-state" class="sidebar-link">半受控，props 变化，需要更新部分 state</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#缓存计算" class="sidebar-link">缓存计算</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#ripple-btn" class="sidebar-link">ripple btn</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#跨组件引用可变对象" class="sidebar-link">跨组件引用可变对象</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#webpack-cpu占用高" class="sidebar-link">webpack CPU占用高</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#表格踩坑-最佳实践" class="sidebar-link">表格踩坑，最佳实践</a></li><li class="sidebar-sub-header"><a href="/frameworks/react-issues.html#url-hash-变化-如何更新页面" class="sidebar-link">URL hash 变化，如何更新页面</a></li></ul></li><li><a href="/frameworks/react-native.html" class="sidebar-link">React Native</a></li><li><a href="/frameworks/react.html" class="sidebar-link">React</a></li><li><a href="/frameworks/redux.html" class="sidebar-link">Redux</a></li><li><a href="/frameworks/svelte.html" class="sidebar-link">Svelte</a></li><li><a href="/frameworks/swiper.html" class="sidebar-link">Swiper</a></li><li><a href="/frameworks/vue-components.html" class="sidebar-link">vue-components</a></li><li><a href="/frameworks/vue-router.html" class="sidebar-link">vue-router</a></li><li><a href="/frameworks/vue.html" class="sidebar-link">Vue</a></li><li><a href="/frameworks/vuejs-issues.html" class="sidebar-link">vue-issues</a></li><li><a href="/frameworks/vuex.html" class="sidebar-link">Vuex</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react-issues"><a href="#react-issues" class="header-anchor">#</a> react issues</h1> <p></p><div class="table-of-contents"><ul><li><a href="#页面结构">页面结构</a></li><li><a href="#注意">注意</a></li><li><a href="#page-bare-template">page bare template</a></li><li><a href="#typescript">TypeScript</a><ul><li><a href="#json-快速生成-ts">JSON 快速生成 TS</a></li></ul></li><li><a href="#影响效率因素">影响效率因素</a></li><li><a href="#新建页面">新建页面</a></li><li><a href="#表格实现">表格实现</a></li><li><a href="#路径-routes">路径 routes</a></li><li><a href="#connect">connect</a></li><li><a href="#解构对象内容">解构对象内容</a></li><li><a href="#checkbox-group">checkbox.group</a></li><li><a href="#classnames">classNames</a></li><li><a href="#umi-requesttype-默认是-json-可选-form">umi requestType 默认是 json，可选 form</a></li><li><a href="#iconfont-cn-use-in-antd">iconfont.cn use in antd</a></li><li><a href="#hover-exclude">hover exclude</a></li><li><a href="#useeffect-反复执行">useEffect 反复执行</a></li><li><a href="#数据联动">数据联动</a></li><li><a href="#antd-form-onfinished">antd form onFinished</a></li><li><a href="#hook-state-拆分合并原则">hook state 拆分合并原则</a></li><li><a href="#可以在函数内直接申明普通常量或普通函数吗">可以在函数内直接申明普通常量或普通函数吗？</a></li><li><a href="#useeffect-不要用-async-use-usecallback-instead">useEffect 不要用 async, use useCallback instead</a></li><li><a href="#list-virtualized">list virtualized</a></li><li><a href="#生命周期模拟-useeffect">生命周期模拟 useEffect</a></li><li><a href="#calc-px-计算">calc px 计算</a></li><li><a href="#播放器能支持哪些文件类型">播放器能支持哪些文件类型</a></li><li><a href="#使用多个-usestate-或-usereducer">使用多个 useState 或 useReducer</a></li><li><a href="#复杂-state-逻辑建议用-react-自带-usereducer">复杂 state 逻辑建议用 React 自带 useReducer</a></li><li><a href="#自定义-hook">自定义 hook</a></li><li><a href="#rangepicker-没有样式">RangePicker 没有样式</a></li><li><a href="#dva-使用">dva 使用</a></li><li><a href="#antd-权限组件">antd 权限组件</a></li><li><a href="#hook-dva-snip">hook dva snip</a></li><li><a href="#umi-ui">umi ui</a></li><li><a href="#自定义左侧菜单-icon">自定义左侧菜单 icon</a></li><li><a href="#动态-menu">动态 menu</a></li><li><a href="#参数路由">参数路由</a></li><li><a href="#layouts">layouts</a></li><li><a href="#视图无关的数据">视图无关的数据</a></li><li><a href="#re-render">re-render</a></li><li><a href="#why-mapstate-mapdispatch">why mapState mapDispatch</a></li><li><a href="#容器组件模式">容器组件模式</a></li><li><a href="#umi-简化数据流方案">umi 简化数据流方案</a></li><li><a href="#class-组件不能用-hooks">class 组件不能用 hooks</a></li><li><a href="#form-表单数据存储到上层组件">form 表单数据存储到上层组件</a></li><li><a href="#warning-antd-upload-value-is-not-a-valid-prop-do-you-mean-filelist">Warning: [antd: Upload] value is not a valid prop, do you mean fileList?</a></li><li><a href="#unhandled-rejection-typeerror-object-is-not-a-function">Unhandled Rejection (TypeError): Object(...) is not a function</a></li><li><a href="#使用-upload-组件上传图片提示-uncaught-error-must-set-key-for-rc-animate-children">使用 upload 组件上传图片提示：Uncaught Error: must set key for <rc-animate> children</rc-animate></a></li><li><a href="#error-too-many-re-renders-react-limits-the-number-of-renders-to-prevent-an-infinite-loop">Error: Too many re-renders. React limits the number of renders to prevent an infinite loop.</a></li><li><a href="#自定义表单控件">自定义表单控件</a></li><li><a href="#usemodel-是否会触发-redux-插件">useModel 是否会触发 redux 插件</a></li><li><a href="#给定深层数据-id-tree-结构定位">给定深层数据 id，tree 结构定位</a></li><li><a href="#antd-官方-dragger-丢失文件">antd 官方 dragger 丢失文件</a></li><li><a href="#useeffect-函数惰性-绑定函数记忆的可以是旧的依赖值">useEffect 函数惰性，绑定函数记忆的可以是旧的依赖值</a></li><li><a href="#切换素材时-form-item-下发的-value-不更新-故改为手动传">切换素材时，Form.item 下发的 value 不更新，故改为手动传</a></li><li><a href="#react-props-默认值使用非基础类型-引起不必要更新">react props 默认值使用非基础类型 引起不必要更新</a></li><li><a href="#failed-to-execute-clone-on-response-umi">Failed to execute 'clone' on 'Response' umi</a></li><li><a href="#antd-layout">antd layout</a></li><li><a href="#menu">menu</a></li><li><a href="#usemodel-持久化-浅拷贝数据里如果有对象-对象经修改-会保持">useModel 持久化，浅拷贝数据里如果有对象 对象经修改，会保持</a></li><li><a href="#异步权限">异步权限</a></li><li><a href="#关闭菜单国际化">关闭菜单国际化</a></li><li><a href="#对象意外修改">对象意外修改</a></li><li><a href="#总结自己使用过的-hooks-数据流方式-掘金-https-juejin-im-post-5e9148f76fb9a03c8966daf8">总结自己使用过的 Hooks 数据流方式 - 掘金</a></li><li><a href="#css-module-局部作用域">CSS module 局部作用域</a></li><li><a href="#权限控制">权限控制</a></li><li><a href="#模块模式">模块模式</a></li><li><a href="#记忆-memo">记忆 memo</a></li><li><a href="#file-type-不可靠">file.type 不可靠</a></li><li><a href="#动态样式">动态样式</a></li><li><a href="#undefined-未赋值-null-值为空">undefined 未赋值 null 值为空</a></li><li><a href="#less-alpha">less alpha</a></li><li><a href="#antd-日期选择-预设日期">antd 日期选择 预设日期</a></li><li><a href="#特殊选中需求">特殊选中需求</a></li><li><a href="#使用-传递对象-修改时-注意提前-clone-不要影响原对象">使用 传递对象，修改时，注意提前 clone，不要影响原对象</a></li><li><a href="#审核自动切换">审核自动切换</a></li><li><a href="#css-hover-不适用内容有间距场景">css hover 不适用内容有间距场景</a></li><li><a href="#antd-日期组件返回的时间是当时时间">antd 日期组件返回的时间是当时时间</a></li><li><a href="#replace-designlayout-with-prolayout">replace DesignLayout with ProLayout</a></li><li><a href="#权限处理">权限处理</a></li><li><a href="#ts-demo">ts demo</a></li><li><a href="#percent-事件频繁导致-多个组件过度-render">percent 事件频繁导致 多个组件过度 render</a></li><li><a href="#跨代数据共享">跨代数据共享</a></li><li><a href="#我是如何无缝的扩展-antd-组件-知乎-https-zhuanlan-zhihu-com-p-111850451">我是如何无缝的扩展 antd 组件 - 知乎</a></li><li><a href="#ant-design-repo">ant design repo</a></li><li><a href="#高阶组件">高阶组件</a></li><li><a href="#antd-强烈风格-不适合较大定制">Antd 强烈风格，不适合较大定制</a></li><li><a href="#线上-设计素材浏览有个-bug-切换二级菜单时-列表数据某些场景会互相影响">线上 设计素材浏览有个 bug，切换二级菜单时，列表数据某些场景会互相影响</a></li><li><a href="#图标替换">图标替换</a></li><li><a href="#require-文件不存在">require 文件不存在</a></li><li><a href="#react-如何点击页面空白处关闭弹窗">React 如何点击页面空白处关闭弹窗</a></li><li><a href="#umi-env-页面内不要解构-process-env">umi env 页面内不要解构 process.env</a></li><li><a href="#form-field-避免下标访问-不利于扩展">form field 避免下标访问，不利于扩展</a></li><li><a href="#公共组件样式">公共组件样式</a></li><li><a href="#husky">husky</a></li><li><a href="#antd-range-picker-blur-hide-如何实现">antd range-picker blur hide 如何实现</a></li><li><a href="#stylelint-异常输出">stylelint 异常输出</a></li><li><a href="#umi-request-requesttype-生效条件">umi-request requestType 生效条件</a></li><li><a href="#createportal-左右切换时-生成多余-div">createPortal，左右切换时，生成多余 div</a></li><li><a href="#todo-material-lib">todo material-lib</a></li><li><a href="#react-hooks-四-immutable-知乎-https-zhuanlan-zhihu-com-p-163590288">React Hooks(四): immutable - 知乎</a></li><li><a href="#caches-操作要求-https">caches 操作要求 https</a></li><li><a href="#请求优化-token-是否存在或在有效期内">请求优化，token 是否存在或在有效期内</a></li><li><a href="#static-proptypes">static propTypes</a></li><li><a href="#何时单独用-xhr">何时单独用 xhr</a></li><li><a href="#immerjs-优于使用-lodash-创建拷贝">ImmerJS 优于使用 lodash 创建拷贝</a></li><li><a href="#竞速-race">竞速 race</a></li><li><a href="#upload-drag-扩大区域">upload drag 扩大区域</a></li><li><a href="#定位代码最快方式">定位代码最快方式</a></li><li><a href="#开发阶段-eslint-影响初期效率">开发阶段 eslint 影响初期效率</a></li><li><a href="#临时禁用-lint">临时禁用 lint</a></li><li><a href="#空数组约定">空数组约定</a></li><li><a href="#map-key">map key</a></li><li><a href="#hmr-fast-refresh">HMR =&gt; Fast Refresh</a></li><li><a href="#dan-note">dan note</a></li><li><a href="#constructor-里发请求">constructor 里发请求？</a></li><li><a href="#自定义-tag">自定义 Tag</a></li><li><a href="#jsx-map-join-reduce">jsx map join =&gt; reduce</a></li><li><a href="#pages-重复渲染-尤其-audio-有动画明显">pages 重复渲染，尤其 audio 有动画明显</a></li><li><a href="#effect-相关函数处理">effect 相关函数处理：</a></li><li><a href="#modal-router">modal router</a></li><li><a href="#鼠标进入触发-lottie">鼠标进入触发 lottie</a></li><li><a href="#antd-table">antd table</a></li><li><a href="#state-派生自-prop-组件内又修改-state">state 派生自 prop，组件内又修改 state</a></li><li><a href="#第二层弹窗问题">第二层弹窗问题</a></li><li><a href="#redux-dev-tool-crash">redux dev tool crash</a></li><li><a href="#无效组件">无效组件</a></li><li><a href="#点击文本复制">点击文本复制</a></li><li><a href="#半受控-props-变化-需要更新部分-state">半受控，props 变化，需要更新部分 state</a></li><li><a href="#缓存计算">缓存计算</a></li><li><a href="#ripple-btn">ripple btn</a></li><li><a href="#跨组件引用可变对象">跨组件引用可变对象</a></li><li><a href="#webpack-cpu占用高">webpack CPU占用高</a></li><li><a href="#表格踩坑-最佳实践">表格踩坑，最佳实践</a></li><li><a href="#url-hash-变化-如何更新页面">URL hash 变化，如何更新页面</a></li></ul></div><p></p> <h2 id="页面结构"><a href="#页面结构" class="header-anchor">#</a> 页面结构</h2> <div class="language- extra-class"><pre class="language-text"><code>page =&gt; connect

components

dva model
</code></pre></div><h2 id="注意"><a href="#注意" class="header-anchor">#</a> 注意</h2> <ul><li><p>不能缺少文件，文件不能为空</p> <p>样式占位</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.xx</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> initial<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>modal 可以用别的页面复制一个</p></li> <li><p>routes -&gt; config -&gt; index</p></li></ul> <h2 id="page-bare-template"><a href="#page-bare-template" class="header-anchor">#</a> page bare template</h2> <ol><li>export function</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token comment">// import './index.less';</span>
<span class="token comment">// import styles from './index.less';</span>

<span class="token keyword">const</span> <span class="token function-variable function">Comp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span>detail hello<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Comp
</code></pre></div><ol start="2"><li>export component</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token comment">// import styles from './index.less';</span>
<span class="token keyword">const</span> propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>number<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  url<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>
  text<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>string
<span class="token punctuation">}</span>
<span class="token keyword">const</span> defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
  text<span class="token operator">:</span> <span class="token string">'Hello World'</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Comp</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    hello<span class="token operator">:</span> <span class="token string">'world'</span>
  <span class="token punctuation">}</span>

  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> hello <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token punctuation">{</span>hello<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
Comp<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> propTypes
Comp<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> defaultProps
</code></pre></div><ul><li><p>提示：</p> <div class="language- extra-class"><pre class="language-text"><code>Each record in table should have a unique `key` prop,or set `rowKey` to an unique primary key. #7623
</code></pre></div><p>mock 数据，id 重了</p></li> <li><p>全局安装 <code>yarn global add typescript</code></p></li></ul> <h2 id="typescript"><a href="#typescript" class="header-anchor">#</a> TypeScript</h2> <p>校验：</p> <ul><li><p>antd 引入应该在 interface 之前</p></li> <li><p>命名不要重名</p> <p>组件 -&gt; model(数据) -&gt; interface(TS)</p> <p>dva model 小写</p> <p>interface 单独命名，辅助性的，重要性低</p> <p>组件名只定义一次，没啥问题</p> <p>批量重命名踩坑，替换时正则需要使用大小写敏感</p></li> <li><p>event 定义</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">onUpdatingServerName</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token operator">:</span> React<span class="token punctuation">.</span>ChangeEvent<span class="token operator">&lt;</span>HTMLInputElement<span class="token operator">&gt;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>newserverName <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/44321326/property-value-does-not-exist-on-type-eventtarget-in-typescript/44321394" target="_blank" rel="noopener noreferrer">javascript - Property 'value' does not exist on type EventTarget in TypeScript - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <h3 id="json-快速生成-ts"><a href="#json-快速生成-ts" class="header-anchor">#</a> JSON 快速生成 TS</h3> <ol><li>vscode 新建文件</li> <li>复制有效的 JSON，需要带上括号</li> <li>执行<code>Paste JSON as TYPE</code></li></ol> <ul><li><p>any 慎用，那什么时候用呢？a. 用户输入 b. 不知道数组内数据类型</p></li> <li><p>拆分粒度</p></li> <li><p>render 不能用 async，不能 setState</p></li> <li><p>?</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  curPaymentMethod <span class="token operator">===</span> <span class="token string">'1'</span> <span class="token operator">?</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>AliPayModal
      visible<span class="token operator">=</span><span class="token punctuation">{</span>modalVisible<span class="token punctuation">}</span>
      onCancel<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>closeModal<span class="token punctuation">}</span>
      onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onPayDone<span class="token punctuation">}</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>WechatPayModal
      visible<span class="token operator">=</span><span class="token punctuation">{</span>modalVisible<span class="token punctuation">}</span>
      onCancel<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>closeModal<span class="token punctuation">}</span>
      onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onPayDone<span class="token punctuation">}</span>
      qrCodeStr<span class="token operator">=</span><span class="token string">&quot;hahajl&quot;</span>
    <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Uncaught Invariant Violation: Objects are not valid as a React child (found: [object Promise]). If you meant to render a collection of children, use an array instead.
in WechatPayModal (created by Pay)</p></blockquote></li> <li><p>路由 components 与子 routes 互 chi？</p></li> <li><p>func comp 在父层处理 async，请求后或 dismount</p></li> <li><p>antd ts 在 node_modules 中找</p></li> <li><p>只检验 stashed</p></li> <li><p>ts 函数要写明返回</p></li></ul> <h2 id="影响效率因素"><a href="#影响效率因素" class="header-anchor">#</a> 影响效率因素</h2> <ul><li>熟练手写 ts，类型补全或自定义 snip</li> <li>dom 闭合补全 &gt; emmet 可以用</li> <li>timeout ts number window.setTimeout</li> <li>obj / array 如果有内容，内容也要 ts 定义</li> <li>serve:no-mock</li></ul> <h2 id="新建页面"><a href="#新建页面" class="header-anchor">#</a> 新建页面</h2> <ol><li><p>验证路由配置是否正确，最小步骤</p> <ol><li>add route</li> <li>add pages index.js，不要创建其它文件，会报错</li></ol></li> <li><p>新建 service，确认需要使用的全部接口，有多少接口写多少 model</p></li> <li><p>新建 model，写这个时与 service side by side，入参需要看下 showDoc</p></li></ol> <h2 id="表格实现"><a href="#表格实现" class="header-anchor">#</a> 表格实现</h2> <div class="language- extra-class"><pre class="language-text"><code>~/Projects/work/AiJianZiPlatform/src/routes/Useradmin/BSchool/b-school.js

Card(title=&quot;filter node&quot;) // col - formItem - select
  StandardTable
</code></pre></div><ol start="2"><li>SearchList</li></ol> <div class="language- extra-class"><pre class="language-text"><code>~/Projects/work/ajz-admin-agency/src/pages/student-manage/student-account/index.tsx
</code></pre></div><ol start="3"><li>自己拼装
searchList 上面不能加东西
course-limit</li></ol> <h2 id="路径-routes"><a href="#路径-routes" class="header-anchor">#</a> 路径 routes</h2> <ol><li>下级必须是上级子路径</li></ol> <ul><li><p>提交操作，总是要考虑防止过快多次点击</p></li> <li><p><a href="https://stackoverflow.com/questions/55265604/uncaught-invariant-violation-too-many-re-renders-react-limits-the-number-of-re" target="_blank" rel="noopener noreferrer">javascript - Uncaught Invariant Violation: Too many re-renders. React limits the number of renders to prevent an infinite loop - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
setState 被直接调用了</p></li> <li><p>classNames 样式类合并</p></li> <li><p>TS 不处理提交会影响别人，一定要处理、熟悉，提高效率</p></li> <li><p>原型、设计，找别人确认，有疑问要早问，后续改成本高</p></li> <li><p>我们把这个版本的 identity 函数叫做泛型，因为它可以适用于多个类型。 不同于使用 any，它不会丢失信息，像第一个例子那像保持准确性，传入数值类型并返回数值类型。</p></li></ul> <h2 id="connect"><a href="#connect" class="header-anchor">#</a> connect</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">:</span> ConnectState</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> classes<span class="token punctuation">,</span> loading <span class="token punctuation">}</span> <span class="token operator">=</span> state
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    classes<span class="token punctuation">,</span>
    loading<span class="token operator">:</span> loading<span class="token punctuation">.</span>effects<span class="token punctuation">[</span>queryBaseStatApi<span class="token punctuation">]</span><span class="token punctuation">,</span>
    saveLoading<span class="token operator">:</span> loading<span class="token punctuation">.</span>effects<span class="token punctuation">[</span>createClassApi<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>Page<span class="token punctuation">)</span>
</code></pre></div><p>React.FC 新类型，可以处理 state</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">interface</span> <span class="token class-name">IProps</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... props interface</span>
<span class="token punctuation">}</span>

<span class="token comment">// NEW syntax for typing function components</span>
<span class="token keyword">const</span> MyNewComponent<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token constant">FC</span><span class="token operator">&lt;</span>IProps<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">const</span> FunctionComponent<span class="token operator">:</span> React<span class="token punctuation">.</span><span class="token function-variable function">FC</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// The useState hook</span>
<span class="token punctuation">}</span>
</code></pre></div><p>hooks 返回 return undefined or a function</p> <p><a href="https://levelup.gitconnected.com/usetypescript-a-complete-guide-to-react-hooks-and-typescript-db1858d1fb9c" target="_blank" rel="noopener noreferrer">useTypescript — A Complete Guide to React Hooks and TypeScript<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>max-length 会阻止输入，进而不触发验证提示</p> <p>searchList ts 定义来自，tableColumns dataIndex</p> <p>ts 参数用尖括号</p> <p>ts 单独文件定义，跳转很方便</p> <p>反击自动化</p> <p>加验证头，能解决插件下载吗？
<a href="https://github.com/videojs/http-streaming/issues/357#issuecomment-374889346" target="_blank" rel="noopener noreferrer">Prevent downloading encrypted content with Firefox video download helper extension · Issue #357 · videojs/http-streaming<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="解构对象内容"><a href="#解构对象内容" class="header-anchor">#</a> 解构对象内容</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> body <span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request <span class="token keyword">as</span> <span class="token punctuation">{</span> body<span class="token operator">:</span> CreateOperation <span class="token punctuation">}</span>
</code></pre></div><h2 id="checkbox-group"><a href="#checkbox-group" class="header-anchor">#</a> checkbox.group</h2> <p>比较特殊，需要在 group 级控制子内容 checked 属性</p> <p>defaultValue 设置后就不再变，列表条目切换会相互影响</p> <p><s>value 设置后，点击状态不变，需要 onChange 把变化向上传递，再传回响应变化</s></p> <h2 id="classnames"><a href="#classnames" class="header-anchor">#</a> classNames</h2> <p>这里 styles.disabled 是动态类名，要用数组下标方式包起来。字符串不需要</p> <p><code>&lt;a className={classNames({ [styles.disabled]: !haveRoles })}</code></p> <h2 id="umi-requesttype-默认是-json-可选-form"><a href="#umi-requesttype-默认是-json-可选-form" class="header-anchor">#</a> umi requestType 默认是 json，可选 form</h2> <h2 id="iconfont-cn-use-in-antd"><a href="#iconfont-cn-use-in-antd" class="header-anchor">#</a> iconfont.cn use in antd</h2> <p>createFromIconfontCN</p> <h2 id="hover-exclude"><a href="#hover-exclude" class="header-anchor">#</a> hover exclude</h2> <p>Pointer events to the rescue!</p> <p><a href="https://techstacker.com/css-remove-hover-pointer-events-none/" target="_blank" rel="noopener noreferrer">How to ignore Hover/Mouseover events on specific element in CSS with the pointer-events property – Techstacker<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="useeffect-反复执行"><a href="#useeffect-反复执行" class="header-anchor">#</a> useEffect 反复执行</h2> <p>trick 第二参数不变，只执行一次</p> <p>配合第二参数、返回函数，相当于三个生命周期</p> <h2 id="数据联动"><a href="#数据联动" class="header-anchor">#</a> 数据联动</h2> <ul><li>输入关键字 提交</li> <li>标签选择 选中 提交
<ul><li>选中 不支持 反选</li> <li>仅素材类型 限单选</li></ul></li> <li>筛选 过滤回显 数据包含类型关系
<ul><li>顺序要求</li> <li>删除、如何修改对应值</li></ul></li></ul> <p>同级组件需要伟递事件，只能依靠 model 了？</p> <p>searchParams</p> <p>Function components cannot be given refs</p> <h2 id="antd-form-onfinished"><a href="#antd-form-onfinished" class="header-anchor">#</a> antd form onFinished</h2> <p>通过时提交</p> <h2 id="hook-state-拆分合并原则"><a href="#hook-state-拆分合并原则" class="header-anchor">#</a> hook state 拆分合并原则</h2> <ol><li>将完全不相关的 state 拆分为多组 state。比如 size 和 position。</li> <li>如果某些 state 是相互关联的，或者需要一起发生改变，就可以把它们合并为一组 state。比如 left 和 top。</li></ol> <p>依赖数组依赖的值最好不要超过 3 个，否则会导致代码会难以维护。
如果发现依赖数组依赖的值过多，我们应该采取一些方法来减少它。
去掉不必要的依赖。
将 Hook 拆分为更小的单元，每个 Hook 依赖于各自的依赖数组。
通过合并相关的 state，将多个依赖值聚合为一个。
通过 setState 回调函数获取最新的 state，以减少外部依赖。
通过 ref 来读取可变变量的值，不过需要注意控制修改它的途径。</p> <p><a href="https://zhuanlan.zhihu.com/p/85969406" target="_blank" rel="noopener noreferrer">React Hooks 你真的用对了吗？ - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="可以在函数内直接申明普通常量或普通函数吗"><a href="#可以在函数内直接申明普通常量或普通函数吗" class="header-anchor">#</a> 可以在函数内直接申明普通常量或普通函数吗？</h2> <p>可以但不建议，Function Component 每次渲染都会重新执行，常量推荐放到函数外层避免性能问题，函数推荐使用 useCallback 申明。</p> <p>简单的组件间通信使用透传 Props 变量的方式，而频繁组件间通信使用 React.useContext</p> <p><a href="https://zhuanlan.zhihu.com/p/81752821" target="_blank" rel="noopener noreferrer">精读《React Hooks 最佳实践》 - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/94949118" target="_blank" rel="noopener noreferrer">《蚂蚁前端研发最佳实践》文字稿 - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>hook class 转换，多个 render 函数，里面是 return</p> <p>getDerivedStateFromProps 介于 contructor 和 render 之间，响应 props 变化，返回 state</p> <h2 id="useeffect-不要用-async-use-usecallback-instead"><a href="#useeffect-不要用-async-use-usecallback-instead" class="header-anchor">#</a> useEffect 不要用 async, use useCallback instead</h2> <p><a href="https://stackoverflow.com/questions/53332321/react-hook-warnings-for-async-function-in-useeffect-useeffect-function-must-ret" target="_blank" rel="noopener noreferrer">javascript - React Hook Warnings for async function in useEffect: useEffect function must return a cleanup function or nothing - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>useEffect 应该什么都不返回，而 async 隐式返回 promise</p> <h2 id="list-virtualized"><a href="#list-virtualized" class="header-anchor">#</a> list virtualized</h2> <p>为大数据列表，性能优化，非必须</p> <h2 id="生命周期模拟-useeffect"><a href="#生命周期模拟-useeffect" class="header-anchor">#</a> 生命周期模拟 useEffect</h2> <p>因为生命周期处理的都是副作用，在 hook 里就是用 useEffect</p> <p>可以写多个 useEffect，给 effect fn 命名以区分职责</p> <p>useEffect 每次渲染（DOM 更新）完执行 effect fn</p> <blockquote><p>不用再去考虑“挂载”还是“更新”。React 保证了每次运行 effect 的同时，DOM 都已经更新完毕</p></blockquote> <p>生命周期对应 useEffect 用法：</p> <ul><li>componentDidMount []</li> <li>componentDidUpdate [states.count | props.count] 仅变化时调用，减少不必要执行</li> <li>componentWillUnmount return function cleanup</li></ul> <p>getDerivedStateFromProps 渲染中赋值，如果需要对比差异，可以增加缓存值</p> <p>shouldComponentUpdate React.memo</p> <p>什么是副作用，数据获取，browser api</p> <p>render （提升成）函数本身，函数组件就是一个 render 函数</p> <p><a href="https://juejin.im/post/5d3db4da518825016f644561" target="_blank" rel="noopener noreferrer">Hooks 与 React 生命周期的关系 - 掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>hook 在最顶层调用，如果需要有条件执行，在 hook 内部判断</p> <h2 id="calc-px-计算"><a href="#calc-px-计算" class="header-anchor">#</a> calc px 计算</h2> <p><a href="https://stackoverflow.com/questions/42548630/css3-calc-minus-vh-with-pixel/42556033" target="_blank" rel="noopener noreferrer">css - Css3 calc minus vh with pixel - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="播放器能支持哪些文件类型"><a href="#播放器能支持哪些文件类型" class="header-anchor">#</a> 播放器能支持哪些文件类型</h2> <p>第三方播放器取决于浏览器支持</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Containers" target="_blank" rel="noopener noreferrer">Media container formats (file types) - Web media technologies | MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="使用多个-usestate-或-usereducer"><a href="#使用多个-usestate-或-usereducer" class="header-anchor">#</a> 使用多个 useState 或 useReducer</h2> <p>Should I use multiple useState or useReducer?</p> <p>For independent things (isHovering and textInput), multiple useState.
独立状态，使用多个 useState</p> <p>For things that change together (isFetching and fetchedItems), or if their next state depends on previous (todos), I prefer useReducer.
状态一起改变，或状态前后依赖，更倾向用 useReducer</p> <h2 id="复杂-state-逻辑建议用-react-自带-usereducer"><a href="#复杂-state-逻辑建议用-react-自带-usereducer" class="header-anchor">#</a> 复杂 state 逻辑建议用 React 自带 useReducer</h2> <p>如果从组件状态上升到应用状态，用 Redux
redux 不仅是状态管理，是一种架构
出了 bug，好定位</p> <blockquote><p>我新开发的应用几乎都用到了 Redux，以前做选择是很简单的：几乎所有项目都用 Redux 就行了！
当你向 Redux 状态添加内容时，加进来的是一个抽象层以及随之而来的复杂度。
换句话说，你大可放心使用 Redux，但是每次用到它时应该有合适的理由。</p></blockquote> <p>使用理由：</p> <ul><li>使用网络之类的 I/O 或设备 API。</li> <li>保存或加载状态。</li> <li>与非子组件共享其状态。 （如素材库的查找参数，多个组件更新，可以做为一个抽象层，不要跟别的逻辑混在一起）</li> <li>需要与应用程序的其他部分共享业务逻辑或数据处理过程。</li></ul> <p><a href="https://medium.com/javascript-scene/do-react-hooks-replace-redux-210bab340672" target="_blank" rel="noopener noreferrer">Do React Hooks Replace Redux? - JavaScript Scene - Medium<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="自定义-hook"><a href="#自定义-hook" class="header-anchor">#</a> 自定义 hook</h2> <ul><li>逻辑抽象</li> <li>复用
<a href="https://juejin.im/post/5df8b978e51d45584006e1f5" target="_blank" rel="noopener noreferrer">基用 React Hooks + Antd 快速实现一个列表页 - 掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="rangepicker-没有样式"><a href="#rangepicker-没有样式" class="header-anchor">#</a> RangePicker 没有样式</h2> <p>重启服务后正常</p> <h2 id="dva-使用"><a href="#dva-使用" class="header-anchor">#</a> dva 使用</h2> <h2 id="antd-权限组件"><a href="#antd-权限组件" class="header-anchor">#</a> antd 权限组件</h2> <ul><li>layout 级的 authority 不起作用？</li> <li>可以嵌套 layout，SecurityLayout &gt; BasicLayout &gt; page</li></ul> <h2 id="hook-dva-snip"><a href="#hook-dva-snip" class="header-anchor">#</a> hook dva snip</h2> <h2 id="umi-ui"><a href="#umi-ui" class="header-anchor">#</a> umi ui</h2> <p>可视化配置工具，用处不大
查看模板可访问 <a href="https://preview.pro.ant.design/dashboard/analysis" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
关闭参考<code>start:no-ui</code>命令</p> <h2 id="自定义左侧菜单-icon"><a href="#自定义左侧菜单-icon" class="header-anchor">#</a> 自定义左侧菜单 icon</h2> <ol><li>defaultSettings iconfontUrl</li> <li>修改 router config</li></ol> <p><a href="https://prolayout.ant.design/" target="_blank" rel="noopener noreferrer">配置 api 介绍<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="动态-menu"><a href="#动态-menu" class="header-anchor">#</a> 动态 menu</h2> <p>setMenuData</p> <h2 id="参数路由"><a href="#参数路由" class="header-anchor">#</a> 参数路由</h2> <h2 id="layouts"><a href="#layouts" class="header-anchor">#</a> layouts</h2> <p>UserLayout 就是上方有个 logo、下方留空，如给登录使用</p> <h2 id="视图无关的数据"><a href="#视图无关的数据" class="header-anchor">#</a> 视图无关的数据</h2> <p>定义在 RFC 外面</p> <h2 id="re-render"><a href="#re-render" class="header-anchor">#</a> re-render</h2> <p>每次 re-render，<strong>异步函数</strong>会创建新实例，原始版本不再指向正确的实例</p> <p>使用 useCallback，并提供依赖值</p> <h2 id="why-mapstate-mapdispatch"><a href="#why-mapstate-mapdispatch" class="header-anchor">#</a> why mapState mapDispatch</h2> <p>任何能在组件外以 redux action 方式生存的异步业务逻辑，考虑到使操作不受组件生命周期影响，仅定义为容器的 mapDispatchToProps 并传递给组件，这样意味着你的组件可免除异步逻辑、而变得相当简单，业务逻辑不再与视图紧耦合</p> <p>展示组件唯一依赖来源 prop，不关心数据怎么来、不关心什么是 dispatch
<a href="https://stackoverflow.com/questions/39419237/what-is-mapdispatchtoprops" target="_blank" rel="noopener noreferrer">reactjs - What is mapDispatchToProps? - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="容器组件模式"><a href="#容器组件模式" class="header-anchor">#</a> 容器组件模式</h2> <p>容器处理数据获取，然后渲染相应的子组件，就是这样</p> <p>相应组件意味着同名，如 <code>StockWidgetContainer =&gt; StockWidget</code></p> <p>数据获取和渲染职责分离、渲染组件可复用，渲染组件依靠 PropTypes 显式失败</p> <p><a href="https://medium.com/@learnreact/container-components-c0e67432e005#.1a9j3w1jl" target="_blank" rel="noopener noreferrer">Container Components - Learn React with chantastic - Medium<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="umi-简化数据流方案"><a href="#umi-简化数据流方案" class="header-anchor">#</a> umi 简化数据流方案</h2> <p><a href="https://umijs.org/zh-CN/plugins/plugin-model" target="_blank" rel="noopener noreferrer">@umijs/plugin-model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
页面 pattern model/*<em>/</em> 或 *.model.ts
pages/user/counter.model.js
pages/user/models/counter.js
useModel('user.counter')</p> <p>namespace 小写命名，跟其它类型变量区分</p> <p>有哪些 namespace 可用，编辑器会提示</p> <p>发现还是全局请求了，意思是只支持全局，支持不同的放置位置</p> <p>或者可以把方法导出去，只在需要的页面调用</p> <p>https://github.com/umijs/umi/issues/5195#issuecomment-672527326
<a href="https://github.com/ant-design/ant-design-pro/issues/6605" target="_blank" rel="noopener noreferrer">Ant Design Pro V5 已经支持预览 · Issue #6605 · ant-design/ant-design-pro<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>对于轻量级的数据流我们都推荐这种方案。</p></blockquote> <p><a href="https://zhuanlan.zhihu.com/p/103150605" target="_blank" rel="noopener noreferrer">Umi Hooks - 助力拥抱 React Hooks - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://juejin.im/post/5ee081e551882543221d8b42" target="_blank" rel="noopener noreferrer">Umi Hooks 实用代码片段整理 - 掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- extra-class"><pre class="language-text"><code>import {useMouse, useWindowSize, useScroll} from 'react-use'
</code></pre></div><h2 id="class-组件不能用-hooks"><a href="#class-组件不能用-hooks" class="header-anchor">#</a> class 组件不能用 hooks</h2> <blockquote><p>你可以用 hoc 包一层
数据逻辑极端复杂时，用 class</p></blockquote> <p>React hooks 我也在项目中使用了一段时间，确实有它的优势的地方但是好像也没你文章里说的这么好，它确实是将逻辑复用变得更简单纯粹，但是我平时业务开发的时候，复用的不只是逻辑，ui 也需要复用。所以平时封装的时候，封装你文中这种和业务结合交大的自定义 hook 会比较少，大多数时候还是会封装那种 ui 和状态并存的常规组件，当然为了兼容差异化 ui 需求，会通过 render props 配合默认 render，或者使用内部 Context 实现的 Compound component，来将组件拆离成合理的 ui 粒度，同时保留内部逻辑，通过这两种方式来满足你文中提到的差异化 ui 的需求。使用自定义 hook，感觉还是那种工具类型的更合适些</p> <h2 id="form-表单数据存储到上层组件"><a href="#form-表单数据存储到上层组件" class="header-anchor">#</a> form 表单数据存储到上层组件</h2> <p>fields</p> <h2 id="warning-antd-upload-value-is-not-a-valid-prop-do-you-mean-filelist"><a href="#warning-antd-upload-value-is-not-a-valid-prop-do-you-mean-filelist" class="header-anchor">#</a> Warning: [antd: Upload] <code>value</code> is not a valid prop, do you mean <code>fileList</code>?</h2> <p>上传是比较特殊组件，放在 form 里，要特殊设置</p> <p>需要同时使用?</p> <div class="language-js extra-class"><pre class="language-js"><code>valuePropName <span class="token operator">=</span> <span class="token string">'fileList'</span> <span class="token comment">// 指明特殊组件类型</span>
getValueFromEvent <span class="token operator">=</span> <span class="token punctuation">{</span> normFile <span class="token punctuation">}</span>
</code></pre></div><h2 id="unhandled-rejection-typeerror-object-is-not-a-function"><a href="#unhandled-rejection-typeerror-object-is-not-a-function" class="header-anchor">#</a> Unhandled Rejection (TypeError): Object(...) is not a function</h2> <p>function 没有导出</p> <h2 id="使用-upload-组件上传图片提示-uncaught-error-must-set-key-for-children"><a href="#使用-upload-组件上传图片提示-uncaught-error-must-set-key-for-children" class="header-anchor">#</a> 使用 upload 组件上传图片提示：Uncaught Error: must set key for <rc-animate> children</rc-animate></h2> <p>没有设置 uid</p> <h2 id="error-too-many-re-renders-react-limits-the-number-of-renders-to-prevent-an-infinite-loop"><a href="#error-too-many-re-renders-react-limits-the-number-of-renders-to-prevent-an-infinite-loop" class="header-anchor">#</a> Error: Too many re-renders. React limits the number of renders to prevent an infinite loop.</h2> <p>onClick={setSideIndex(index)}</p> <h2 id="自定义表单控件"><a href="#自定义表单控件" class="header-anchor">#</a> 自定义表单控件</h2> <p>完全受控</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Dragger</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">uploadProps</span><span class="token punctuation">}</span></span> <span class="token attr-name">fileList</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onChange<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ant-upload-text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">拖入或点击添加工程文件</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Dragger</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="usemodel-是否会触发-redux-插件"><a href="#usemodel-是否会触发-redux-插件" class="header-anchor">#</a> useModel 是否会触发 redux 插件</h2> <h2 id="给定深层数据-id-tree-结构定位"><a href="#给定深层数据-id-tree-结构定位" class="header-anchor">#</a> 给定深层数据 id，tree 结构定位</h2> <p>转换 tree 为 dict，并添加 parentId 和 index</p> <h2 id="antd-官方-dragger-丢失文件"><a href="#antd-官方-dragger-丢失文件" class="header-anchor">#</a> antd 官方 dragger 丢失文件</h2> <h2 id="useeffect-函数惰性-绑定函数记忆的可以是旧的依赖值"><a href="#useeffect-函数惰性-绑定函数记忆的可以是旧的依赖值" class="header-anchor">#</a> useEffect 函数惰性，绑定函数记忆的可以是旧的依赖值</h2> <ul><li>如果<code>useEffect</code>第一个函数参数直接或者间接用上某个变量，就请把这个变量放在<code>useEffect</code>的第二个参数里</li> <li>使用<code>useEffect</code>，不要调用函数层次太多，代码应该一眼看清楚哪些函数会被<code>useEffect</code>调用。</li> <li>只要是访问了<code>state</code>的函数，都应该用<code>useCallback</code>来保证 state 变化时生成一个新函数</li></ul> <blockquote><p>明确或潜在依赖 state 的函数，都需要指明依赖，以便在 re-render 时重新生成正确依赖的函数</p></blockquote> <h2 id="切换素材时-form-item-下发的-value-不更新-故改为手动传"><a href="#切换素材时-form-item-下发的-value-不更新-故改为手动传" class="header-anchor">#</a> 切换素材时，Form.item 下发的 value 不更新，故改为手动传</h2> <h2 id="react-props-默认值使用非基础类型-引起不必要更新"><a href="#react-props-默认值使用非基础类型-引起不必要更新" class="header-anchor">#</a> react props 默认值使用非基础类型 引起不必要更新</h2> <p>因此使用 ES 默认值时，如果是非基础属性，建议放一个常量在外面：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">EMPTY_ITEMS</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> items <span class="token operator">=</span> <span class="token constant">EMPTY_ITEMS</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Bar dataSource<span class="token operator">=</span><span class="token punctuation">{</span>items<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>https://www.zhihu.com/question/403260687/answer/1306841252</p> <p><a href="https://gist.github.com/otakustay/9b59153da2e124f0637732fef5c71c6a" target="_blank" rel="noopener noreferrer">React hook to control table selection<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/55546844" target="_blank" rel="noopener noreferrer">React 模式（中文版） - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="failed-to-execute-clone-on-response-umi"><a href="#failed-to-execute-clone-on-response-umi" class="header-anchor">#</a> Failed to execute 'clone' on 'Response' umi</h2> <p>要读取 resonse 里内容， clone 一份再处理</p> <h2 id="antd-layout"><a href="#antd-layout" class="header-anchor">#</a> antd layout</h2> <div class="language- extra-class"><pre class="language-text"><code>layouts/SecurityLayout  是否登录
  component: '../layouts/BasicLayout', 权限
  authority: ['admin', 'user'],
</code></pre></div><h2 id="menu"><a href="#menu" class="header-anchor">#</a> menu</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> menuList <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/design/personal'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'个人中心'</span><span class="token punctuation">,</span>
    key<span class="token operator">:</span> <span class="token string">'personal'</span><span class="token punctuation">,</span>
    icon<span class="token operator">:</span> <span class="token operator">&lt;</span>IconFont type<span class="token operator">=</span><span class="token string">&quot;icon-mine&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/design/audit'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'审核中心'</span><span class="token punctuation">,</span>
    key<span class="token operator">:</span> <span class="token string">'audit'</span><span class="token punctuation">,</span>
    icon<span class="token operator">:</span> <span class="token operator">&lt;</span>IconFont type<span class="token operator">=</span><span class="token string">&quot;icon-mine&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> <span class="token function-variable function">RenderMenuItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> path<span class="token punctuation">,</span> key<span class="token punctuation">,</span> icon <span class="token punctuation">}</span> <span class="token operator">=</span> data
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Menu<span class="token punctuation">.</span>Item key<span class="token operator">=</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span> icon<span class="token operator">=</span><span class="token punctuation">{</span>icon<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token punctuation">{</span>path<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Menu<span class="token punctuation">.</span>Item<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token punctuation">{</span>
  menuList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>RenderMenuItem data<span class="token operator">=</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="usemodel-持久化-浅拷贝数据里如果有对象-对象经修改-会保持"><a href="#usemodel-持久化-浅拷贝数据里如果有对象-对象经修改-会保持" class="header-anchor">#</a> useModel 持久化，浅拷贝数据里如果有对象 对象经修改，会保持</h2> <p>解决，深拷贝后，再修改</p> <h2 id="异步权限"><a href="#异步权限" class="header-anchor">#</a> 异步权限</h2> <ol><li>request loading</li> <li>setAuthority 更新 localStorage</li> <li>reloadAuthority</li></ol> <h2 id="关闭菜单国际化"><a href="#关闭菜单国际化" class="header-anchor">#</a> 关闭菜单国际化</h2> <p>defaultSettings</p> <div class="language-js extra-class"><pre class="language-js"><code>  menu<span class="token operator">:</span> <span class="token punctuation">{</span>
    locale<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="对象意外修改"><a href="#对象意外修改" class="header-anchor">#</a> 对象意外修改</h2> <p>pageNum 与需要响应更新列表数据的值分离</p> <h2 id="总结自己使用过的-hooks-数据流方式-掘金"><a href="#总结自己使用过的-hooks-数据流方式-掘金" class="header-anchor">#</a> <a href="https://juejin.im/post/5e9148f76fb9a03c8966daf8" target="_blank" rel="noopener noreferrer">总结自己使用过的 Hooks 数据流方式 - 掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p><a href="https://github.com/jamiebuilds/unstated-next" target="_blank" rel="noopener noreferrer">jamiebuilds/unstated-next: 200 bytes to never think about React state management libraries ever again<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="css-module-局部作用域"><a href="#css-module-局部作用域" class="header-anchor">#</a> CSS module 局部作用域</h2> <p>局部样式与覆盖 global</p> <p>书写上与一般 CSS 无异</p> <p>导入使用时有差异</p> <p>global 即是用来声明传统的 class，方便混用。首先少写全局样式，其次使用时应该包裹起来</p> <div class="language-less extra-class"><pre class="language-less"><code><span class="token selector">.override-ant-btn</span> <span class="token punctuation">{</span>
  <span class="token selector">:global(.ant-btn)</span> <span class="token punctuation">{</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://antd-course.ulivz.com/customized_styles.html#%25E5%25AE%259A%25E4%25B9%2589%25E6%25A0%25B7%25E5%25BC%258F" target="_blank" rel="noopener noreferrer">自定义样式 | Ant Design 实战教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="权限控制"><a href="#权限控制" class="header-anchor">#</a> 权限控制</h2> <p>对于权限控制，首先需要明白一点：“权限的真正控制都必须是在服务端负责的”。</p> <h2 id="模块模式"><a href="#模块模式" class="header-anchor">#</a> 模块模式</h2> <p>定义工具函数时，可以把需要的私有变量包起来，不污染 utils 等文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 除了 double 外界无法访问 a</span>
<span class="token keyword">function</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">realFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> a
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="记忆-memo"><a href="#记忆-memo" class="header-anchor">#</a> 记忆 memo</h2> <ul><li>用数组或对象，将历史计算结果存储</li> <li>实现方式，闭包。模式提炼</li></ul> <h2 id="file-type-不可靠"><a href="#file-type-不可靠" class="header-anchor">#</a> file.type 不可靠</h2> <p>有的文件类型，如 psd、rar，<code>file.type</code>值是<code>&quot;&quot;</code>
直接拿<code>file.name</code>扩展名判断比较好</p> <h2 id="动态样式"><a href="#动态样式" class="header-anchor">#</a> 动态样式</h2> <p>如<code>width</code>数值，用<code>style=</code>就可以</p> <p><a href="https://github.com/ant-design/ant-design/issues/1418" target="_blank" rel="noopener noreferrer">RangePicker『此刻』建议配置成可选时间范围。 · Issue #1418 · ant-design/ant-design<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.cnblogs.com/liuyanxia/p/9099947.html" target="_blank" rel="noopener noreferrer">解决——CSS :before、:after ，当 content 使用中文时有时候会出现乱码 - SophiaLiu - 博客园<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="undefined-未赋值-null-值为空"><a href="#undefined-未赋值-null-值为空" class="header-anchor">#</a> undefined 未赋值 null 值为空</h2> <p><a href="https://github.com/ant-design/ant-design/issues/2367" target="_blank" rel="noopener noreferrer">Select 控件为什么会把 null 当做有 value 而不显示 placeholder ，必须要为 undefined 才可以？ · Issue #2367 · ant-design/ant-design<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="less-alpha"><a href="#less-alpha" class="header-anchor">#</a> less alpha</h2> <p>fade</p> <h2 id="antd-日期选择-预设日期"><a href="#antd-日期选择-预设日期" class="header-anchor">#</a> antd 日期选择 预设日期</h2> <p><a href="https://bz0iy.csb.app/" target="_blank" rel="noopener noreferrer">Sandbox - CodeSandbox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>footer 反转</li> <li>不需要标题栏、关闭<div class="language- extra-class"><pre class="language-text"><code>ant-picker-panel-container
display: flex;
flex-direction: column-reverse;
</code></pre></div></li></ul> <h2 id="特殊选中需求"><a href="#特殊选中需求" class="header-anchor">#</a> 特殊选中需求</h2> <div class="language- extra-class"><pre class="language-text"><code>    .ant-menu-item:not(.ant-menu-item-selected) {
      a[href^='/design/audit'] .anticon {
        color: #00BE7B;
      }
    }
</code></pre></div><h2 id="使用-传递对象-修改时-注意提前-clone-不要影响原对象"><a href="#使用-传递对象-修改时-注意提前-clone-不要影响原对象" class="header-anchor">#</a> 使用 传递对象，修改时，注意提前 clone，不要影响原对象</h2> <p>留意外部传入的 object，然后<code>.</code>语法访问，意外修改了引用</p> <p>lodash cloneDeep</p> <h2 id="审核自动切换"><a href="#审核自动切换" class="header-anchor">#</a> 审核自动切换</h2> <ul><li>移除项</li> <li>不要后台拉取数据，会扰乱 index，使用 filter</li> <li>filter 不会改变顺序</li> <li>使用 filter，切换下一项，不需要移动 index，如果当前 index 无值，即到尾部</li></ul> <h2 id="css-hover-不适用内容有间距场景"><a href="#css-hover-不适用内容有间距场景" class="header-anchor">#</a> css hover 不适用内容有间距场景</h2> <h2 id="antd-日期组件返回的时间是当时时间"><a href="#antd-日期组件返回的时间是当时时间" class="header-anchor">#</a> antd 日期组件返回的时间是当时时间</h2> <p>实际需求，应该是 start 0.00 end 23.59</p> <h2 id="replace-designlayout-with-prolayout"><a href="#replace-designlayout-with-prolayout" class="header-anchor">#</a> replace DesignLayout with ProLayout</h2> <p>1ffb95756ab39c9538affd24c09d7cfe278127a3</p> <h2 id="权限处理"><a href="#权限处理" class="header-anchor">#</a> 权限处理</h2> <div class="language- extra-class"><pre class="language-text"><code>setUser(data)
Storage.setItem('user', data);
reloadAuthorized()
</code></pre></div><h2 id="ts-demo"><a href="#ts-demo" class="header-anchor">#</a> ts demo</h2> <div class="language-js extra-class"><pre class="language-js"><code>type SuperUlMode <span class="token operator">=</span> <span class="token string">'horizontal'</span> <span class="token operator">|</span> <span class="token string">'vertial'</span><span class="token punctuation">;</span>
type SelctCallBackParams <span class="token operator">=</span> <span class="token punctuation">{</span> index<span class="token operator">:</span> number <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> name<span class="token operator">:</span> string <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
type <span class="token function-variable function">SelectCallBack</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>index<span class="token punctuation">,</span> name<span class="token punctuation">}</span><span class="token operator">:</span> SelctCallBackParams</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">SuperUlProps</span> <span class="token punctuation">{</span>
  defaultIndex<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">,</span>
  mode<span class="token operator">?</span><span class="token operator">:</span> SuperUlMode<span class="token punctuation">,</span>
  style<span class="token operator">?</span><span class="token operator">:</span> React<span class="token punctuation">.</span>CSSProperties<span class="token punctuation">,</span>
  onSelect<span class="token operator">?</span><span class="token operator">:</span> SelectCallBack
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">ISuperUlContext</span> <span class="token punctuation">{</span>
  index<span class="token operator">:</span> number<span class="token punctuation">,</span>
  onSelect<span class="token operator">?</span><span class="token operator">:</span> SelectCallBack<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>node_modules/antd/es/</p> <h2 id="percent-事件频繁导致-多个组件过度-render"><a href="#percent-事件频繁导致-多个组件过度-render" class="header-anchor">#</a> percent 事件频繁导致 多个组件过度 render</h2> <p>分析： percent 事件 3-7 次/s emit 给父组件 fileList，变化导致所有依赖 fileList 的组件 render。但外部并不关心这个事件</p> <p>解决： 内部维护一份 fileList，仅非 percent 事件时，向外 emit 变化</p> <h2 id="跨代数据共享"><a href="#跨代数据共享" class="header-anchor">#</a> 跨代数据共享</h2> <ul><li>依赖反转、组件合成</li> <li>动态数据传递，要格外注意显式声明依赖</li></ul> <h2 id="我是如何无缝的扩展-antd-组件-知乎"><a href="#我是如何无缝的扩展-antd-组件-知乎" class="header-anchor">#</a> <a href="https://zhuanlan.zhihu.com/p/111850451" target="_blank" rel="noopener noreferrer">我是如何无缝的扩展 antd 组件 - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <ul><li>扩展组件、但保持旧的引用</li> <li>编辑器能识别吗</li></ul> <h2 id="ant-design-repo"><a href="#ant-design-repo" class="header-anchor">#</a> ant design repo</h2> <p>install use node 8
start use node 14</p> <h2 id="高阶组件"><a href="#高阶组件" class="header-anchor">#</a> 高阶组件</h2> <p><a href="https://gist.github.com/sebmarkbage/ef0bf1f338a7182b6775" target="_blank" rel="noopener noreferrer">Higher-order Components<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://medium.com/@dan_abramov/mixins-are-dead-long-live-higher-order-components-94a0d2f9e750#.eeu8q01s1" target="_blank" rel="noopener noreferrer">Mixins Are Dead. Long Live Composition | by Dan Abramov | Medium<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <blockquote><p>A higher-order component is just a function that takes an existing component and returns another component that wraps it.</p></blockquote> <h2 id="antd-强烈风格-不适合较大定制"><a href="#antd-强烈风格-不适合较大定制" class="header-anchor">#</a> Antd 强烈风格，不适合较大定制</h2> <p>推荐主色定制
<a href="https://github.com/ant-design/ant-design/issues/1241" target="_blank" rel="noopener noreferrer">有关主题设计的建议 · Issue #1241 · ant-design/ant-design<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
样式覆盖、非常麻烦</p> <p>最常用的通用变量</p> <p>读 <a href="https://ant.design/docs/react/faq-cn" target="_blank" rel="noopener noreferrer">FAQ - Ant Design<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="线上-设计素材浏览有个-bug-切换二级菜单时-列表数据某些场景会互相影响"><a href="#线上-设计素材浏览有个-bug-切换二级菜单时-列表数据某些场景会互相影响" class="header-anchor">#</a> 线上 设计素材浏览有个 bug，切换二级菜单时，列表数据某些场景会互相影响</h2> <p>bug 原因，</p> <ol><li>URL 参数变化，组件仅 update，需要重置 state</li> <li>菜单切换，会触发 infiniteLoading，超出最大页数判断有问题</li></ol> <h2 id="图标替换"><a href="#图标替换" class="header-anchor">#</a> 图标替换</h2> <ol><li>需要 JS 操作</li> <li>fork 图标库，单独维护
以 anticon-down 为例，搜索 down，替换 svg，build</li></ol> <p>生成文件
node_modules/@ant-design/icons-svg/lib/asn/DownOutlined.js</p> <p>ant-design-icons/packages/icons-svg/docs/ContributionGuide.zh-CN.md</p> <h2 id="require-文件不存在"><a href="#require-文件不存在" class="header-anchor">#</a> require 文件不存在</h2> <p><a href="https://stackoverflow.com/questions/55213560/javascript-check-if-file-exists-if-not-then" target="_blank" rel="noopener noreferrer">reactjs - JavaScript Check if File exists, if not then - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
─</p> <p>使用 import，报错
Unhandled Rejection (Error): Cannot find module './sketch.svg'
webpack:/src/assets/project lazy ^./.*.svg$ namespace object:45</p> <h2 id="react-如何点击页面空白处关闭弹窗"><a href="#react-如何点击页面空白处关闭弹窗" class="header-anchor">#</a> React 如何点击页面空白处关闭弹窗</h2> <ol><li>给 body 绑定事件 关闭</li> <li>给弹窗等元素绑定点击事件 <code>onClick={e =&gt; e.stopPropagation()}</code></li></ol> <h2 id="umi-env-页面内不要解构-process-env"><a href="#umi-env-页面内不要解构-process-env" class="header-anchor">#</a> umi env 页面内不要解构 process.env</h2> <div class="language- extra-class"><pre class="language-text"><code>const { NODE_ENV, SERVER_ENV } = process.env;

console.error(process.env.SERVER_ENV, SERVER_ENV) // test undefined
</code></pre></div><p>node config/config.ts 可以完整读取 process.env，而 global.tsx 明显是页面层面，读到的是 define 植入，不是真实的 object，不一定能解构出来。所以最好不要用解构语法。</p> <h2 id="form-field-避免下标访问-不利于扩展"><a href="#form-field-避免下标访问-不利于扩展" class="header-anchor">#</a> form field 避免下标访问，不利于扩展</h2> <p>可以用 find name 方式</p> <h2 id="公共组件样式"><a href="#公共组件样式" class="header-anchor">#</a> 公共组件样式</h2> <p>避免传值写死，不利于响应式</p> <h2 id="husky"><a href="#husky" class="header-anchor">#</a> husky</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> i -D husky lint-staged prettier
npx mrm lint-staged
</code></pre></div><p>antd 项目已默认配置</p> <h2 id="antd-range-picker-blur-hide-如何实现"><a href="#antd-range-picker-blur-hide-如何实现" class="header-anchor">#</a> antd range-picker blur hide 如何实现</h2> <p>基于已有组件定制，可以单独使用</p> <p>失焦如何同时支持 input 和 div</p> <p>time-picker
date-picker
<a href="https://www.npmjs.com/package/rc-picker" target="_blank" rel="noopener noreferrer">rc-picker - npm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
rc-picker/src/RangePicker.tsx
triggerInnerOpen
rc-trigger/src/index.tsx
class -hidden
{trigger} onBlur input
{portal} onMouseLeave div
必 delay
onMouseEnter 先清除定时器</p> <h2 id="stylelint-异常输出"><a href="#stylelint-异常输出" class="header-anchor">#</a> stylelint 异常输出</h2> <div class="language- extra-class"><pre class="language-text"><code>单独运行 npm run stylelint 提示未安装
检查 node_modules/.bin 确实没装
可能是 eslint 全局安装，带来的问题？避免全局安装，因为不同项目依赖可能不一样，再加上 ts 等规则依赖，会很麻烦
npm install --no-save stylelint

npx stylelint --help
</code></pre></div><h2 id="umi-request-requesttype-生效条件"><a href="#umi-request-requesttype-生效条件" class="header-anchor">#</a> umi-request requestType 生效条件</h2> <p>'requestType' when the type of data is object or array.</p> <h2 id="createportal-左右切换时-生成多余-div"><a href="#createportal-左右切换时-生成多余-div" class="header-anchor">#</a> createPortal，左右切换时，生成多余 div</h2> <p>避免创建新的 div？不行</p> <p>只能是创建时，先把旧的删掉</p> <h2 id="todo-material-lib"><a href="#todo-material-lib" class="header-anchor">#</a> todo material-lib</h2> <div class="language- extra-class"><pre class="language-text"><code>.ant-menu-item:active, .ant-menu-submenu-title:active {
    /* background: aliceblue; */
}
</code></pre></div><h2 id="react-hooks-四-immutable-知乎"><a href="#react-hooks-四-immutable-知乎" class="header-anchor">#</a> <a href="https://zhuanlan.zhihu.com/p/163590288" target="_blank" rel="noopener noreferrer">React Hooks(四): immutable - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p>更新有两个阶段：1. render: compute diff 2. commit diff to real dom</p> <p>存在问题的是 1，执行计算开销
<a href="https://codesandbox.io/s/child-overload-render-p5p6t" target="_blank" rel="noopener noreferrer">child overload render - CodeSandbox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>期望：</p> <ul><li>值变化，引用变化</li> <li>值不变，引用不变
问题：</li> <li>!!!机制：父组件重渲染会递归重渲染所有子组件，即使子组件依赖的 props 没有变化</li> <li>性能：可避免的重渲染，有的子组件渲染开销很大</li> <li>行为：无用的副作用重执行，无限循环</li> <li>需要重请求保持数据最新场景，而重渲染开销大，返回数据每次创建新对象</li> <li>parse 会创建新对象</li> <li>对子组件来说，依赖的父组件应避免意外变化</li> <li>引用相等，值发生了变化，UI 不更新</li> <li>深拷贝问题，包含对象值不变，引用变了，</li></ul> <p>结论：</p> <ol><li><p>React.memo 包裹组件， 适用 prop 仅原始类型，复杂类型，可以指定比较函数，只适用函数组件</p> <p><a href="https://dmitripavlutin.com/use-react-memo-wisely/" target="_blank" rel="noopener noreferrer">Use React.memo() wisely<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>使用 immer</p> <p><a href="https://zhuanlan.zhihu.com/p/34691516" target="_blank" rel="noopener noreferrer">精读《Immer.js》源码 - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>record 和 tuple，JS 引入不可变数据结构 未来</p></li> <li><p>useRef 适用于父组件内要定义包含常量的对象</p></li> <li><p>避免在 render 中创建对象，或者使用 useMemo 只能是无副作用的高计算开销操作，指定依赖项，仅依赖更新时重新计算</p></li> <li><p>hook state 要求不可变，深层嵌套如果配合 ES6，spread hell</p></li></ol> <p>根源：对象的值比较和引用比较的不一致性
值比较计算开销大</p> <p>很全的文章，不仅是介绍 record tuples
<a href="https://dev.to/sebastienlorber/records-tuples-for-react-way-more-than-immutability-2iic" target="_blank" rel="noopener noreferrer">Records &amp; Tuples for React, way more than immutability<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>官方性能优化指南：</p> <ul><li><p>把存在依赖项的函数，移到 useEffect 内</p></li> <li><p>不需要考虑函数重复创建的开销，除非是确定开销比较大的函数</p></li> <li><p>setState 传入函数更新 state，如果返回值不变，render 会跳过更新 搜<code>setRows</code></p> <p><a href="https://codepen.io/cyio/pen/WNwpGJW?editors=1010" target="_blank" rel="noopener noreferrer">useState: lazy initial state<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li></ul> <p><a href="https://reactjs.org/docs/hooks-faq.html#how-can-i-measure-a-dom-node" target="_blank" rel="noopener noreferrer">Hooks FAQ – React<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="caches-操作要求-https"><a href="#caches-操作要求-https" class="header-anchor">#</a> caches 操作要求 https</h2> <p>if (window.caches &amp;&amp; window.caches.keys) {</p> <p>SecurityError: Failed to execute 'keys' on 'CacheStorage': Only secure origins are allowed (see: https://goo.gl/Y0ZkNV).</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CacheStorage" target="_blank" rel="noopener noreferrer">CacheStorage - Web APIs | MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>安全源定义
<a href="https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features" target="_blank" rel="noopener noreferrer">Prefer Secure Origins For Powerful New Features - The Chromium Projects<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="请求优化-token-是否存在或在有效期内"><a href="#请求优化-token-是否存在或在有效期内" class="header-anchor">#</a> 请求优化，token 是否存在或在有效期内</h2> <p><a href="https://www.cnblogs.com/qkstart/p/11856168.html" target="_blank" rel="noopener noreferrer">React-umi-request 动态刷新 Token 功能实现及 node.js 代码逻辑 - qkstart - 博客园<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="static-proptypes"><a href="#static-proptypes" class="header-anchor">#</a> static propTypes</h2> <p>适用没有 typescript 时，老代码用得多
<a href="https://stackoverflow.com/questions/40514574/react-why-static-proptypes" target="_blank" rel="noopener noreferrer">reactjs - react: why static propTypes - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="何时单独用-xhr"><a href="#何时单独用-xhr" class="header-anchor">#</a> 何时单独用 xhr</h2> <p>跨域？不带 cookie？</p> <h2 id="immerjs-优于使用-lodash-创建拷贝"><a href="#immerjs-优于使用-lodash-创建拷贝" class="header-anchor">#</a> ImmerJS 优于使用 lodash 创建拷贝</h2> <ul><li>无需遍历，借用 proxy，仅针对变化的对象属性进行深拷贝
<a href="https://dev.to/sebastienlorber/insight-3-use-immerjs-over-lodash-set-immutablejs-or-plain-js-36bl" target="_blank" rel="noopener noreferrer">Insight #3 - Use ImmerJS over lodash/set, ImmutableJS or plain JS - DEV<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://redux-toolkit.js.org/introduction/quick-start" target="_blank" rel="noopener noreferrer">官方类似 dva 解决方案 Quick Start | Redux Toolkit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="竞速-race"><a href="#竞速-race" class="header-anchor">#</a> 竞速 race</h2> <ol><li>useRef 判断</li> <li>取消请求</li> <li>saga takeLatest</li> <li>建议硬编码增加请求延时，更容易复现和发现问题
<a href="https://dev.to/sebastienlorber/handling-api-request-race-conditions-in-react-4j5b" target="_blank" rel="noopener noreferrer">Handling API request race conditions in React - DEV<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://github.com/slorber/react-async-hook" target="_blank" rel="noopener noreferrer">slorber/react-async-hook: React hook to handle any async operation in React components<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <p>makeCancelable 为 promise 添加伪取消功能 <a href="https://reactjs.org/blog/2015/12/16/ismounted-antipattern.html" target="_blank" rel="noopener noreferrer">isMounted is an Antipattern – React Blog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="upload-drag-扩大区域"><a href="#upload-drag-扩大区域" class="header-anchor">#</a> upload drag 扩大区域</h2> <ul><li><code>:focue outline</code>浏览器原生样式，列表界面点击时出现 focus 样式并不合适</li> <li>非文件也能 drag
<a href="https://medium.com/@ralzohairi/how-to-drag-drop-html-elements-and-files-using-javascript-d31d15279369" target="_blank" rel="noopener noreferrer">How to Drag &amp; Drop HTML Elements and Files using Javascript | by Reema | Medium<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://codepen.io/tech_query/pen/MqGgap?editors=1000" target="_blank" rel="noopener noreferrer">DataTransfer test<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="定位代码最快方式"><a href="#定位代码最快方式" class="header-anchor">#</a> 定位代码最快方式</h2> <ol><li>react dev tools 组件名称</li> <li>css 类</li></ol> <p>数据流，从上到下传递，嵌套可能很深，找数据定义从上往下找</p> <h2 id="开发阶段-eslint-影响初期效率"><a href="#开发阶段-eslint-影响初期效率" class="header-anchor">#</a> 开发阶段 eslint 影响初期效率</h2> <ul><li>开发新功能初期，可能有很多临时代码</li> <li>可以对新文件，添加 eslint 忽略标记。后期再放开</li></ul> <h2 id="临时禁用-lint"><a href="#临时禁用-lint" class="header-anchor">#</a> 临时禁用 lint</h2> <div class="language- extra-class"><pre class="language-text"><code>// @ts-nocheck
/* eslint-disable */
</code></pre></div><h2 id="空数组约定"><a href="#空数组约定" class="header-anchor">#</a> 空数组约定</h2> <p>2.【强制】前后端数据列表相关的接口返回，如果为空，则返回空数组[]或空集合{}。说明：此条约定有利于数据层面上的协作更加高效，减少前端很多琐碎的 null 判断。</p> <p>https://github.com/alibaba/p3c/blob/master/Java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C%EF%BC%88%E5%B5%A9%E5%B1%B1%E7%89%88%EF%BC%89.pdf</p> <h2 id="map-key"><a href="#map-key" class="header-anchor">#</a> map key</h2> <p>要求：稳定，列表内惟一</p> <p>稳定是说一个页面操作内，保持稳定</p> <p>不指定 key 时，默认使用 index，index 存在不稳定</p> <p>内容 hash 不行，不惟一</p> <p>所以，只要提前生成一个惟一值就行。可以基于一个常量，累加生成 <code>key={genUniqKey()}</code></p> <h2 id="hmr-fast-refresh"><a href="#hmr-fast-refresh" class="header-anchor">#</a> HMR =&gt; Fast Refresh</h2> <p><a href="https://medium.com/javascript-in-plain-english/what-is-react-fast-refresh-f3d1e8401333" target="_blank" rel="noopener noreferrer">What is React Fast Refresh?. This library is going to change your… | by Mallik Cheripally | JavaScript In Plain English | Medium<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>存在问题：</p> <ul><li>有时变更后，刷新很慢</li> <li>出现错误后，需要手动刷新</li></ul> <h2 id="dan-note"><a href="#dan-note" class="header-anchor">#</a> dan note</h2> <p>react 中 props state 是不可变的（至少强烈建议如此）</p> <p>避免闭包的原因是很难思考一个值可以随着时间被改变</p> <p>Function components capture the rendered values.</p> <p>函数组件保持了触发请求时的 prop。可变 this 模拟 ref.current
而 class 会由于在请求中，重渲染，this 变化，读取最新的 prop。React 会改变 this</p> <p>In all cases I’ve seen so far, the “stale closures” problems happen due to a mistaken assumption that “functions don’t change” or that “props are always the same”. This is not the case, as I hope this post has helped to clarify.</p> <p>实际是因为闭包？
<a href="https://overreacted.io/how-are-function-components-different-from-classes/" target="_blank" rel="noopener noreferrer">How Are Function Components Different from Classes? — Overreacted<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Dan 介绍 hooks 提案，演示 class 与 hook 对比 context custom hook
<a href="https://www.youtube.com/watch?v=dpw9EHDh2bM" target="_blank" rel="noopener noreferrer">React Today and Tomorrow and 90% Cleaner React With Hooks - YouTube<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="constructor-里发请求"><a href="#constructor-里发请求" class="header-anchor">#</a> constructor 里发请求？</h2> <ol><li>应该设置初始 state，给用户替代状态，如 loading</li> <li>constructor 不能 async</li> <li>componentWillMount 废弃，开发者可能漏掉设置初始 state，以为 render 会等待，实际请求中会执行一次</li> <li>最佳实践，componentDidMount + isLoading，设置 isLoading 为 true 时，实际组件不会渲染</li></ol> <p><a href="https://daveceddia.com/where-fetch-data-componentwillmount-vs-componentdidmount/" target="_blank" rel="noopener noreferrer">Where to Fetch Data: componentWillMount vs componentDidMount<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://stackoverflow.com/questions/55182526/fetching-data-in-constructor" target="_blank" rel="noopener noreferrer">javascript - Fetching data in constructor - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zh-hans.reactjs.org/docs/faq-ajax.html" target="_blank" rel="noopener noreferrer">AJAX and APIs – React<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="自定义-tag"><a href="#自定义-tag" class="header-anchor">#</a> 自定义 Tag</h2> <p>字符模板 + 大写 + keyof</p> <p><a href="https://stackoverflow.com/questions/33471880/dynamic-tag-name-in-jsx-and-react" target="_blank" rel="noopener noreferrer">reactjs - Dynamic tag name in jsx and React - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="jsx-map-join-reduce"><a href="#jsx-map-join-reduce" class="header-anchor">#</a> jsx map join =&gt; reduce</h2> <p><a href="https://stackoverflow.com/questions/34034038/how-to-render-react-components-by-using-map-and-join" target="_blank" rel="noopener noreferrer">reactjs - how to render react components by using map and join - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="pages-重复渲染-尤其-audio-有动画明显"><a href="#pages-重复渲染-尤其-audio-有动画明显" class="header-anchor">#</a> pages 重复渲染，尤其 audio 有动画明显</h2> <p>14 MediaPiece.tsx:7 mediapiece render</p> <p>areEqual 从第二次渲染开始，意味着不能有卸载，父级哪层导致了卸载，拆出去的代码是否需要包括 map，需要，因为要检查数据入口，自上而下，分层控制</p> <p>如果整个列表都卸载了，key 无意义</p> <p>一层 map，使用 memo，仅修改项会 re-render</p> <div class="language- extra-class"><pre class="language-text"><code>key={genUniqKey()}
</code></pre></div><p>两层 map key item 写混，误以为 uniq key 生成有问题</p> <p>lodash uniqueId 生成位数个位数时，容易冲突</p> <p>检测父组件是否发生了卸载，也可以在 react dev tools 选中组件，如果组件卸载，选中会往父级跳</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child unmounted'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>组件定义嵌套时，memo 失效？</p> <p><a href="https://codesandbox.io/s/reactmemo-oi15s?file=/src/App.js" target="_blank" rel="noopener noreferrer">React.memo - CodeSandbox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>总结：</p> <ul><li>state 更新，组件并不会卸载，除非删除？</li> <li>memo 不能写到组件内 React Top-Level API，这个 level 实指 top level scope，官方文档译的顶层、不好理解</li> <li>memo 包裹的组件如果使用了 children props，会不 work</li> <li>key 里不要直接写函数，否则界面更新会执行</li></ul> <p>React 函数组件优化只做了两点：</p> <ol><li>state 浅比较，相等则不重渲染。所以不比较 prop？</li> <li>DOM 树只重渲染变化部分</li></ol> <h2 id="effect-相关函数处理"><a href="#effect-相关函数处理" class="header-anchor">#</a> effect 相关函数处理：</h2> <p>是否要把函数放入 effect 依赖数组，尽量避免</p> <ol><li>提升到组件外面</li> <li>移到 effect 内</li> <li>useCallback</li></ol> <p><a href="https://overreacted.io/a-complete-guide-to-useeffect/" target="_blank" rel="noopener noreferrer">A Complete Guide to useEffect — Overreacted<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://zhuanlan.zhihu.com/p/93824106" target="_blank" rel="noopener noreferrer">深入浅出 useSWR 原理 - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="modal-router"><a href="#modal-router" class="header-anchor">#</a> modal router</h2> <p>在 modal withRouter 不行， 传不到子组件</p> <h2 id="鼠标进入触发-lottie"><a href="#鼠标进入触发-lottie" class="header-anchor">#</a> 鼠标进入触发 lottie</h2> <p>mouseHover 没有</p> <p>mouseOver 不行</p> <p>mouseEnter / mouseLeave</p> <p>解决误触，debounse 不行，延迟但还是会执行，throttle 也不行，因为 enter 触发并不频繁</p> <p>通用解决方案：为调用增加延时，当误触发生时取消延时，hover 够久时正常调用</p> <p>子组件 render 问题，有外在表现组件容易显现出来，如动画、发请求，否则就要打 log 才能看出来</p> <p>el 绑定，用自定义 id 即可。不需要实时 Dom，因此没必要用 ref</p> <p>翻页集中 setState，否则可能多次渲染，原因是先设置了 index，然后又设置 data</p> <h2 id="antd-table"><a href="#antd-table" class="header-anchor">#</a> antd table</h2> <ul><li>data 不需要 concat, 无限加载才需要</li> <li>弹窗表格优化<div class="language-css extra-class"><pre class="language-css"><code>// 小屏
<span class="token atrule"><span class="token rule">@media</span> <span class="token punctuation">(</span><span class="token property">max-height</span><span class="token punctuation">:</span> 800px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
  <span class="token selector">.ant-modal</span> <span class="token punctuation">{</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 固定高度内滚动</span>
scroll<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> y<span class="token operator">:</span> clientHeight <span class="token operator">-</span> <span class="token number">450</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="state-派生自-prop-组件内又修改-state"><a href="#state-派生自-prop-组件内又修改-state" class="header-anchor">#</a> state 派生自 prop，组件内又修改 state</h2> <p>数据变更源成了两个，增加了数据意外变化定位难度</p> <p>是否能通过通知父组件更新数据</p> <h2 id="第二层弹窗问题"><a href="#第二层弹窗问题" class="header-anchor">#</a> 第二层弹窗问题</h2> <p>用了 absolute，需要计算容器高度</p> <p>将一层内容 hide，并改将二层内容用 transfrom 移动到目标位置</p> <h2 id="redux-dev-tool-crash"><a href="#redux-dev-tool-crash" class="header-anchor">#</a> redux dev tool crash</h2> <p><a href="https://github.com/reduxjs/redux-devtools/issues/643#issuecomment-697398278" target="_blank" rel="noopener noreferrer">&quot;redux-devtools-extension&quot; gets laggy and eventually crashes when I try to open it. · Issue #643 · reduxjs/redux-devtools<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="无效组件"><a href="#无效组件" class="header-anchor">#</a> 无效组件</h2> <p>不能是 object，有的没有 props.children</p> <p>暂时用 组件 map</p> <p>可以打印出来，检查是否正确</p> <blockquote><p>Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object. #13445
元素类型，有两种，内置组件 string，合成组件 class/function</p></blockquote> <p>组件不能是 el，需要是函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> CompanyIconInHeader <span class="token operator">=</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>y<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>

<span class="token comment">// wrong use</span>
<span class="token punctuation">;</span><span class="token operator">&lt;</span>CompanyIconInHeader <span class="token operator">/</span><span class="token operator">&gt;</span>

<span class="token comment">// right</span>
<span class="token keyword">const</span> <span class="token function-variable function">CompanyIconInHeader</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>y<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
</code></pre></div><h2 id="点击文本复制"><a href="#点击文本复制" class="header-anchor">#</a> 点击文本复制</h2> <p>react wrapper 引入问题</p> <p>browser api 兼容性，需要请求权限</p> <div class="language- extra-class"><pre class="language-text"><code>import copy from 'copy-to-clipboard';
</code></pre></div><h2 id="半受控-props-变化-需要更新部分-state"><a href="#半受控-props-变化-需要更新部分-state" class="header-anchor">#</a> 半受控，props 变化，需要更新部分 state</h2> <p>硬重置（不推荐、但可救急）</p> <div class="language- extra-class"><pre class="language-text"><code>componentDidUpdate
  this.setState({ ..._.cloneDeep(defaultStates) }, () =&gt; {
</code></pre></div><p>v15 componentWillReceiveProps or componentDidUpdate + setState
v16 getDerivedStateFromProps</p> <p>反模式：受控与非受控混合</p> <p>官方建议：</p> <ol><li>完全受控，数据提升</li> <li>完全不受控，用 key 控制更新</li></ol> <h2 id="缓存计算"><a href="#缓存计算" class="header-anchor">#</a> 缓存计算</h2> <p>类 Vue computed，场景高开销计算，入参作为依赖，缓存最后一次计算值</p> <p>memoize-one
<a href="https://juejin.cn/post/6844903894061940750" target="_blank" rel="noopener noreferrer">memoize-one 在 React 中的应用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>拓展：斐波那契数列</p> <h2 id="ripple-btn"><a href="#ripple-btn" class="header-anchor">#</a> ripple btn</h2> <div class="language- extra-class"><pre class="language-text"><code>demo a&gt;text
antd button&gt;span text
</code></pre></div><p>多个 span 标签，导致事件 target 会变，当 target 为 span 时，计算坐标有误</p> <p>span antd 有设置 absolute</p> <h2 id="跨组件引用可变对象"><a href="#跨组件引用可变对象" class="header-anchor">#</a> 跨组件引用可变对象</h2> <ul><li>多个修改源</li> <li>深层数据变了，引用没变</li></ul> <h2 id="webpack-cpu占用高"><a href="#webpack-cpu占用高" class="header-anchor">#</a> webpack CPU占用高</h2> <p>在 MacOS Catalina 中，Vue 项目在运行 node run dev 时，webpack server 会调用 fsevents 模块进行监控文件变化。如果没有这个模块，就会一直遍历所有的文件。</p> <p>https://www.jianshu.com/p/f7769e01aa9c</p> <h2 id="表格踩坑-最佳实践"><a href="#表格踩坑-最佳实践" class="header-anchor">#</a> 表格踩坑，最佳实践</h2> <p>查询参数和分页，应该用一个 state，合并更新 query</p> <p>这么写，会有冲突，比如筛选重置同时回第一页</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">fetchList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>curQuery<span class="token punctuation">,</span> pagination<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="url-hash-变化-如何更新页面"><a href="#url-hash-变化-如何更新页面" class="header-anchor">#</a> URL hash 变化，如何更新页面</h2> <p><a href="https://stackoverflow.com/questions/48139281/react-doesnt-reload-component-data-on-route-param-change-or-query-change" target="_blank" rel="noopener noreferrer">javascript - React doesn't reload component data on route param change or query change - Stack Overflow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frameworks/next.html" class="prev">
        Next
      </a></span> <span class="next"><a href="/frameworks/react-native.html">
        React Native
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.882ec4c8.js" defer></script><script src="/assets/js/2.06ded020.js" defer></script><script src="/assets/js/35.912d3cb8.js" defer></script><script src="/assets/js/4.8f3f44ca.js" defer></script>
  </body>
</html>
