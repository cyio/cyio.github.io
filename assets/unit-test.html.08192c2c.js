import{_ as c,r as i,o as r,c as p,a as n,b as s,w as a,F as u,d as e,e as l}from"./app.81142736.js";const d={},h=n("h1",{id:"\u5355\u5143\u6D4B\u8BD5",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5355\u5143\u6D4B\u8BD5","aria-hidden":"true"},"#"),e(" \u5355\u5143\u6D4B\u8BD5")],-1),b={class:"table-of-contents"},m=e("\u5173\u4E8E"),_=e("why"),g=e("how"),k=e("\u4E0E\u7AEF\u5230\u7AEF\u6D4B\u8BD5\u6BD4\u8F83"),f=e("Jest"),v=e("eslint"),x=e("\u8FD0\u884C\u6D4B\u8BD5"),w=e("\u6D4B\u8BD5\u4E00\u4E2A\u6587\u4EF6"),j=e("\u6D4B\u8BD5\u8986\u76D6\u7387"),y=e("\u5E38\u7528\u65AD\u8A00"),T=e("timer mock / \u5F02\u6B65\u4EE3\u7801"),E=e("Vue \u7EC4\u4EF6\u6D4B\u8BD5"),q=l('<h2 id="\u5173\u4E8E" tabindex="-1"><a class="header-anchor" href="#\u5173\u4E8E" aria-hidden="true">#</a> \u5173\u4E8E</h2><h3 id="why" tabindex="-1"><a class="header-anchor" href="#why" aria-hidden="true">#</a> why</h3><ul><li>\u5C3D\u65E9\u53D1\u73B0\u4EE3\u7801\u7F3A\u9677\uFF0C\u63D0\u9AD8\u4EE3\u7801\u8D28\u91CF</li><li>\u6709\u4FE1\u5FC3\u5730\u91CD\u6784\u4EE3\u7801</li></ul><h3 id="how" tabindex="-1"><a class="header-anchor" href="#how" aria-hidden="true">#</a> how</h3><ul><li>\u6210\u672C\u6536\u76CA\u6743\u8861\uFF0C\u91C7\u7528\u54EA\u79CD\u6D4B\u8BD5\uFF1F</li></ul><h2 id="\u4E0E\u7AEF\u5230\u7AEF\u6D4B\u8BD5\u6BD4\u8F83" tabindex="-1"><a class="header-anchor" href="#\u4E0E\u7AEF\u5230\u7AEF\u6D4B\u8BD5\u6BD4\u8F83" aria-hidden="true">#</a> \u4E0E\u7AEF\u5230\u7AEF\u6D4B\u8BD5\u6BD4\u8F83</h2><table><thead><tr><th></th><th>Unit/Integration</th><th>E2E</th></tr></thead><tbody><tr><td>\u8303\u56F4</td><td>\u6700\u5C0F\u53EF\u6D4B\u8BD5\u5355\u5143/\u5355\u5143\u96C6\u6210</td><td>\u6574\u4F53</td></tr><tr><td>\u73AF\u5883</td><td>Node</td><td>Browser</td></tr><tr><td>\u6846\u67B6</td><td>Jest/Mocha</td><td>Cypress/Nightwatch</td></tr><tr><td>\u7F16\u5199\u89D2\u8272</td><td>\u5F00\u53D1</td><td>\u6D4B\u8BD5</td></tr><tr><td>\u4F18\u70B9</td><td>\u5BB9\u6613\u7F16\u5199\uFF0C\u9694\u79BB\uFF0C\u4FBF\u4E8E\u5B9A\u4F4D\u4FEE\u590D</td><td>\u6A21\u62DF\u7528\u6237\u3001\u771F\u5B9E</td></tr><tr><td>\u7F3A\u70B9</td><td>\u65E0\u6CD5\u4FDD\u8BC1\u6574\u4F53\u5DE5\u4F5C\u5982\u4F55</td><td>\u7F16\u5199\u3001\u7EF4\u62A4\u6210\u672C\u9AD8\uFF0C\u53CD\u9988\u6EDE\u540E</td></tr></tbody></table><p><img src="https://2.bp.blogspot.com/-YTzv_O4TnkA/VTgexlumP1I/AAAAAAAAAJ8/57-rnwyvP6g/s1600/image02.png" alt="\u6D4B\u8BD5\u91D1\u5B57\u5854"></p><blockquote><p>\u4F60\u5E94\u8BE5\u7784\u51C6\u4EE5\u4E0B\u91D1\u5B57\u5854\uFF0C\u4E3B\u8981\u5173\u6CE8\u5355\u5143\u548C\u96C6\u6210\u6D4B\u8BD5\uFF0C70/20/10</p></blockquote><blockquote><p>\u5355\u5143\u6D4B\u8BD5\u662F\u8F7B\u91CF\u7EA7\u7684\uFF0C\u65E8\u5728\u5355\u72EC\u68C0\u67E5\u7CFB\u7EDF\u7684\u7279\u5B9A\u529F\u80FD/\u7EC4\u4EF6 - \u5B83\u4EEC\u5E94\u8BE5\u5F88\u5FEB\u5E76\u4E14\u4E3A\u60A8\u63D0\u4F9B\u5373\u65F6\u4E14\u975E\u5E38\u5177\u4F53\u7684\u53CD\u9988 - \u4EE3\u7801\u4E2D\u7684\u54EA\u4E00\u884C\u53D1\u751F\u9519\u8BEF\uFF0C\u51FA\u73B0\u4E86 \u4EC0\u4E48\u95EE\u9898\u3002</p></blockquote><blockquote><p>\u53E6\u4E00\u65B9\u9762\uFF0C\u7AEF\u5230\u7AEF\u6D4B\u8BD5\u5DE5\u4F5C\u66F4\u9AD8\u5C42\u6B21 - \u4ECE\u7528\u6237\u7684\u89D2\u5EA6\u68C0\u67E5\u6574\u4E2A\u5E94\u7528\u7A0B\u5E8F\uFF0C\u6240\u6709\u79FB\u52A8\u90E8\u4EF6\u534F\u540C\u5DE5\u4F5C\u3002 \u5F53 e2e \u6D4B\u8BD5\u5931\u8D25\u6CA1\u6709\u7ED9\u51FA\u5173\u4E8E\u51FA\u9519\u7684\u5730\u65B9\uFF0C\u5BFC\u81F4\u5931\u8D25 \u7684\u5730\u70B9\u548C\u539F\u56E0\u7684\u4FE1\u606F\u65F6\uFF0C\u8FD9\u79CD\u60C5\u51B5\u5F88\u5E38\u89C1\u3002</p></blockquote><blockquote><p>\u4E00\u4E2A\u6807\u51C6\u7684\u4E92\u8054\u7F51\u5E94\u7528\u4EA7\u54C1\u7684\u524D\u7AEF\u90E8\u5206\uFF0C\u6211\u7C97\u7565\u4F30\u8BA1\u5927\u6982\u6709 20%\u7684\u4E1A\u52A1\u57FA\u7840\u4EE3\u7801\u6BD4\u8F83\u7A33\u5B9A\uFF0C\u6BD4\u5982\u901A\u7528\u7EC4\u4EF6\u3001\u901A\u7528\u7B97\u6CD5\u548C\u6570\u636E\u6A21\u5757\u7B49\uFF0C\u53EF\u4EE5\u9488\u5BF9\u8FD9\u4E9B\u5EFA\u7ACB \u590D\u6742\u4E00\u4E9B\u7684 API \u548C GUI \u6D4B\u8BD5\u7528\u4F8B\u6765\u4FDD\u8BC1\u8D28\u91CF\u3002\u5269\u4E0B 80%\u7684\u90E8\u5206\u4E0D\u662F\u5F88\u7A33\u5B9A\uFF0C\u6BCF\u5929\u90FD\u5728\u8FED\u4EE3\uFF0C\u9488\u5BF9\u4ED6\u4EEC\u7EF4\u62A4 case \u7684\u6210\u672C\u975E\u5E38\u9AD8\u3002\u76EE\u524D\u4E1A\u754C\u4E2D\u53F7\u79F0\u505A\u4E86 \u81EA\u52A8\u5316\u6D4B\u8BD5\u7684\u9879\u76EE\uFF0C\u4E5F\u5927\u591A\u662F\u5728\u505A\u90A3\u7A33\u5B9A\u7684 20%\u3002</p></blockquote><blockquote><ul><li>Unit test: Test classes</li><li>Integration test: Test component (class + template) using ComponentFixture</li><li>E2E: Mimic user inputs using Protractor and Selenium</li></ul></blockquote>',13),A={href:"https://cli.vuejs.org/config/#unit-testing",target:"_blank",rel:"noopener noreferrer"},V=e("Configuration Reference | Vue CLI 3"),B={href:"https://softwareengineering.stackexchange.com/questions/198918/end-to-end-tests-versus-unit-tests-should-tests-be-decoupled",target:"_blank",rel:"noopener noreferrer"},I=e("tdd - End-to-end tests versus unit tests, should tests be decoupled? - Software Engineering Stack Exchange"),C={href:"https://testing.googleblog.com/2015/04/just-say-no-to-more-end-to-end-tests.html",target:"_blank",rel:"noopener noreferrer"},N=e("Google Testing Blog: Just Say No to More End-to-End Tests"),S=l(`<h2 id="jest" tabindex="-1"><a class="header-anchor" href="#jest" aria-hidden="true">#</a> Jest</h2><h3 id="eslint" tabindex="-1"><a class="header-anchor" href="#eslint" aria-hidden="true">#</a> eslint</h3><p>\u5728 <code>.eslintrc.js</code> \u589E\u52A0</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>env
  jest: true,
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u5426\u5219\u4F1A\u6709 lint \u9519\u8BEF\uFF0C\u5982<code>it</code>\u672A\u58F0\u660E</p><h3 id="\u8FD0\u884C\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u8FD0\u884C\u6D4B\u8BD5" aria-hidden="true">#</a> \u8FD0\u884C\u6D4B\u8BD5</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> unit / jest
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u6D4B\u8BD5\u4E00\u4E2A\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u4E00\u4E2A\u6587\u4EF6" aria-hidden="true">#</a> \u6D4B\u8BD5\u4E00\u4E2A\u6587\u4EF6</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> unit tests/unit/modal.spec.js
<span class="token function">yarn</span> unit --watch tests/unit/modal.spec.js
<span class="token function">yarn</span> unit --watch --debug tests/unit/modal.spec.js
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="\u6D4B\u8BD5\u8986\u76D6\u7387" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u8986\u76D6\u7387" aria-hidden="true">#</a> \u6D4B\u8BD5\u8986\u76D6\u7387</h3><ul><li>\u6536\u96C6</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>--<span class="token punctuation">[</span>coverage<span class="token operator">|</span>collectCoverage<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>\u7EDF\u8BA1\u8303\u56F4</li></ul><p>\u767D\u540D\u5355</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>collectCoverageFrom [array]
Default: undefined
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u9ED1\u540D\u5355</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>coveragePathIgnorePatterns [array]
Default: [&quot;/node_modules/&quot;]
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u5339\u914D\u5230\u7684\u6587\u4EF6\uFF0C\u5373\u4F7F\u6CA1\u5199\u6D4B\u8BD5\uFF0C\u4E5F\u4F1A\u53C2\u4E0E\u7EDF\u8BA1</p><p>\u9ED8\u8BA4\u4F1A\u6536\u96C6\u5168\u90E8 JS\uFF1F</p><h3 id="\u5E38\u7528\u65AD\u8A00" tabindex="-1"><a class="header-anchor" href="#\u5E38\u7528\u65AD\u8A00" aria-hidden="true">#</a> \u5E38\u7528\u65AD\u8A00</h3><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">isVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">props</span><span class="token punctuation">(</span><span class="token string">&#39;show&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">emitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>close<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// toBeTruthy if \u8BED\u53E5\u4E3A\u771F</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="timer-mock-\u5F02\u6B65\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#timer-mock-\u5F02\u6B65\u4EE3\u7801" aria-hidden="true">#</a> timer mock / \u5F02\u6B65\u4EE3\u7801</h3><ol><li><p><code>done</code> \u663E\u5F0F\u6307\u5B9A\u6D4B\u8BD5\u7ED3\u675F\uFF0Cajax\u3001vuex action \u5728 nextTick \u91CC\u65AD\u8A00</p><p>\u6CE8\u610F\uFF0Cdone \u9700\u8981\u8C03\u7528\uFF0C\u5426\u5219\u4F1A\u63D0\u793A\u4E00\u4E2A timeout \u9519\u8BEF</p></li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">beforeAll</span><span class="token punctuation">(</span><span class="token punctuation">(</span>done <span class="token comment">/* call it or remove it*/</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// calling it</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li><code>jest.useFakeTimers()</code>\u539F\u751F\u5B9A\u65F6\u5668\u529F\u80FD\u4F9D\u8D56<strong>\u771F\u5B9E</strong>\u65F6\u95F4\uFF0C\u6D4B\u8BD5\u9700\u8981\u63A7\u5236\u65F6\u95F4\uFF0C\u5047\u65F6\u95F4</li><li><code>jest.runAllTimers();</code>\u6267\u884C\u5FAE\u4EFB\u52A1\u961F\u5217\uFF0C<strong>\u5FEB\u8FDB</strong>\u76F4\u5230\u6240\u6709\u5B9A\u65F6\u5668\u6267\u884C</li><li>promise/await</li></ol><h2 id="vue-\u7EC4\u4EF6\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#vue-\u7EC4\u4EF6\u6D4B\u8BD5" aria-hidden="true">#</a> Vue \u7EC4\u4EF6\u6D4B\u8BD5</h2>`,26),J={href:"https://vue-test-utils.vuejs.org/zh/api/wrapper/#%25E5%25B1%259E%25E6%2580%25A7",target:"_blank",rel:"noopener noreferrer"},P=e("Wrapper | Vue Test Utils"),F={href:"https://github.com/facebook/jest/issues/3211#issuecomment-289276061",target:"_blank",rel:"noopener noreferrer"},L=e("setTimeout not triggering when unit testing \xB7 Issue #3211 \xB7 facebook/jest"),z={href:"https://github.com/azl397985856/automate-everything/blob/master/docs/chapter6.md",target:"_blank",rel:"noopener noreferrer"},U=e("\u5230\u5904\u90FD\u662F\u6D4B\u8BD5 automate-everything/chapter6.md at master \xB7 azl397985856/automate-everything"),M={href:"https://vuedose.tips/tips/quick-content-testing-using-snapshots-in-vue-js/",target:"_blank",rel:"noopener noreferrer"},R=e("Quick Content Testing using Snapshots in Vue.js");function D(G,O){const t=i("RouterLink"),o=i("ExternalLinkIcon");return r(),p(u,null,[h,n("nav",b,[n("ul",null,[n("li",null,[s(t,{to:"#\u5173\u4E8E"},{default:a(()=>[m]),_:1}),n("ul",null,[n("li",null,[s(t,{to:"#why"},{default:a(()=>[_]),_:1})]),n("li",null,[s(t,{to:"#how"},{default:a(()=>[g]),_:1})])])]),n("li",null,[s(t,{to:"#\u4E0E\u7AEF\u5230\u7AEF\u6D4B\u8BD5\u6BD4\u8F83"},{default:a(()=>[k]),_:1})]),n("li",null,[s(t,{to:"#jest"},{default:a(()=>[f]),_:1}),n("ul",null,[n("li",null,[s(t,{to:"#eslint"},{default:a(()=>[v]),_:1})]),n("li",null,[s(t,{to:"#\u8FD0\u884C\u6D4B\u8BD5"},{default:a(()=>[x]),_:1})]),n("li",null,[s(t,{to:"#\u6D4B\u8BD5\u4E00\u4E2A\u6587\u4EF6"},{default:a(()=>[w]),_:1})]),n("li",null,[s(t,{to:"#\u6D4B\u8BD5\u8986\u76D6\u7387"},{default:a(()=>[j]),_:1})]),n("li",null,[s(t,{to:"#\u5E38\u7528\u65AD\u8A00"},{default:a(()=>[y]),_:1})]),n("li",null,[s(t,{to:"#timer-mock-\u5F02\u6B65\u4EE3\u7801"},{default:a(()=>[T]),_:1})])])]),n("li",null,[s(t,{to:"#vue-\u7EC4\u4EF6\u6D4B\u8BD5"},{default:a(()=>[E]),_:1})])])]),q,n("p",null,[n("a",A,[V,s(o)]),n("a",B,[I,s(o)]),n("a",C,[N,s(o)])]),S,n("p",null,[n("a",J,[P,s(o)])]),n("p",null,[n("a",F,[L,s(o)]),n("a",z,[U,s(o)]),n("a",M,[R,s(o)])])],64)}var W=c(d,[["render",D],["__file","unit-test.html.vue"]]);export{W as default};
