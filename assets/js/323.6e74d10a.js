(window.webpackJsonp=window.webpackJsonp||[]).push([[323],{764:function(t,a,s){"use strict";s.r(a);var e=s(56),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"dom"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom"}},[t._v("#")]),t._v(" DOM")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#遍历"}},[t._v("遍历")])]),s("li",[s("a",{attrs:{href:"#性能"}},[t._v("性能")]),s("ul",[s("li",[s("a",{attrs:{href:"#优化"}},[t._v("优化")])])])]),s("li",[s("a",{attrs:{href:"#api"}},[t._v("API")])]),s("li",[s("a",{attrs:{href:"#脚本"}},[t._v("脚本")])]),s("li",[s("a",{attrs:{href:"#注意点"}},[t._v("注意点")])]),s("li",[s("a",{attrs:{href:"#重绘和回流"}},[t._v("重绘和回流")]),s("ul",[s("li",[s("a",{attrs:{href:"#样式计算"}},[t._v("样式计算")])])])]),s("li",[s("a",{attrs:{href:"#innerhtml"}},[t._v("innerHTML")])]),s("li",[s("a",{attrs:{href:"#tag-标签只用小写"}},[t._v("tag 标签只用小写")])]),s("li",[s("a",{attrs:{href:"#观察-dom-更新"}},[t._v("观察 DOM 更新")])]),s("li",[s("a",{attrs:{href:"#页面插入-dom-几种方式"}},[t._v("页面插入 dom 几种方式")])]),s("li",[s("a",{attrs:{href:"#dom-选择"}},[t._v("DOM 选择")])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"遍历"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#遍历"}},[t._v("#")]),t._v(" 遍历")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("关系：父子、相邻，首尾")])]),t._v(" "),s("li",[s("p",[t._v("区分 Element (Node) 和 Node，node 包含了 textNode、commentNode、空 等")]),t._v(" "),s("p",[t._v("childNodes vs children(Element)")])]),t._v(" "),s("li",[s("p",[t._v("集合，类数组")]),t._v(" "),s("p",[s("code",[t._v("for of")]),t._v(" "),s("code",[t._v("Array.from")])])])]),t._v(" "),s("h2",{attrs:{id:"性能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#性能"}},[t._v("#")]),t._v(" 性能")]),t._v(" "),s("p",[t._v("简述，为什么 DOM 操作影响性能？\n因为某些情况 NodeList 对象是动态的，每次访问 NodeList 对象，都会运行一次查询。")]),t._v(" "),s("blockquote",[s("p",[t._v("理解 DOM 的关键，就是理解 DOM 对性能的影响。DOM 操作往往是 JavaScript 程序中开销最大的部分，而因访问 NodeList 导致的问题\n为最多。NodeList 对象都是“动态的”，这就意味着每次访问 NodeList 对象，都会运行一次查询。所以应减少对 NodeList 的访问，对 DOM 的操作。")])]),t._v(" "),s("p",[t._v("https://developer.mozilla.org/en-US/docs/Web/API/NodeList")]),t._v(" "),s("h3",{attrs:{id:"优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优化"}},[t._v("#")]),t._v(" 优化")]),t._v(" "),s("p",[s("code",[t._v("document.createDocumentFragment")]),t._v(" "),s("a",{attrs:{href:"https://www.jianshu.com/p/7628670a94e6",target:"_blank",rel:"noopener noreferrer"}},[t._v("DocumentFragment - 简书"),s("OutboundLink")],1)]),t._v(" "),s("ul",[s("li",[t._v("文档片段，不属于文档树，用于占位")]),t._v(" "),s("li",[t._v("继承了 Node 方法")])]),t._v(" "),s("h2",{attrs:{id:"api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),s("p",[t._v("常用方法：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write\ndocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("writeln "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 换行")]),t._v("\ndiv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAttribute")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'title'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或者 div.title")]),t._v("\n")])])]),s("p",[s("code",[t._v("[ele].insertAdjacentHTML([position], [html])")]),t._v(" 邻接插入，比 innerHTML 效率高")]),t._v(" "),s("h2",{attrs:{id:"脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚本"}},[t._v("#")]),t._v(" 脚本")]),t._v(" "),s("ul",[s("li",[t._v("问题：当用户鼠标移动够快时，积累在 setTimeout 队列里的事件会导致动画效果产生滞后。\n解决：将目标元素与事件绑定，以便清除。")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("moveElement")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("elementID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" final_y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" interval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" elem "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elementID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("movement"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("clearTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("movement"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" repeat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"moveElement(\'"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("elementID"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"', '\"")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("final_x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"', '\"")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("final_y"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"', '\"")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("interval"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\')"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// element.property = value")]),t._v("\n    elem"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("movement "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("repeat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" interval"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("步进为 1px 时太慢了，如何解决？")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每次向目标位置移动1px，执行条件是尚未到达")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xpos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" final_x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  xpos"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("根据距离提高步进，每次前进距离的十分之一，距离小于 10px 时，dist 向上取整，按 1px 步进。")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("dist "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Math"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ceil")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("final_x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" xpos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nxpos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xpos "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" dist\n")])])]),s("h2",{attrs:{id:"注意点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意点"}},[t._v("#")]),t._v(" 注意点")]),t._v(" "),s("ul",[s("li",[t._v("focus blur 事件只会在 input textaera select 等键盘元素上发生")])]),t._v(" "),s("h2",{attrs:{id:"重绘和回流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重绘和回流"}},[t._v("#")]),t._v(" 重绘和回流")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("重绘，样式变化，浏览器重新绘制样式")]),t._v(" "),s("p",[t._v("paint 样式")])]),t._v(" "),s("li",[s("p",[t._v("回流，尺寸、位置、属性变化，浏览器重新渲染部分或全部")]),t._v(" "),s("p",[t._v("flow 布局 性能影响更大")])])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://gist.github.com/faressoft/36cdd64faae21ed22948b458e6bf04d5",target:"_blank",rel:"noopener noreferrer"}},[t._v("DOM Performance (Reflow & Repaint) (Summary)"),s("OutboundLink")],1)]),t._v(" "),s("ul",[s("li",[t._v("优化策略1：合并操作 class/documentFragment")]),t._v(" "),s("li",[t._v("优化策略2：用重绘属性代替回流属性\n"),s("ul",[s("li",[t._v("transform 代替 top/left")]),t._v(" "),s("li",[t._v("opacity 替代 visibility")])])]),t._v(" "),s("li",[t._v("多个 DOM 统一操作（虽然V8会有缓存优化）")]),t._v(" "),s("li",[t._v("先将 DOM 离线，即display：none；修改后显示")]),t._v(" "),s("li",[t._v("不要把 DOM 放在已给循环中作为循环变量")]),t._v(" "),s("li",[t._v("不要使用 table")])]),t._v(" "),s("h3",{attrs:{id:"样式计算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#样式计算"}},[t._v("#")]),t._v(" 样式计算")]),t._v(" "),s("ul",[s("li",[t._v("50% 时间匹配选择器，引起页面或局部重新布局，reflow")]),t._v(" "),s("li",[t._v("降低选择器的复杂性；使用以类为中心的方法，例如 BEM。选择器合并，少用选择规则")]),t._v(" "),s("li",[t._v("减少必须计算其样式的元素数量，如在 body 上操作，所有后代可能要重算\n"),s("a",{attrs:{href:"https://developers.google.com/web/fundamentals/performance/rendering/reduce-the-scope-and-complexity-of-style-calculations",target:"_blank",rel:"noopener noreferrer"}},[t._v("缩小样式计算的范围并降低其复杂性  |  Web  |  Google Developers"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://juejin.im/post/5c009115f265da612859d8e2",target:"_blank",rel:"noopener noreferrer"}},[t._v("chrome devtools 使用详解——Performance - 掘金"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Get Started With Analyzing Runtime Performance  |  Tools for Web Developers  |  Google Developers"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"innerhtml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#innerhtml"}},[t._v("#")]),t._v(" innerHTML")]),t._v(" "),s("p",[t._v("当读取"),s("code",[t._v("innerHTML")]),t._v("时，HTML 已经被解析为 DOM 并丢弃，标签会被转换为小写，有的浏览器还不一样，因此拿不到原始的 HTML")]),t._v(" "),s("h2",{attrs:{id:"tag-标签只用小写"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tag-标签只用小写"}},[t._v("#")]),t._v(" tag 标签只用小写")]),t._v(" "),s("p",[t._v("多个词用短杠连接，大小写不敏感，内部会转为小写？为了保证转换一致性，最好用小写。Vue 的组件在 HTML 中用的都是小写")]),t._v(" "),s("h2",{attrs:{id:"观察-dom-更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#观察-dom-更新"}},[t._v("#")]),t._v(" 观察 DOM 更新")]),t._v(" "),s("p",[t._v("DOM- MutationObserver\n"),s("a",{attrs:{href:"https://codepen.io/dayvidwhy/pen/egdZyY?editors=1011",target:"_blank",rel:"noopener noreferrer"}},[t._v("MutationObserver Example"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("vue - update")]),t._v(" "),s("h2",{attrs:{id:"页面插入-dom-几种方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面插入-dom-几种方式"}},[t._v("#")]),t._v(" 页面插入 dom 几种方式")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("createElement")]),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("const div = document.createElement('div') \ndiv.innerHTML = `\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("global-page-close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onclick")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("window.close()"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n` \ndocument.body.appendChild(div)\n")])])])]),t._v(" "),s("li",[s("code",[t._v("document.createDocumentFragment")]),t._v(" 不支持 innerHTML")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/wesbos/es6-articles/blob/master/13%2520-%2520Creating%2520HTML%2520fragments%2520with%2520Template%2520Literals.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("es6-articles/13 - Creating HTML fragments with Template Literals.md at master · wesbos/es6-articles"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"dom-选择"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom-选择"}},[t._v("#")]),t._v(" DOM 选择")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://eloquentjavascript.net/img/html-links.svg",alt:"节点关系示意图"}})]),t._v(" "),s("p",[t._v("参考：\n"),s("a",{attrs:{href:"https://plainjs.com/javascript/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Plain JavaScript - Functions and Helpers"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"http://domenlightenment.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("DOM Enlightenment - Exploring the relationship between JavaScript and the modern HTML DOM"),s("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);