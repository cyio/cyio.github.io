(window.webpackJsonp=window.webpackJsonp||[]).push([[330],{759:function(t,a,s){"use strict";s.r(a);var e=s(57),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"图片"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片"}},[t._v("#")]),t._v(" 图片")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#显示优化"}},[t._v("显示优化")])]),s("li",[s("a",{attrs:{href:"#图片格式"}},[t._v("图片格式")]),s("ul",[s("li",[s("a",{attrs:{href:"#不同格式适用场景"}},[t._v("不同格式适用场景")])])])]),s("li",[s("a",{attrs:{href:"#响应式展示"}},[t._v("响应式展示")])]),s("li",[s("a",{attrs:{href:"#占位图工具"}},[t._v("占位图工具")])]),s("li",[s("a",{attrs:{href:"#h2-lazy"}},[t._v("h2 lazy")])]),s("li",[s("a",{attrs:{href:"#lazy-load"}},[t._v("lazy load")])]),s("li",[s("a",{attrs:{href:"#webp"}},[t._v("webp")])]),s("li",[s("a",{attrs:{href:"#高清图"}},[t._v("高清图")])]),s("li",[s("a",{attrs:{href:"#图片压缩"}},[t._v("图片压缩")]),s("ul",[s("li",[s("a",{attrs:{href:"#表单图片压缩"}},[t._v("表单图片压缩")])]),s("li",[s("a",{attrs:{href:"#在线压缩"}},[t._v("在线压缩")])]),s("li",[s("a",{attrs:{href:"#本地手动压缩"}},[t._v("本地手动压缩")])]),s("li",[s("a",{attrs:{href:"#工具压缩-gulp"}},[t._v("~~工具压缩 gulp~~")])])])]),s("li",[s("a",{attrs:{href:"#图片预览"}},[t._v("图片预览")])]),s("li",[s("a",{attrs:{href:"#处理上传"}},[t._v("处理上传")])]),s("li",[s("a",{attrs:{href:"#avif"}},[t._v("AVIF")])]),s("li",[s("a",{attrs:{href:"#保存比例"}},[t._v("保存比例")])]),s("li",[s("a",{attrs:{href:"#图片压缩原理"}},[t._v("图片压缩原理")])]),s("li",[s("a",{attrs:{href:"#优化思路"}},[t._v("优化思路")])])])]),s("p"),t._v(" "),s("blockquote",[s("p",[t._v("web 优化专家一定是图片优化专家")])]),t._v(" "),s("h2",{attrs:{id:"显示优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#显示优化"}},[t._v("#")]),t._v(" 显示优化")]),t._v(" "),s("ul",[s("li",[t._v("缩略图到原图过渡")])]),t._v(" "),s("p",[s("a",{attrs:{href:"http://www.fly63.com/article/detial/359",target:"_blank",rel:"noopener noreferrer"}},[t._v("web 前端图片加载优化，从图片模糊到清晰的实现过程"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"图片格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片格式"}},[t._v("#")]),t._v(" 图片格式")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("WebP 有损、无损，30% 体积优势")])]),t._v(" "),s("li",[s("p",[t._v("APNG 质量、大小较 GIF 均有优势，移动端可放心用，桌面端需要兼容 IE/EDGE，可用 JS 库播放 APNG")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/37160029",target:"_blank",rel:"noopener noreferrer"}},[t._v("UC 内核支持更好的动画格式-APNG"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.oschina.net/question/3915715_2283697",target:"_blank",rel:"noopener noreferrer"}},[t._v("全面掌握移动端主流图片格式的特点、性能、调优等 - 开源中国社区"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"http://littlesvr.ca/apng/gif_apng_webp.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("GIF vs APNG vs WebP"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"http://isparta.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("iSparta－PNG 压缩与格式转换工具"),s("OutboundLink")],1)])])]),t._v(" "),s("h3",{attrs:{id:"不同格式适用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不同格式适用场景"}},[t._v("#")]),t._v(" 不同格式适用场景")]),t._v(" "),s("p",[t._v("无损，压缩级别只是编码不同？")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("格式")]),t._v(" "),s("th",[t._v("使用场景")]),t._v(" "),s("th",[t._v("劣势")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("JPG/JPEG")]),t._v(" "),s("td",[t._v("1. 大的背景图； 2. 轮播图； 3. Banner 图 4. 照片")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("PNG")]),t._v(" "),s("td",[t._v("1. 小 Logo； 2. 透明背景")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("GIF")]),t._v(" "),s("td",[t._v("动态图片")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("SVG")]),t._v(" "),s("td",[t._v("能适应不同设备且画质不能损坏的图片")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("Base64")]),t._v(" "),s("td",[t._v("大小不超过 2KB，且更新率低的图片")]),t._v(" "),s("td",[t._v("无法缓存，不适合大图片")])]),t._v(" "),s("tr",[s("td",[t._v("WebP")]),t._v(" "),s("td",[t._v("现代浏览器")]),t._v(" "),s("td")])])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://zh.wikipedia.org/wiki/PNG#%25E4%25B8%258E%25E5%2585%25B6%25E4%25BB%2596%25E6%25A0%25BC%25E5%25BC%258F%25E7%259B%25B8%25E6%25AF%2594",target:"_blank",rel:"noopener noreferrer"}},[t._v("PNG - 维基百科，自由的百科全书"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"响应式展示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#响应式展示"}},[t._v("#")]),t._v(" 响应式展示")]),t._v(" "),s("p",[t._v("srcset/sizes")]),t._v(" "),s("ul",[s("li",[t._v("查看设备宽度")]),t._v(" "),s("li",[t._v("计算 sizes 中第一个符合媒体查询条件")]),t._v(" "),s("li",[t._v("查看给定 slot size")]),t._v(" "),s("li",[t._v("匹配 srcset 中最接近 size")]),t._v(" "),s("li",[t._v("旧浏览器会忽略\n"),s("a",{attrs:{href:"https://codepen.io/tombennet/pen/yYgLaQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("Responsive Images with srcset and sizes"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://www.jianshu.com/p/235ef450f5e9",target:"_blank",rel:"noopener noreferrer"}},[t._v("图片响应式解决方案 - 简书"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://web.dev/fast/use-imagemin-to-compress-images",target:"_blank",rel:"noopener noreferrer"}},[t._v("Use Imagemin to compress images  |  web.dev"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"占位图工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#占位图工具"}},[t._v("#")]),t._v(" 占位图工具")]),t._v(" "),s("p",[s("a",{attrs:{href:"http://iph.href.lu/200x200",target:"_blank",rel:"noopener noreferrer"}},[t._v("iph"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"h2-lazy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#h2-lazy"}},[t._v("#")]),t._v(" h2 lazy")]),t._v(" "),s("p",[t._v("问题：一般期望首屏图片尽快下载完，但使用了 H2，优先级低的图片可能"),s("strong",[t._v("拖慢")]),t._v("优先级高的图片下载，")]),t._v(" "),s("ul",[s("li",[t._v("h2 并行，对下行带宽来说，相当于在请求一个合并文件")]),t._v(" "),s("li",[t._v("开发工具，切换到 image 标签，可以看当图片请求数，总请求大小")]),t._v(" "),s("li",[t._v("图片总体积 9Mb，网速 500KB/s，那 9 * 1000 / 500 = 18，理论要 18s 全部下载完")]),t._v(" "),s("li",[t._v("并行请求，充分利用带宽，但导致单个资源可用带宽爱限")]),t._v(" "),s("li",[t._v("假定 50 张图片，每张图片分配的下行 500 / 50 = 10 kb/s，实际考虑有的图片较小，下载完会释放")]),t._v(" "),s("li",[t._v("带来的问题，优先级高的图片下载也慢了")]),t._v(" "),s("li",[t._v("用户带宽限制，服务器带宽一般远大于用户带宽")])]),t._v(" "),s("blockquote",[s("p",[t._v("第 2、3 张走了不同的域名，所以快。第一张因为首页 h2 并发下载图片太多了（56 个请求，9Mb 大），4Mb 带宽下 较大图片并行请求 20 张每张分\n配大概是 50kb/s，一张 200kb 的图至少需要 4s （实测，swiper 第一张 5s 多）")])]),t._v(" "),s("p",[t._v("结论：")]),t._v(" "),s("ul",[s("li",[t._v("所以用 h2，如果图片比较多的话，需要给图片排优先级(优先级低的使用懒加载)，优先保障当前视口内图片加载，限制一定时间内请求数据量")]),t._v(" "),s("li",[t._v("图片上单独 cdn")])]),t._v(" "),s("h2",{attrs:{id:"lazy-load"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lazy-load"}},[t._v("#")]),t._v(" lazy load")]),t._v(" "),s("blockquote",[s("p",[t._v("chrome 原生已支持")])]),t._v(" "),s("p",[t._v("传统方法 scroll 性能不好")]),t._v(" "),s("p",[t._v("IntersectionObserver 交叉观察者接口，异步，空闲时执行")]),t._v(" "),s("p",[t._v("Chrome 51+，不支持 IE，兼容性很好")]),t._v(" "),s("p",[t._v("触发加载规则：图片元素出现在视口内，即检查元素与父元素或视口(root)是否交叉，交叉比例 threshold")]),t._v(" "),s("p",[t._v("应用场景：lazy load，无限滚动\n"),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver",target:"_blank",rel:"noopener noreferrer"}},[t._v("IntersectionObserver - Web APIs | MDN"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("缺点：依赖 JS 才能正确设置 src，Chrome 原生的好处")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://css-tricks.com/tips-for-rolling-your-own-lazy-loading/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tips for rolling your own lazy loading | CSS-Tricks"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"webp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webp"}},[t._v("#")]),t._v(" webp")]),t._v(" "),s("ul",[s("li",[t._v("支持检测原理，src base64 onload")]),t._v(" "),s("li",[t._v("polyfill 支持原理，打包了"),s("code",[t._v("libwebp")]),t._v("解码库，webp -> image data -> canvas -> done")]),t._v(" "),s("li",[t._v("兼容性：IE11/Safari")]),t._v(" "),s("li",[t._v("文件 Giziped 95KB")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/chase-moskal/webp-hero",target:"_blank",rel:"noopener noreferrer"}},[t._v("chase-moskal/webp-hero: browser polyfill for the webp image format"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://images.guide/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Essential Image Optimization"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"高清图"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#高清图"}},[t._v("#")]),t._v(" 高清图")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.zcool.com.cn/article/ZNDc5NTg4.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sketch用一倍图做设计稿还是二倍图？|UI|教程|Olaf_Chou - 原创文章 - 站酷 (ZCOOL)"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("二倍图设计默认导出的图片是 2x 高清的，可直接使用。\n二倍图导出时省去了点击+号 再选 2x ，操作方便。")]),t._v(" "),s("h2",{attrs:{id:"图片压缩"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片压缩"}},[t._v("#")]),t._v(" 图片压缩")]),t._v(" "),s("h3",{attrs:{id:"表单图片压缩"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#表单图片压缩"}},[t._v("#")]),t._v(" 表单图片压缩")]),t._v(" "),s("ul",[s("li",[t._v("图片 →  canvas 压缩 → 图片")]),t._v(" "),s("li",[t._v("canvas 设置宽度")]),t._v(" "),s("li",[s("code",[t._v("toBlob()")]),t._v("，转换成二进制，后端友好")])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://codepen.io/cyio/pen/MWyeBbg",target:"_blank",rel:"noopener noreferrer"}},[t._v("imageConversion 大文件 png 测试"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("图片预览，可以用 URL.creatObjectUrl(blob) 或 FileReader.readAsDataURL(blob)")]),t._v(" "),s("h3",{attrs:{id:"在线压缩"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在线压缩"}},[t._v("#")]),t._v(" 在线压缩")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://squoosh.app/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Squoosh"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"本地手动压缩"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本地手动压缩"}},[t._v("#")]),t._v(" 本地手动压缩")]),t._v(" "),s("p",[t._v("imageoptim-cli 不支持 svg，因为已经有 svgo")]),t._v(" "),s("p",[t._v("注意参数需要有引号")]),t._v(" "),s("p",[s("code",[t._v("imageoptim './*'")])]),t._v(" "),s("p",[t._v("gui 更全面，且支持异步同步调用")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/automating-image-optimization/",target:"_blank",rel:"noopener noreferrer"}},[t._v("自动优化图像  |  Web Fundamentals  |  Google Developers"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"工具压缩-gulp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#工具压缩-gulp"}},[t._v("#")]),t._v(" "),s("s",[t._v("工具压缩 gulp")])]),t._v(" "),s("ul",[s("li",[t._v("首先原图往往尺寸很大，先缩小")]),t._v(" "),s("li",[t._v("把大文件挑出来，用智图的在线服务，压缩效果好，它的 gulp 工具依赖在线 api，不支持多层目录，有待观察")]),t._v(" "),s("li",[t._v("gulp-imagemin 支持多层目录")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("gulp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("task")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'imagemin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  gulp\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./h5/group4/M00/**/**/*.{png,jpg,gif,ico}'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("imagemin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gulp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./h5/group4/M00-dist/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"图片预览"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片预览"}},[t._v("#")]),t._v(" 图片预览")]),t._v(" "),s("ul",[s("li",[t._v("filereader onload")])]),t._v(" "),s("h2",{attrs:{id:"处理上传"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#处理上传"}},[t._v("#")]),t._v(" 处理上传")]),t._v(" "),s("ul",[s("li",[t._v("blob 必须设置 name")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("blobToFile")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("theBlob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fileName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      theBlob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastModifiedDate "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      theBlob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fileName\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" theBlob\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newFile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("blobToFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("blob"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'upload.png'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" formData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FormData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  formData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("a",{attrs:{href:"https://blog.csdn.net/hhzzcc_/article/details/80324546",target:"_blank",rel:"noopener noreferrer"}},[t._v("原理：Vue 实现图片预览、裁剪并获取被裁剪区域的 base64(无组件) - hhzzcc_的博客 - CSDN 博客"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://juejin.im/post/5b3f14c2f265da0f5405080f",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue+element-ui 图片上传剪裁组件 - 掘金"),s("OutboundLink")],1)]),t._v(" "),s("ul",[s("li",[t._v("element-ui")])]),t._v(" "),s("div",{staticClass:"language-pug extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pug"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("el-upload.avatar-uploader"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("action")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://jsonplaceholder.typicode.com/posts/'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" :"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("show-file-list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'false'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" :"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("on-success")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'handleAvatarSuccess'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" :"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("before-upload")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'beforeAvatarUpload'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token tag"}},[t._v("el-button"),s("span",{pre:!0,attrs:{class:"token attributes"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'primary'")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("上传")]),t._v("\n")])])]),s("h2",{attrs:{id:"avif"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#avif"}},[t._v("#")]),t._v(" AVIF")]),t._v(" "),s("p",[t._v("AV1 video keyframe")]),t._v(" "),s("blockquote",[s("p",[t._v("All we need to do is repack AVIF as a single-frame AV1 video and decode it using native decoder.\npolyfill 原理：将图片重打包成 AV! 视频，再复用浏览器原生支持能力解码\n"),s("code",[t._v("AVIF -> MP4 -> <video> -> canvas -> output")]),t._v(" "),s("code",[t._v(".bmp")]),t._v("喂给浏览器，不必再压缩\nSW 不能创建"),s("code",[t._v("<video>")]),t._v("，需要主线程配合")])]),t._v(" "),s("h2",{attrs:{id:"保存比例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#保存比例"}},[t._v("#")]),t._v(" 保存比例")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("object-fit: contain;\n\nbackground-size: contain;\n")])])]),s("h2",{attrs:{id:"图片压缩原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片压缩原理"}},[t._v("#")]),t._v(" 图片压缩原理")]),t._v(" "),s("p",[t._v("TODO")]),t._v(" "),s("h2",{attrs:{id:"优化思路"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优化思路"}},[t._v("#")]),t._v(" 优化思路")]),t._v(" "),s("ol",[s("li",[t._v("选择合适格式\npng jpg webp avif")]),t._v(" "),s("li",[t._v("减少请求\nbase64 http 1.1 雪碧图")])])])}),[],!1,null,null,null);a.default=r.exports}}]);