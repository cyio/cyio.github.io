(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{475:function(t,s,e){"use strict";e.r(s);var a=e(57),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"vuex"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vuex"}},[t._v("#")]),t._v(" Vuex")]),t._v(" "),e("p",[t._v("解决组件间的数据共享")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("store: state getters mutations action module")])]),t._v(" "),e("li",[e("p",[t._v("全局实例注入")])])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" store "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./store'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  el"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#app'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  store"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  template"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<App/>'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  components"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" App "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("ul",[e("li",[t._v("在"),e("code",[t._v("computed")]),t._v("中，用对象展开符展开 store 中的对象")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mapState")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        userInfo"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'userInfo'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),e("h2",{attrs:{id:"何时使用-vuex"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#何时使用-vuex"}},[t._v("#")]),t._v(" 何时使用 Vuex")]),t._v(" "),e("ul",[e("li",[t._v("先不要用，需要时切换")]),t._v(" "),e("li",[t._v("数据需要在多处(如 view 之间)使用？ 官方文档，多个实例间共享")]),t._v(" "),e("li",[t._v("哪些数据？首先是隔离外部数据，把外部数据逻辑与视图内变量分离")]),t._v(" "),e("li",[t._v("其次是核心数据模型 、接口，避免与页面视图混在一起，方便管理")]),t._v(" "),e("li",[t._v("store 是保持应用状态的容器，所以里边是有状态的数据")]),t._v(" "),e("li",[t._v("组件应该只呈现数据，不处理数据")]),t._v(" "),e("li",[t._v("在 React 中有容器和组件的概念。 它没有被 Vue.js 强制执行。 容器只是组件，但它们也可以从 store 获取数据并与 store 交互。 组件就在那里保存数据并渲染它。")])]),t._v(" "),e("blockquote",[e("p",[t._v("我们已将应用程序分为三部分。 一部分是业务逻辑，它存在于 store 的 module 内，或者更普遍地存储在 store 内，容器元素负责获取数据并将其填充\n到呈现组件，这些组件仅用于呈现数据。 这为我们提供了很好的模块化并支持单一责任原则。 它还提供了很好的可测试性，因为你可以自行测试此结\n构的每个部分。 他们一起将形成某种综合测试。")])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://blog.fundebug.com/2018/06/12/large-scale-vuex-application-structures/",target:"_blank",rel:"noopener noreferrer"}},[t._v("大型 Vuex 应用程序的目录结构 | Fundebug 博客"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://juejin.im/post/5cb2dabde51d456e46603e02",target:"_blank",rel:"noopener noreferrer"}},[t._v("如何构建 Vue 大型应用 - 掘金"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/bailicangdu/vue2-elm",target:"_blank",rel:"noopener noreferrer"}},[t._v("bailicangdu/vue2-elm: 基于 vue2 + vuex 构建一个具有 45 个页面的大型单页面应用"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("vuex modules mapGetters\n"),e("a",{attrs:{href:"https://github.com/igeligel/vuex-namespaced-module-structure/blob/master/src/views/Home.vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuex-namespaced-module-structure/Home.vue at master · igeligel/vuex-namespaced-module-structure"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"状态重置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#状态重置"}},[t._v("#")]),t._v(" 状态重置")]),t._v(" "),e("p",[t._v("切换路由，组件销毁，vuex 不销毁，state 需重置")]),t._v(" "),e("p",[t._v("场景：与后端交互逻辑写到 vuex，组件只负责对数据进行渲染")]),t._v(" "),e("blockquote",[e("p",[t._v("开发业务前会确认 vuex 的 root module，\b 然后根据子业务功能细粒度到 child module。多个 root module 切换时，若需要保留的 state 数据，可以通过 preserveState 将其归档")])]),t._v(" "),e("blockquote",[e("p",[t._v("动态装卸的问题的是当异步调用 store 方法的时候，如果模块已经卸载了的话会报找不到 action/mutation 错误")])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/vuejs/vuex-router-sync",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuejs/vuex-router-sync: Effortlessly keep vue-router and vuex store in sync."),e("OutboundLink")],1)]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pushQuestions'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pushQuestionsModule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("destroyed")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$store"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("unregisterModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pushQuestions'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("a",{attrs:{href:"https://juejin.im/post/5a4c8da3f265da43085e6c64",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuex 闲置状态重置方案 - 掘金"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"vuex-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vuex-2"}},[t._v("#")]),t._v(" vuex")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("store")]),t._v(" 状态的容器，响应式，当其中状态变化时，相应组件高效更新。不能直接修改（赋值），只能显式地通过"),e("code",[t._v("mutations")]),t._v("中定义的方法"),e("code",[t._v("commit")])]),t._v(" "),e("li",[t._v("Mutations 正如其名，只是用来修改 state，只能是同步的纯函数\nMutations 本质上是一个事件系统，由事件名称和处理函数构成\nActions 通过 Mutations 来操作 state，使用灵活")]),t._v(" "),e("li",[t._v("调用，简单在计算属性中返回即可")]),t._v(" "),e("li",[t._v("优点，更明确地状态追踪")])]),t._v(" "),e("h2",{attrs:{id:"计算缓存-vs-methods"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#计算缓存-vs-methods"}},[t._v("#")]),t._v(" 计算缓存 vs Methods")]),t._v(" "),e("p",[t._v("计算属性是基于它的依赖缓存，如果定义的不是响应式依赖，将不会更新\n而 method 在页面重新渲染时，总是会执行")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://cn.vuejs.org/v2/guide/computed.html#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7",target:"_blank",rel:"noopener noreferrer"}},[t._v("计算属性 - vue.js"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"变化检测"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#变化检测"}},[t._v("#")]),t._v(" 变化检测")]),t._v(" "),e("p",[t._v("要让新增加的值支持响应更新，需挂到 data 已存在的属性上，不支持添加新的根级响应式属性")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("someObject"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'b'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[e("a",{attrs:{href:"https://cn.vuejs.org/v2/guide/reactivity.html#%E5%A3%B0%E6%98%8E%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B1%9E%E6%80%A7",target:"_blank",rel:"noopener noreferrer"}},[t._v("深入响应式原理 - vue.js"),e("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);