(window.webpackJsonp=window.webpackJsonp||[]).push([[351],{790:function(t,a,e){"use strict";e.r(a);var s=e(56),r=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"图片"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#图片"}},[t._v("#")]),t._v(" 图片")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#显示优化"}},[t._v("显示优化")])]),e("li",[e("a",{attrs:{href:"#图片格式"}},[t._v("图片格式")]),e("ul",[e("li",[e("a",{attrs:{href:"#不同格式适用场景"}},[t._v("不同格式适用场景")])])])]),e("li",[e("a",{attrs:{href:"#响应式展示"}},[t._v("响应式展示")])]),e("li",[e("a",{attrs:{href:"#占位图工具"}},[t._v("占位图工具")])]),e("li",[e("a",{attrs:{href:"#h2-lazy"}},[t._v("h2 lazy")])]),e("li",[e("a",{attrs:{href:"#lazy-load"}},[t._v("lazy load")]),e("ul",[e("li",[e("a",{attrs:{href:"#intersectionobserver-交叉观察者接口-异步-空闲时执行"}},[t._v("IntersectionObserver 交叉观察者接口，异步，空闲时执行")])])])]),e("li",[e("a",{attrs:{href:"#webp"}},[t._v("webp")])]),e("li",[e("a",{attrs:{href:"#高清图"}},[t._v("高清图")])]),e("li",[e("a",{attrs:{href:"#图片压缩"}},[t._v("图片压缩")]),e("ul",[e("li",[e("a",{attrs:{href:"#表单图片压缩"}},[t._v("表单图片压缩")])]),e("li",[e("a",{attrs:{href:"#在线压缩"}},[t._v("在线压缩")])]),e("li",[e("a",{attrs:{href:"#本地手动压缩"}},[t._v("本地手动压缩")])]),e("li",[e("a",{attrs:{href:"#工具压缩-gulp"}},[t._v("~~工具压缩 gulp~~")])])])]),e("li",[e("a",{attrs:{href:"#图片预览"}},[t._v("图片预览")])]),e("li",[e("a",{attrs:{href:"#处理上传"}},[t._v("处理上传")])]),e("li",[e("a",{attrs:{href:"#avif"}},[t._v("AVIF")])]),e("li",[e("a",{attrs:{href:"#保持比例"}},[t._v("保持比例")])]),e("li",[e("a",{attrs:{href:"#图片压缩原理"}},[t._v("图片压缩原理")])]),e("li",[e("a",{attrs:{href:"#优化思路"}},[t._v("优化思路")])])])]),e("p"),t._v(" "),e("blockquote",[e("p",[t._v("web 优化专家一定是图片优化专家")])]),t._v(" "),e("h2",{attrs:{id:"显示优化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#显示优化"}},[t._v("#")]),t._v(" 显示优化")]),t._v(" "),e("ul",[e("li",[t._v("缩略图到原图过渡")])]),t._v(" "),e("p",[e("a",{attrs:{href:"http://www.fly63.com/article/detial/359",target:"_blank",rel:"noopener noreferrer"}},[t._v("web 前端图片加载优化，从图片模糊到清晰的实现过程"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"图片格式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#图片格式"}},[t._v("#")]),t._v(" 图片格式")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("WebP 有损、无损，30% 体积优势")])]),t._v(" "),e("li",[e("p",[t._v("APNG 质量、大小较 GIF 均有优势，移动端可放心用，桌面端需要兼容 IE/EDGE，可用 JS 库播放 APNG")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/37160029",target:"_blank",rel:"noopener noreferrer"}},[t._v("UC 内核支持更好的动画格式-APNG"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://www.oschina.net/question/3915715_2283697",target:"_blank",rel:"noopener noreferrer"}},[t._v("全面掌握移动端主流图片格式的特点、性能、调优等 - 开源中国社区"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"http://littlesvr.ca/apng/gif_apng_webp.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("GIF vs APNG vs WebP"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"http://isparta.github.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("iSparta－PNG 压缩与格式转换工具"),e("OutboundLink")],1)])])]),t._v(" "),e("h3",{attrs:{id:"不同格式适用场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#不同格式适用场景"}},[t._v("#")]),t._v(" 不同格式适用场景")]),t._v(" "),e("p",[t._v("无损，压缩级别只是编码不同？")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("格式")]),t._v(" "),e("th",[t._v("使用场景")]),t._v(" "),e("th",[t._v("劣势")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("JPG/JPEG")]),t._v(" "),e("td",[t._v("1. 大的背景图； 2. 轮播图； 3. Banner 图 4. 照片")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("PNG")]),t._v(" "),e("td",[t._v("1. 小 Logo； 2. 透明背景")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("GIF")]),t._v(" "),e("td",[t._v("动态图片")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("SVG")]),t._v(" "),e("td",[t._v("能适应不同设备且画质不能损坏的图片")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",[t._v("Base64")]),t._v(" "),e("td",[t._v("大小不超过 2KB，且更新率低的图片")]),t._v(" "),e("td",[t._v("无法缓存，不适合大图片")])]),t._v(" "),e("tr",[e("td",[t._v("WebP")]),t._v(" "),e("td",[t._v("现代浏览器")]),t._v(" "),e("td")])])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://zh.wikipedia.org/wiki/PNG#%25E4%25B8%258E%25E5%2585%25B6%25E4%25BB%2596%25E6%25A0%25BC%25E5%25BC%258F%25E7%259B%25B8%25E6%25AF%2594",target:"_blank",rel:"noopener noreferrer"}},[t._v("PNG - 维基百科，自由的百科全书"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"响应式展示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#响应式展示"}},[t._v("#")]),t._v(" 响应式展示")]),t._v(" "),e("p",[t._v("srcset/sizes")]),t._v(" "),e("ul",[e("li",[t._v("查看设备宽度")]),t._v(" "),e("li",[t._v("计算 sizes 中第一个符合媒体查询条件")]),t._v(" "),e("li",[t._v("查看给定 slot size")]),t._v(" "),e("li",[t._v("匹配 srcset 中最接近 size")]),t._v(" "),e("li",[t._v("旧浏览器会忽略\n"),e("a",{attrs:{href:"https://codepen.io/tombennet/pen/yYgLaQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("Responsive Images with srcset and sizes"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://www.jianshu.com/p/235ef450f5e9",target:"_blank",rel:"noopener noreferrer"}},[t._v("图片响应式解决方案 - 简书"),e("OutboundLink")],1)])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://web.dev/fast/use-imagemin-to-compress-images",target:"_blank",rel:"noopener noreferrer"}},[t._v("Use Imagemin to compress images  |  web.dev"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"占位图工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#占位图工具"}},[t._v("#")]),t._v(" 占位图工具")]),t._v(" "),e("p",[e("a",{attrs:{href:"http://iph.href.lu/200x200",target:"_blank",rel:"noopener noreferrer"}},[t._v("iph"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"h2-lazy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#h2-lazy"}},[t._v("#")]),t._v(" h2 lazy")]),t._v(" "),e("p",[t._v("问题：一般期望首屏图片尽快下载完，但使用了 H2，优先级低的图片可能"),e("strong",[t._v("拖慢")]),t._v("优先级高的图片下载，")]),t._v(" "),e("ul",[e("li",[t._v("h2 并行，对下行带宽来说，相当于在请求一个合并文件")]),t._v(" "),e("li",[t._v("开发工具，切换到 image 标签，可以看当图片请求数，总请求大小")]),t._v(" "),e("li",[t._v("图片总体积 9Mb，网速 500KB/s，那 9 * 1000 / 500 = 18，理论要 18s 全部下载完")]),t._v(" "),e("li",[t._v("并行请求，充分利用带宽，但导致单个资源可用带宽爱限")]),t._v(" "),e("li",[t._v("假定 50 张图片，每张图片分配的下行 500 / 50 = 10 kb/s，实际考虑有的图片较小，下载完会释放")]),t._v(" "),e("li",[t._v("带来的问题，优先级高的图片下载也慢了")]),t._v(" "),e("li",[t._v("用户带宽限制，服务器带宽一般远大于用户带宽")])]),t._v(" "),e("blockquote",[e("p",[t._v("第 2、3 张走了不同的域名，所以快。第一张因为首页 h2 并发下载图片太多了（56 个请求，9Mb 大），4Mb 带宽下 较大图片并行请求 20 张每张分\n配大概是 50kb/s，一张 200kb 的图至少需要 4s （实测，swiper 第一张 5s 多）")])]),t._v(" "),e("p",[t._v("结论：")]),t._v(" "),e("ul",[e("li",[t._v("所以用 h2，如果图片比较多的话，需要给图片排优先级(优先级低的使用懒加载)，优先保障当前视口内图片加载，限制一定时间内请求数据量")]),t._v(" "),e("li",[t._v("图片上单独 cdn")])]),t._v(" "),e("h2",{attrs:{id:"lazy-load"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lazy-load"}},[t._v("#")]),t._v(" lazy load")]),t._v(" "),e("blockquote",[e("p",[t._v("chrome 原生已支持")])]),t._v(" "),e("p",[t._v("默认已经按优先级加载。使用 lazy 可以节省资源")]),t._v(" "),e("p",[t._v("传统方法 scroll 性能不好")]),t._v(" "),e("h3",{attrs:{id:"intersectionobserver-交叉观察者接口-异步-空闲时执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#intersectionobserver-交叉观察者接口-异步-空闲时执行"}},[t._v("#")]),t._v(" IntersectionObserver 交叉观察者接口，异步，空闲时执行")]),t._v(" "),e("p",[t._v("Chrome 51+，不支持 IE，兼容性很好")]),t._v(" "),e("p",[t._v("触发加载规则：图片元素出现在视口内，即检查元素与父元素或视口(root)是否交叉，交叉比例 threshold")]),t._v(" "),e("p",[t._v("应用场景：lazy load，无限滚动\n"),e("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver",target:"_blank",rel:"noopener noreferrer"}},[t._v("IntersectionObserver - Web APIs | MDN"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("缺点：依赖 JS 才能正确设置 src，Chrome 原生的好处")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://css-tricks.com/tips-for-rolling-your-own-lazy-loading/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tips for rolling your own lazy loading | CSS-Tricks"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("示例 "),e("a",{attrs:{href:"https://codepen.io/Sidstumple/pen/WNwvYZR?editors=1010",target:"_blank",rel:"noopener noreferrer"}},[t._v("Interaction observer example"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"webp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#webp"}},[t._v("#")]),t._v(" webp")]),t._v(" "),e("ul",[e("li",[t._v("支持检测原理，src base64 onload")]),t._v(" "),e("li",[t._v("polyfill 支持原理，打包了"),e("code",[t._v("libwebp")]),t._v("解码库，webp -> image data -> canvas -> done")]),t._v(" "),e("li",[t._v("兼容性：IE11/Safari")]),t._v(" "),e("li",[t._v("文件 Giziped 95KB")])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/chase-moskal/webp-hero",target:"_blank",rel:"noopener noreferrer"}},[t._v("chase-moskal/webp-hero: browser polyfill for the webp image format"),e("OutboundLink")],1),t._v(" "),e("a",{attrs:{href:"https://images.guide/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Essential Image Optimization"),e("OutboundLink")],1)]),t._v(" "),e("h2",{attrs:{id:"高清图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#高清图"}},[t._v("#")]),t._v(" 高清图")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://www.zcool.com.cn/article/ZNDc5NTg4.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sketch用一倍图做设计稿还是二倍图？|UI|教程|Olaf_Chou - 原创文章 - 站酷 (ZCOOL)"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("二倍图设计默认导出的图片是 2x 高清的，可直接使用。\n二倍图导出时省去了点击+号 再选 2x ，操作方便。")]),t._v(" "),e("h2",{attrs:{id:"图片压缩"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#图片压缩"}},[t._v("#")]),t._v(" 图片压缩")]),t._v(" "),e("h3",{attrs:{id:"表单图片压缩"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#表单图片压缩"}},[t._v("#")]),t._v(" 表单图片压缩")]),t._v(" "),e("ul",[e("li",[t._v("图片 →  canvas 压缩 → 图片")]),t._v(" "),e("li",[t._v("canvas 设置宽度")]),t._v(" "),e("li",[e("code",[t._v("toBlob()")]),t._v("，转换成二进制，后端友好")])]),t._v(" "),e("p",[e("a",{attrs:{href:"https://codepen.io/cyio/pen/MWyeBbg",target:"_blank",rel:"noopener noreferrer"}},[t._v("imageConversion 大文件 png 测试"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("图片预览，可以用 URL.creatObjectUrl(blob) 或 FileReader.readAsDataURL(blob)")]),t._v(" "),e("h3",{attrs:{id:"在线压缩"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在线压缩"}},[t._v("#")]),t._v(" 在线压缩")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://squoosh.app/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Squoosh"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"本地手动压缩"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本地手动压缩"}},[t._v("#")]),t._v(" 本地手动压缩")]),t._v(" "),e("p",[t._v("imageoptim-cli 不支持 svg，因为已经有 svgo")]),t._v(" "),e("p",[t._v("注意参数需要有引号")]),t._v(" "),e("p",[e("code",[t._v("imageoptim './*'")])]),t._v(" "),e("p",[t._v("gui 更全面，且支持异步同步调用")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/automating-image-optimization/",target:"_blank",rel:"noopener noreferrer"}},[t._v("自动优化图像  |  Web Fundamentals  |  Google Developers"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"工具压缩-gulp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#工具压缩-gulp"}},[t._v("#")]),t._v(" "),e("s",[t._v("工具压缩 gulp")])]),t._v(" "),e("ul",[e("li",[t._v("首先原图往往尺寸很大，先缩小")]),t._v(" "),e("li",[t._v("把大文件挑出来，用智图的在线服务，压缩效果好，它的 gulp 工具依赖在线 api，不支持多层目录，有待观察")]),t._v(" "),e("li",[t._v("gulp-imagemin 支持多层目录")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("gulp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("task")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'imagemin'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  gulp\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("src")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./h5/group4/M00/**/**/*.{png,jpg,gif,ico}'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("imagemin")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("gulp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("dest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./h5/group4/M00-dist/'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h2",{attrs:{id:"图片预览"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#图片预览"}},[t._v("#")]),t._v(" 图片预览")]),t._v(" "),e("ul",[e("li",[t._v("filereader onload")])]),t._v(" "),e("h2",{attrs:{id:"处理上传"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#处理上传"}},[t._v("#")]),t._v(" 处理上传")]),t._v(" "),e("ul",[e("li",[t._v("blob 必须设置 name")])]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("blobToFile")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("theBlob"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fileName")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      theBlob"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastModifiedDate "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      theBlob"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fileName\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" theBlob\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newFile "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("blobToFile")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("blob"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'upload.png'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" formData "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FormData")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  formData"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'file'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newFile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newFile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[e("a",{attrs:{href:"https://blog.csdn.net/hhzzcc_/article/details/80324546",target:"_blank",rel:"noopener noreferrer"}},[t._v("原理：Vue 实现图片预览、裁剪并获取被裁剪区域的 base64(无组件) - hhzzcc_的博客 - CSDN 博客"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("a",{attrs:{href:"https://juejin.im/post/5b3f14c2f265da0f5405080f",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue+element-ui 图片上传剪裁组件 - 掘金"),e("OutboundLink")],1)]),t._v(" "),e("ul",[e("li",[t._v("element-ui")])]),t._v(" "),e("div",{staticClass:"language-pug extra-class"},[e("pre",{pre:!0,attrs:{class:"language-pug"}},[e("code",[t._v("  "),e("span",{pre:!0,attrs:{class:"token tag"}},[t._v("el-upload"),e("span",{pre:!0,attrs:{class:"token attr-class"}},[t._v(".avatar-uploader")]),e("span",{pre:!0,attrs:{class:"token attributes"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://jsonplaceholder.typicode.com/posts/'")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" :"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("show-file-list")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'false'")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" :"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("on-success")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'handleAvatarSuccess'")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" :"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("before-upload")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'beforeAvatarUpload'")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token tag"}},[t._v("el-button"),e("span",{pre:!0,attrs:{class:"token attributes"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'primary'")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("上传")]),t._v("\n")])])]),e("h2",{attrs:{id:"avif"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#avif"}},[t._v("#")]),t._v(" AVIF")]),t._v(" "),e("p",[t._v("AV1 video keyframe")]),t._v(" "),e("blockquote",[e("p",[t._v("All we need to do is repack AVIF as a single-frame AV1 video and decode it using native decoder.\npolyfill 原理：将图片重打包成 AV! 视频，再复用浏览器原生支持能力解码\n"),e("code",[t._v("AVIF -> MP4 -> <video> -> canvas -> output")]),t._v(" "),e("code",[t._v(".bmp")]),t._v("喂给浏览器，不必再压缩\nSW 不能创建"),e("code",[t._v("<video>")]),t._v("，需要主线程配合")])]),t._v(" "),e("h2",{attrs:{id:"保持比例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#保持比例"}},[t._v("#")]),t._v(" 保持比例")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("object-fit: contain;\n\nbackground-size: contain;\n")])])]),e("h2",{attrs:{id:"图片压缩原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#图片压缩原理"}},[t._v("#")]),t._v(" 图片压缩原理")]),t._v(" "),e("p",[t._v("TODO")]),t._v(" "),e("h2",{attrs:{id:"优化思路"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#优化思路"}},[t._v("#")]),t._v(" 优化思路")]),t._v(" "),e("ol",[e("li",[t._v("选择合适格式\npng jpg webp avif")]),t._v(" "),e("li",[t._v("减少请求\nbase64 http 1.1 雪碧图")])])])}),[],!1,null,null,null);a.default=r.exports}}]);