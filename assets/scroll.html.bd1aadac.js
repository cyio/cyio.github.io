import{r as n,o as s,c as a,a as p,F as t,b as e,d as o}from"./app.0e74f851.js";const c={},l=p("h1",{id:"滚动",tabindex:"-1"},[p("a",{class:"header-anchor",href:"#滚动","aria-hidden":"true"},"#"),e(" 滚动")],-1),u=p("h2",{id:"基础",tabindex:"-1"},[p("a",{class:"header-anchor",href:"#基础","aria-hidden":"true"},"#"),e(" 基础")],-1),r=e("通用解决方法： "),i={href:"https://github.com/iamdustan/smoothscroll",target:"_blank",rel:"noopener noreferrer"},k=e("iamdustan/smoothscroll: Scroll Behavior polyfill"),b=e("可以从这里查找 jQuery 替代实现，如搜索 scrollTop "),m={href:"http://youmightnotneedjquery.com/",target:"_blank",rel:"noopener noreferrer"},d=e("You Might Not Need jQuery"),h=e("W3C 有可运行例子，浏览器兼容性看着清楚 "),f={href:"https://www.w3schools.com/jsref/prop_element_offsettop.asp",target:"_blank",rel:"noopener noreferrer"},w=e("HTML DOM offsetTop Property"),y=p("li",null,[p("code",null,"$0.offsetParent"),e(" 离元素最近父级定位元素，offsetTop 是相对于这个值来计算，而不一定是 body 或 window")],-1),g=p("li",null,"scrollHeight 和 scrollWidth，可滚动的绝对宽高，包括隐藏不可见的部分（offset 仅是相对于元素的 width 和 height 不包括隐藏部分）。",-1),v=p("li",null,"scrollTop 和 scrollLeft: 可滑动的元素（即元素出现滚动条的情况时）内部在 xy 轴上滑动的距离，可为其赋值。",-1),T=p("li",null,"clientHeight 和 clientWidth：可视区域的宽高（不同浏览器中 clientHeight 和 offsetWidth 有区别）。",-1),x=o('<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;scroll&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n  <span class="token keyword">this</span><span class="token punctuation">.</span>scroll <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop\n<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\ntarget<span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span> behavior<span class="token operator">:</span> <span class="token string">&#39;smooth&#39;</span><span class="token punctuation">,</span> block<span class="token operator">:</span> <span class="token string">&#39;start&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> wait<span class="token punctuation">,</span> context <span class="token operator">=</span> <span class="token keyword">this</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">let</span> timeout <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token keyword">let</span> callbackArgs <span class="token operator">=</span> <span class="token keyword">null</span>\n\n  <span class="token keyword">const</span> <span class="token function-variable function">later</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> callbackArgs<span class="token punctuation">)</span>\n    timeout <span class="token operator">=</span> <span class="token keyword">null</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> callback<span class="token punctuation">)</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      callbackArgs <span class="token operator">=</span> args\n      timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>later<span class="token punctuation">,</span> wait<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token doc-comment comment">/**\n <span class="token keyword">@description</span> 页面垂直平滑滚动到指定滚动高度\n*/</span>\n<span class="token keyword">const</span> <span class="token function-variable function">scrollSmoothTo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">position</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>requestAnimationFrame<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    window<span class="token punctuation">.</span><span class="token function-variable function">requestAnimationFrame</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token comment">// 当前滚动高度</span>\n  <span class="token keyword">let</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop\n  <span class="token comment">// 滚动step方法</span>\n  <span class="token keyword">const</span> <span class="token function-variable function">step</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 距离目标滚动距离</span>\n    <span class="token keyword">const</span> distance <span class="token operator">=</span> position <span class="token operator">-</span> scrollTop\n    <span class="token comment">// 目标滚动位置</span>\n    scrollTop <span class="token operator">=</span> scrollTop <span class="token operator">+</span> distance <span class="token operator">/</span> <span class="token number">5</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>distance<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> position<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> scrollTop<span class="token punctuation">)</span>\n      <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>step<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n  <span class="token function">step</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">if</span> <span class="token punctuation">(</span>\n  <span class="token keyword">typeof</span> window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span>scrollBehavior <span class="token operator">==</span> <span class="token string">&#39;undefined&#39;</span>\n<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// 传统的JS平滑滚动处理代码...</span>\n  <span class="token function">scrollSmoothTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h2 id="导航版块切换" tabindex="-1"><a class="header-anchor" href="#导航版块切换" aria-hidden="true">#</a> 导航版块切换</h2><ol><li>点击切换 navIndex</li><li>滚动时切换 navIndex，两者互不影响</li></ol><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 用一个值记录，会出现前后影响</span>\n<span class="token keyword">const</span> navClickedStatus <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>\n<span class="token keyword">const</span> stickyNavHeight <span class="token operator">=</span> <span class="token number">56</span>\n\n  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>\n      currentNavIndex<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  methods<span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token function">handleNavClick</span><span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      navClickedStatus<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>\n      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>\n        navClickedStatus<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>\n      <span class="token keyword">this</span><span class="token punctuation">.</span>currentNavIndex <span class="token operator">=</span> index\n      <span class="token keyword">const</span> target <span class="token operator">=</span> window<span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>\n      <span class="token function">scrollSmoothTo</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>offsetTop <span class="token operator">-</span> stickyNavHeight<span class="token punctuation">)</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token function">loadSroll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>navClickedStatus<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentNavIndex<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">return</span>\n      <span class="token keyword">const</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>\n      <span class="token keyword">const</span> sections <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">&#39;detailsInfoBlock&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> sections<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>scrollTop <span class="token operator">+</span> stickyNavHeight <span class="token operator">&gt;=</span> sections<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>offsetTop<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentNavIndex <span class="token operator">!==</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n            <span class="token keyword">this</span><span class="token punctuation">.</span>currentNavIndex <span class="token operator">=</span> i\n          <span class="token punctuation">}</span>\n          <span class="token keyword">break</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;scroll&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loadSroll<span class="token punctuation">)</span>\n  <span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h2 id="实现" tabindex="-1"><a class="header-anchor" href="#实现" aria-hidden="true">#</a> 实现</h2><ul><li>滚动条 高度 = 容器高度 / 内容高度 * 容器高度</li><li>滚动条位置计算</li><li>滚动时，内容位置计算</li></ul>',6),S={href:"https://segmentfault.com/a/1190000017390159",target:"_blank",rel:"noopener noreferrer"},j=e("一文读懂鼠标滚轮事件（wheelEvent） - 个人文章 - SegmentFault 思否"),C=e("要实现一致样式和交互，只能用 JS 实现。单设 CSS，无法解决 Windows。推荐使用 "),N={href:"https://github.com/Grsmto/simplebar",target:"_blank",rel:"noopener noreferrer"},I=e("Grsmto/simplebar: Custom scrollbars vanilla javascript library with native scroll, done simple, lightweight, easy to use and cross-browser."),_=e("已经有了新标准，但兼容性很差 "),E={href:"https://css-tricks.com/the-current-state-of-styling-scrollbars/",target:"_blank",rel:"noopener noreferrer"},H=e("The Current State of Styling Scrollbars | CSS-Tricks"),A=o('<h2 id="滚动条替换" tabindex="-1"><a class="header-anchor" href="#滚动条替换" aria-hidden="true">#</a> 滚动条替换</h2><p>需求：Windows 系统原生滚动条较丑，期望全局定制</p><div class="language-less ext-less line-numbers-mode"><pre class="language-less"><code>\n<span class="token comment">/* 滚动条样式 */</span>\n<span class="token selector">::-webkit-scrollbar</span> <span class="token punctuation">{</span>\n  <span class="token property">width</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>\n  <span class="token property">height</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token selector">::-webkit-scrollbar-thumb</span> <span class="token punctuation">{</span>\n  <span class="token property">margin-left</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>\n  <span class="token property">border-radius</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>\n  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">hsla</span><span class="token punctuation">(</span>220<span class="token punctuation">,</span> 4%<span class="token punctuation">,</span> 58%<span class="token punctuation">,</span> 0.3<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token property">transition</span><span class="token punctuation">:</span> background<span class="token operator">-</span>color 0.3s<span class="token punctuation">;</span>\n\n  <span class="token selector">&amp;:hover</span> <span class="token punctuation">{</span>\n    <span class="token property">background</span><span class="token punctuation">:</span> #bbb<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="库" tabindex="-1"><a class="header-anchor" href="#库" aria-hidden="true">#</a> 库</h2>',4),W={href:"https://github.com/Grsmto/simplebar/blob/master/packages/simplebar/src/simplebar.js",target:"_blank",rel:"noopener noreferrer"},B=e("simplebar/simplebar.js at master · Grsmto/simplebar");c.render=function(e,o){const c=n("OutboundLink");return s(),a(t,null,[l,u,p("ul",null,[p("li",null,[r,p("a",i,[k,p(c)])]),p("li",null,[b,p("a",m,[d,p(c)])]),p("li",null,[h,p("a",f,[w,p(c)])]),y,g,v,T]),x,p("p",null,[p("a",S,[j,p(c)])]),p("p",null,[C,p("a",N,[I,p(c)])]),p("p",null,[_,p("a",E,[H,p(c)])]),A,p("p",null,[p("a",W,[B,p(c)])])],64)};export default c;
