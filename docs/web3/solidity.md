# solidity

Solidity 是一种针对以太坊（Ethereum）区块链的智能合约编程语言。下面是 Solidity 的核心知识：

1.  数据类型：Solidity 支持布尔值、整数、地址、字节数组、字符串等数据类型。
    
2.  控制结构：Solidity 支持 if-else、while、for、switch-case 等常见的控制结构。
    
3.  合约（Contract）：Solidity 的核心是合约，它定义了在以太坊区块链上运行的代码。合约可以看作是一个独立的计算机程序，有自己的存储空间和代码执行环境。
    
4.  函数（Function）：合约中的函数可以被外部调用，实现特定的功能。
    
5.  变量（Variable）：合约中的变量可以存储数据，并在不同的函数之间共享。
    
6.  事件（Event）：Solidity 支持事件，用于在合约中发出通知。
    
7.  修饰器（Modifier）：Solidity 的修饰器可以在函数执行之前或之后添加额外的逻辑，用于实现访问控制等功能。
    
8.  继承（Inheritance）：Solidity 支持合约继承，允许一个合约从另一个合约继承代码和状态变量。
    
9.  状态变量（State Variable）：Solidity 中的状态变量是合约的永久存储，它们存储在以太坊区块链上。
    
10.  合约生命周期：Solidity 中的合约有创建、初始化、存活、死亡等不同的生命周期阶段。

## 教程

Solidity by Example | 0.8.13 https://solidity-by-example.org/

https://learn.cyio.repl.co/


提供者、签名者

通过 Ethers 或 Web3js 降低与区块链交互复杂度

https://faucet.egorfine.com/  获取测试币，要等半个小时

## 数据类型

* boolean
* uint 非负整数
* int 整数
* address

## 变量

- 全局：提供区块链信息，仅编译时存在
- 本地 local：函数内，不上链
- 状态 state ： 上链，具有永久性

循环较少用，可能消耗完 Gas，导致交易失败

数组删除元素，有两种，删除当前元素，循环后面元素全部前移一位。或者将尾部元素置换到当前位置。最后都需要将尾元素 pop。

在 Solidity 中，变量有以下几种作用域：

1.  全局作用域：定义在合约外部的变量属于全局作用域，可以在合约内的任何函数中访问。全局变量需要使用 `public`、`private`、`internal` 或 `external` 关键字来限制它们的可见性。
    
2.  函数作用域：定义在函数内部的变量属于函数作用域，只能在函数内部访问。这些变量也称为局部变量。
    
3.  块作用域：在 Solidity 中，循环语句和条件语句的代码块也可以定义变量，这些变量属于块作用域，只能在代码块内访问。
    
4.  参数作用域：函数的参数也属于函数作用域，可以在函数内部访问。
    

需要注意的是，Solidity 中的全局变量和状态变量有些区别。全局变量只是在编译时存在，而状态变量则存储在以太坊区块链上，因此具有永久性。此外，Solidity 中还有一种特殊的变量 `msg`，它存储了当前的交易信息，包括发送方地址、交易价值等。

## enum 枚举声明

## 函数

在 Solidity 中，函数有以下几种类型：

1.  公共函数（public）：公共函数可以被合约内外的任何地址访问和调用。
    
2.  私有函数（private）：私有函数只能在合约内部被访问和调用，无法在合约外部调用。
    
3.  内部函数（internal）：内部函数只能在当前合约及其派生合约中被访问和调用，无法在合约外部调用。
    
4.  外部函数（external）：外部函数只能从合约外部被访问和调用，它们不能被合约内部调用。
    

此外，还有以下两种特殊的函数类型：

5.  视图函数（view）：视图函数用于访问状态变量，但不修改状态变量。这些函数不会在区块链上创建交易，因此它们是免费的。
    
6.  纯函数（pure）：纯函数不访问状态变量，也不修改状态变量。这些函数不会在区块链上创建交易，因此它们是免费的。
    

区别：公共函数和私有函数的区别在于它们能否被合约外部访问和调用；内部函数和外部函数的区别在于它们能否在合约内部被访问和调用；视图函数和纯函数的区别在于它们是否访问或修改状态变量。视图函数和纯函数不会在区块链上创建交易，因此它们不会消耗 Gas。由于 Solidity 是一种面向以太坊智能合约编程的语言，因此函数的类型和访问控制对智能合约的安全性和可靠性非常重要。

view 只读 state

pure 不操作也不读 state

### payable

在 Solidity 中，如果一个函数需要接收以太币，则需要将其标记为 payable。例如：

```JS
function buyProduct() public payable {
    // 检查以太币数量是否足够
    require(msg.value == 1 ether, "The amount is not enough");

    // 执行购买商品操作
    // ...

    // 向买家发送商品
    // ...
}

```

在开发智能合约时，需要仔细考虑哪些函数需要标记为 payable，以便能够正确地接收和处理以太币。

### fallback

处理未知调用，function 的兜底
必须是无参数的，且没有函数名

```JS
fallback () payable external {
    // 处理以太币
    if (msg.value > 0) {
        // 存储以太币
        // ...
    } else {
        // 执行默认操作
        // ...
    }
}

```

## 事件

在 Solidity 中，事件是一种特殊的函数，它允许智能合约向外界发送消息。事件可以在智能合约中定义，然后在合约中触发，向区块链上的所有节点广播消息。

事件由以下几部分组成：

1.  名称：事件的名称。
    
2.  参数：事件触发时要传递的参数。
    
3.  可见性：事件的可见性可以是公共（public）或内部（internal）。
    

事件的作用在于允许智能合约与外界进行通信，以便外部应用程序或用户可以获取关于合约活动的信息。例如，如果一个智能合约允许用户在其中购买商品，那么智能合约可以定义一个事件来记录每次购买的详细信息，例如购买者地址、商品名称和数量、购买时间等。这些事件可以被监视器和分析工具用于跟踪和分析合约的活动。

另外，事件可以被用于在合约内部执行一些逻辑。例如，如果一个智能合约需要在特定条件下执行一些操作，可以定义一个事件来触发这些操作。当事件触发时，智能合约可以检查事件的参数，并执行相应的操作。这种用法通常需要配合 Solidity 中的修饰器来实现。

## 继承

is 关键字

## 存储位置
Storage 链上
Memory 程序运行中
Calldata 有入参的函数

## 前端库

react wagmi 
vue
https://github.com/wobsoriano/vagmi

## remix 示例

owner.sol 判断是否是合约部署者，更改拥有者

## interview

以下是一些 Solidity 前端面试题：

1.  Solidity 是什么？它用于什么？
    
2.  Solidity 支持哪些数据类型？
    
3.  Solidity 中的变量有哪些作用域？
    
4.  Solidity 中的函数有哪些类型？它们有什么区别？
    
5.  Solidity 中的事件是什么？它们有什么作用？
    
6.  Solidity 中的修饰器是什么？它们的作用是什么？
    
7.  Solidity 中的继承是什么？它的作用是什么？
    
8.  Solidity 中的 payable 函数是什么？它的作用是什么？
    
9.  Solidity 中的 view 和 pure 函数有什么区别？
    
10.  Solidity 中的 fallback 函数是什么？它的作用是什么？